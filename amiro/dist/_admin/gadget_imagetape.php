<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    AMI 
 * @version    $Id$ 
 * @size       4663 xkqwpszgnnuggytrgizwxpmxtumuwrlikuptunnuxqymrutmnyxrmytkxlzpgzugzzlgpnir
 */ ?><?php foreach(array(20312=>'WI|MnM`GOG',20313=>'PQtTQIGJZtQD',20314=>'dqjqwT?.GZtO.!?.nZIQ.?FRhi?.WID|IHSuJQD|tQIGJZtQD.?',20315=>'GZtO',20316=>'MIZPQtZGQ`tGJ',20317=>'PrHuG|nZIQ',20318=>'',20319=>"_",20320=>'tMtJQ',20321=>'SQDWr',20322=>'OQMPOt',20323=>'MIPOQMPOt',20324=>'unMEMS') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} require_once I20312; $oRequest =AMI::getSingleton('env/request'); $action =$oRequest->get('action', ''); $res =""; if($action == I20313){ $oQuery =DB_Query::getSnippet( I20314 .'WHERE `name` LIKE %s AND path = %s' )->q('imagetape%') ->q('_local/_admin/templates/'); $oRS =AMI::getSingleton('db')->select($oQuery); foreach($oRS as $aRow){ $res .= $aRow[I20315] .$aRow['name'] ."|"; }}if($action == ''){ $template =$oRequest->get('template', I20316); $template ='_local/_admin/templates/' .trim(substr($template, strrpos($template, '/')), '/'); $scroll =(int)$oRequest->get('scroll', 0); $groupName =$oRequest->get(I20317, ''); $cols =(int)$oRequest->get('cols', 0); $rows =(int)$oRequest->get('rows', 0); $groupName =str_replace('"', I20318, $groupName); $l1IlLIl ='group' .time(); $imgWidth =100; $imgHeight =100; $l1IlLIL =6; $l1IlLI1 =$imgWidth +$l1IlLIL *2; $l1IlLlI =$imgHeight +$l1IlLIL *2; $oTpl =AMI::getResource('env/template_sys'); $oTpl->addBlock('imagetape', $template); $aScope =$oRequest->getScope(); if(!$rows){ $rows =1; }if(!$cols){ $cols =1; }$aImages =array(); foreach($aScope as $name => $value){ if(false !== strstr($name, 'picture')){ $aParts =explode(I20319, $value); $aImages[] =array( 'src' => $aParts[0], 'groupname' => $groupName, 'group' => $l1IlLIl, 'alt' => isset($aParts[1]) ?$aParts[1] :I20318, I20320 => isset($aParts[2]) ?$aParts[2] :I20318, 'header' => isset($aParts[3]) ?$aParts[3] :I20318, 'url' => isset($aParts[4]) ?$aParts[4] :I20318, 'urlcapt' => isset($aParts[5]) ?$aParts[5] :I20318, 'popupsrc' => isset($aParts[6]) ?$aParts[6] :I20318, I20321 => isset($aParts[7]) ?$aParts[7] :I20318, );}}$l1IlLll =0; if(1 == $scroll){ $l1IlLlL =$cols; $l1IlLl1 =ceil(count($aImages)/$l1IlLlL); $scrollTo =(($row >1) ?($row -1) :1) *$l1IlLlI; }else{ $l1IlLl1 =$rows; $l1IlLlL =ceil(count($aImages)/$l1IlLl1); $scrollTo =(($cols >1) ?($cols -1) :1) *$l1IlLI1; }$count =0; $imageSet =I20318; $l1IlLLI =I20318; foreach($aImages as $aImage){ if(!$l1IlLLI){ $l1IlLLI =($aImage['popupsrc']) ?$aImage['popupsrc'] :$aImage['src']; }$imageSet .= $oTpl->parse('imagetape:image', $aImage); $count++; if($count == $l1IlLlL){ $count =0; $imageSet .= $oTpl->parse('imagetape:delimiter'); }}$width =$cols *$l1IlLI1; $height =$rows *$l1IlLlI; $l1IlLLl =$l1IlLlL *$l1IlLI1; $l1IlLLL =$l1IlLl1 *$l1IlLlI; $res =$oTpl->parse('imagetape:template', array( 'scroll' => $scroll, 'group' => $l1IlLIl, 'width' => $width, I20322 => $height, 'totalw' => $l1IlLLl, 'totalh' => $l1IlLLL, 'imageset' => $imageSet, 'imgwidth' => $l1IlLI1, I20323 => $l1IlLlI, 'scrollto' => $scrollTo, 'initial_image' => $l1IlLLI, 'slidername' => 'oSlider' .uniqid(), I20324 => uniqid() ));$res =str_replace("\r", "", $res); $res =str_replace("\n", "", $res); }echo $res; 