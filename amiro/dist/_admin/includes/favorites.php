<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       6176 xkqwixxqlizqwtuyykwuzmxpwwznxgzwqirgztyrkwzqgtiuzrzuyqgnpxqlurssykggpnir
 */ ?><?php foreach(array(21021=>'',21022=>'IHSuJQ|nZIQ',21023=>'MnMt`GOG',21024=>'Qnv~WHHKMQ',21025=>"ZSS",21026=>"IHSuJQ|nZIQ",21027=>"urJ",21028=>"IHSuJQ|ZSSQS",21029=>"ZWtMHn",21030=>"DtZtuD|IDP",21031=>"",21032=>"YuttHnD",21033=>"GOG",21034=>"SZtQ|tMIQ",21035=>"JZDt|vMDMtQS|MtQID",21036=>"DWrMGtD") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} function TlITl1l($aValue, $name ="cms_favorites"){ AMI::getSingleton('env/cookie')->set($name, serialize($aValue), time() +AMI_ServerCookie::LIFETIME_YEAR); }function TlITl11(&$l1I111L){ global $adm; foreach (array_keys($l1I111L) as $II1III1) {$vMod =&$adm->Core->getModule($II1III1); if (!is_object($vMod)) {unset($l1I111L[$II1III1]); }}}function TlIT1TT($l1I111L){ global $adm; $aModulesNames =array_keys($l1I111L); foreach (array_keys($l1I111L) as $II1III1) {$vMod =&$adm->Core->getModule($II1III1); if (is_object($vMod)) {$l1I1111 =$adm->GetModHeader($vMod); $l1lIIII =$adm->MenuOwnersAll[$vMod->GetOwnerName()]; $l1lIIIl =$vMod->GetParentName(); if ($l1lIIIl != I21021 ){$lllILlI =&$adm->Core->getModule($l1lIIIl); $l1lIIIL =$adm->GetModHeader($lllILlI) .' - '; }else {$l1lIIIL =I21021; }$l1I111L[$II1III1][I21022] =$II1III1; $l1I111L[$II1III1]['name'] =$l1lIIII .' :: ' .$l1lIIIL .$l1I1111; }}return $l1I111L; }$ILlIlIl =1; $l1lIII1 =1; $l1IIllL =false; require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .files_subpath. I21023; AMI_Service::hideDebug(); $adm->Gui->delStyle(); $adm->Gui->addStyle($GLOBALS['CURRENT_SKIN_PATH']."_css/scroll_bars.css"); $adm->Gui->addStyle($GLOBALS['CURRENT_SKIN_PATH']."_css/style.css"); $userId =$Core->GetUserId(); $aMessages =$adm->Gui->parseLangfile("templates/lang/favorites.lng"); $adm->Gui->addBlock("favorites", "templates/favorites.tpl"); $l1lIIlI =AMI::getSingleton('env/cookie')->get("cms_favorites", false) ?unserialize(unhtmlentities(AMI::getSingleton(I21024)->get("cms_favorites"))) :array ();if(!isset($adm->VarsGet['action'])){ $adm->VarsGet['action'] =I21021; }$msg =I21021; if ($adm->VarsGet["action"] == I21025 && isset($l1lIIlI[$adm->VarsGet[I21026]])) {$msg =jparse($aMessages["already_added"]); $adm->VarsGet["action"] =""; }if ($adm->VarsGet["action"] == I21025) {if (sizeof($l1lIIlI)<20) {TlITl11($l1lIIlI); $vMod =&$adm->Core->getModule($adm->VarsGet[I21026]); if (is_object($vMod)) {$l1lIIlI[$adm->VarsGet[I21026]] =array (I21027 => $vMod->GetAdminLink()); }$l1lIIll =TlIT1TT($l1lIIlI); $l1lIIlL =array(); foreach($l1lIIll as $aData) {$l1lIIlL[] =$aData["name"]; }array_multisort($l1lIIlL, $l1lIIll, SORT_ASC); TlITl1l($l1lIIlI); $msg =jparse(str_replace("_name_", $l1lIIll[$adm->VarsGet[I21026]]["name"], $aMessages[I21028])); }else {$msg =jparse($aMessages["list_full"]); }}if ($adm->VarsGet[I21029] == "delete" && is_array($adm->VarsGet["names"])) {$l1lIIl1 =false; foreach($adm->VarsGet["names"] as $key => $value) {unset($l1lIIlI[$value]); $l1lIIl1 =true; }if ($l1lIIl1) {TlITl11($l1lIIlI); TlITl1l($l1lIIlI); }}if($msg !="") {$l1Il1Ll[I21030] =$adm->Gui->getAbs("favorites:status", Array("msg"=>$msg)); }$l1lIIlI =isset($l1lIIll) ?$l1lIIll :TlIT1TT($l1lIIlI); $l1Il1Ll["favorites_items"] =I21021; foreach($l1lIIlI as $key=>$value) {if ($l1Il1Ll["favorites_items"]!=I21031){ $l1Il1Ll["favorites_items"] .= $adm->Gui->getAbs("favorites:splitter", Array()); }if ($value[I21026]==$adm->VarsGet[I21026]){ $value["is_active"]=1; }$l1Il1Ll["favorites_items"] .= $adm->Gui->get("favorites:favorites_row",$value); }$l1lIILI =array(); if ($l1Il1Ll["favorites_items"]!=I21031) {$l1lIILI["show_del_btn"] =1; }else{ $l1Il1Ll["favorites_items"] =$adm->Gui->getAbs("favorites:favorites_empty",Array()); }$l1Il1Ll[I21032] =$adm->Gui->getAbs("favorites:buttons", $l1lIILI); $l1Il1Ll[I21026] =$adm->VarsGet[I21026]; $l1lIILl =AMI::getSingleton(I21024)->get("cms_history", false) ?unserialize(unhtmlentities(AMI::getSingleton(I21024)->get("cms_history"))) :array ();$l1lIILl =TlIT1TT($l1lIILl); $llIl1Il =0; foreach($l1lIILl as $key=>$value){ $llIl1Il++; if(date($adm->DFMT["php"]) == date($adm->DFMT[I21033], $value["date_time"])) {$value["date_time"] =date("H:m:s", $value["date_time"]); }else {$value[I21034] =date($adm->DFMT["php_dtime"], $value[I21034]); }if ($llIl1Il == 6) {continue; }if(!isset($l1Il1Ll['last_visited_items'])){ $l1Il1Ll['last_visited_items'] =I21021; }if ($l1Il1Ll['last_visited_items'] != I21021) {$l1Il1Ll[I21035] =$adm->Gui->getAbs("favorites:splitter", Array()).$l1Il1Ll[I21035]; }$l1Il1Ll[I21035] =$adm->Gui->get("favorites:last_visited_row",$value) .$l1Il1Ll[I21035]; }$l1Il1Ll["metas"] =$adm->Gui->getMetas(); $l1Il1Ll["styles"] =$adm->Gui->getStyles(); $l1Il1Ll[I21036] =$adm->Gui->getScripts(); $html =$adm->Gui->get("favorites", $l1Il1Ll); echo $html; $conn->Out(); 