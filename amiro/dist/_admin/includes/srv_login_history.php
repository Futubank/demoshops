<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       4867 xkqwulpuygsqyniwpiggwkunylzquxzugknrknpzuuimulgywuriwrpxwzssquspirikpnir
 */ ?><?php foreach(array(22342=>'MnMt`GOG',22343=>"JHPMn|OMDtHrB|JMDt",22344=>"tQIGJZtQD~fHrI`tGJ",22345=>"?JMKQ?",22346=>"fJt|SHIZMn",22347=>"fJt|MG",22348=>'OMSSQn',22349=>"hRsqR?yb?",22350=>"SY|StMIQ",22351=>"SHIZMn",22352=>"SZtQ",22353=>"MS",22354=>"JMDt|tZYJQ",22355=>"DGZWQr",22356=>"fHrI",22357=>"JHPMn|OMDtHrB|fHrI",22358=>"ZJMPn=WQntQr") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} $lLIlIIl ="services"; require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .files_subpath. I22342; $l1LIILI =&$adm->Core->GetModule("srv_login_history"); $adm->Words += $adm->Gui->ParseLangFile("templates/lang/srv_login_history.lng"); if($adm->Core->HostMode() &HOSTMODE_ADMIN) {$adm->Gui->AddGlobalVars(Array('HOST_MODE'=>'1')); }$adm->Gui->addBlock(I22343,"templates/srv_login_history_list.tpl"); $adm->Gui->addBlock("login_history_subform", "templates/srv_login_history_form.tpl"); $adm->Gui->addBlock("login_history_form",I22344); $l1LIILl =$adm->TTITI1T(I22343); $adm->Filter->AddField("flt_login", "text", stripslashes(unhtmlentities($adm->Vars["flt_login"])), "", I22345, "login"); $adm->Filter->MoveField("flt_login",_MOVE_START); if($adm->Core->HostMode() &HOSTMODE_ADMIN) {$adm->Filter->AddField("flt_domain", "text", stripslashes(unhtmlentities($adm->Vars[I22346])), "", I22345, "domain"); $adm->Filter->MoveField(I22346,_MOVE_END); }$adm->Filter->AddField("flt_ip", "text", stripslashes(unhtmlentities($adm->Vars[I22347])), "", I22345, "ip"); $adm->Filter->MoveField(I22347,_MOVE_END); $l1LIILL =empty($adm->Vars['flt_show_all']); $adm->Filter->AddField('flt_show_all', I22348, $l1LIILL ?'' :1); $filter ="WHERE " .($l1LIILL ?"`ip` NOT IN ('92.125.152.98', '92.125.152.101', '89.189.185.215', '37.194.252.244') " :1) .' '; $filter .=$adm->Filter->GetFilterSql(); $filter .= I22349.$adm->Pager->TI1TTlT().", id desc "; $sql ="SELECT id FROM cms_host_login_history $filter "; $db->query($sql); $adm->Pager->MaxCount =$db->num_rows(); $adm->Pager->TI1TT1I(); $adm->Filter->UpdateField("offset", $adm->Pager->Position); $lll1lII =$adm->Pager->GetPager(); $pager =$adm->Pager->GetPagerHtml( $lll1lII, "javascript:go_page('[START]');"); if($adm->Pager->MaxCount>0){ $sql ="SELECT id, login, domain, status, ip, date_format(date,'".$adm->DFMT[I22350]."') as fdate ". "FROM cms_host_login_history $filter ".$adm->Pager->TI1TTlI(); $db->query($sql); $i=1; while($db->next_record()) {$lid =$db->Record["id"]; $l1LIIL1["login"] =htmlspecialchars($db->Record["login"], ENT_QUOTES); $l1LIIL1[I22351] =$db->Record[I22351]; $l1LIIL1["status"] =$adm->Words[$db->Record["status"]]; $l1LIIL1["ip"] =$db->Record["ip"]; $l1LIIL1[I22352] =$db->Record["fdate"]; $style ="row2"; if($i%2) $style="row1"; if($adm->Vars["id"]>0 && $adm->Vars[I22353] == $lid) $style ="row3"; $l1LIIL1["style"] =$style; $l1LIILl[I22343] .= $adm->Gui->get("login_history_list:row",$l1LIIL1); $i++; }$l1LIILl["pager"] =$pager; $html[I22354] =$adm->Gui->get(I22343,$l1LIILl); }else {$html[I22354] =$adm->Gui->getAbs("login_history_list:empty",""); $html[I22354] .= $adm->Gui->getAbs("spacer",""); }$html[I22354] .=$adm->Gui->getAbs(I22355,""); $form["filter_hidden_fields"] =$adm->Filter->GetFieldsAsHidden(); if($form["add"] != "disabled") {$html[I22356] =$adm->Gui->get("login_history_subform", $form); }else {$form["form_items"] =$adm->Gui->get("login_history_subform:form_items", $form); $item_data =$adm->Gui->get("login_history_subform", $form); $html[I22356] =$adm->Gui->getAbs(I22357,Array("header"=>$adm->Words["form_header"],"content"=>$item_data,"form_align"=>I22358)); }require $GLOBALS['DEFAULT_INCLUDES_PATH'] .'done.php'; ?>
