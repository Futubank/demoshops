<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       5564 xkqwqryssmwugutnzglrlwmniisiprungnsimpmptxmpzinptttnrisnltnggxllzrwnpnir
 */ ?><?php foreach(array(4617=>"WQ|GZPQ|YrQZK",4618=>"YrQZK|tZP",4619=>"ZJJ|GZrtD",4620=>"DtZrt",4621=>"GZPQD|ZJJ",4622=>"]GZrt=*dTzRT&") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ExtCePageBreak extends CMS_ExtModule {public $forum; public $ILLL11l; public $IlIlLlI; public $ILLL11L; protected $ILLL111; protected $ILL1III; function ExtCePageBreak() {parent::CMS_ExtModule(); }function Init(&$cms, &$IlIlIl1, &$IlIlILI) {$this->ILLL111 ='##body_page_break##'; $this->ILL1III ='a;abbr;acronym;address;blockquote;cite;code;del;dfn;h1;h2;h3;h4;h5;h6;ins;kbd;label;marquee;script;style;sub;sup;textarea;map;object;embed;button;fieldset;form;frameset;table;ul;ol;dl;select'; parent::Init($cms, $IlIlIl1, $IlIlILI); }function GetModuleName() {return I4617; }function TTIllI1($cId, &$vItemData, &$vData, &$IILIILl) {$this->cms->Gui->addBlock($this->mod->moduleName."_page_break", "templates/ce_page_break.tpl"); $js =$this->cms->Gui->getAbs($this->mod->moduleName."_page_break:page_break_js", Array("forbidden_tags" => $this->ILL1III, I4618 => $this->ILLL111)); $this->cms->Gui->addHtmlScript($js); parent::TTIllI1($cId, $vItemData, $vData, $IILIILl); }function TTIll1I($cId, &$vItemData, &$vData, &$IILIILl){ if(isset($this->mod->cms->Vars["part"])) {$IILIILl['cat_id_url'] =''; }parent::TTIll1I($cId, $vItemData, $vData, $IILIILl); }function TTIl1Tl($cId, &$vItemData, &$vData, &$IILIILl) {$breaker =$this->ILLL111; $bodyContent =&$vData[$this->mod->options["description_field_name"]]; if($this->cms->Gui->PrintVersion || !empty($this->mod->cms->Vars[I4619])) {$vData[$this->mod->options["description_field_name"]] =str_replace($breaker, "", $bodyContent); }else {$lengthBreaker =mb_strlen($breaker); $aParts =Array(); $num =0; $pos =-1; $aParts[$num]["start"] =0; while(($pos =mb_strpos($bodyContent, $breaker, $pos +1)) !== false) {$aParts[$num++]["end"] =$pos; $aParts[$num][I4620] =$pos +$lengthBreaker; }$aParts[$num]["end"] =mb_strlen($bodyContent); if($num >0) {$part =0; if(isset($this->mod->cms->Vars["part"])) {$part =intval($this->mod->cms->Vars["part"]); }$num++; $this->mod->browser->InitPager($part, 1, $num); $this->mod->browser->TI1TT1I(); $this->cms->Gui->addBlock("_pager", "templates/pager_item_details.tpl"); $aVars =array('offset_link' => preg_replace('/&catid=\d+/', '', $IILIILl['offset_link'])); $aVars[I4621] =$this->cms->Gui->getAbs("_pager:pages_all", $aVars); TlT1Il1($this->cms->Gui, $this->mod->browser, "_pager", $aVars); $aVars["pager"] =$this->mod->browser->GetPagerHtml( $this->mod->browser->GetPager(), $aVars['offset_link'] .I4622 );$IILIILl["list_data"]["pager_item_details"] =$vData["pager_item_details"] =$this->cms->Gui->getAbs("_pager:pager_body", $aVars); $part =$this->mod->browser->getActivePage(); $vData[$this->mod->options["description_field_name"]] =mb_substr($bodyContent, $aParts[$part][I4620], $aParts[$part]["end"] -$aParts[$part][I4620]); }}}}?>