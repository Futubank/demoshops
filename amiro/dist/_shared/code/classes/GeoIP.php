<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       12396 xkqwyngpltylittqmklkynwnrnmizywlntsgwigqnumlkkwrkmyiugtixrqxxuutzsrspnir
 */ ?><?php foreach(array(5395=>"qU",5396=>"zm",5397=>"ze",5398=>"zc",5399=>"yq",5400=>"yl",5401=>"yd",5402=>"ya",5403=>"wp",5404=>"wi",5405=>"wV",5406=>"sl",5407=>"qw",5408=>"qd",5409=>"Fi",5410=>"py",5411=>"pm",5412=>"pe",5413=>"pc",5414=>"oR",5415=>"mj",5416=>"md",5417=>"kq",5418=>"kN",5419=>"ka",5420=>"jk",5421=>"jV",5422=>"ip",5423=>"iN",5424=>"id",5425=>"iX",5426=>"Nq",5427=>"Nh",5428=>"hi",5429=>"go",5430=>"gR",5431=>"ez",5432=>"dz",5433=>"dp",5434=>"dj",5435=>"dT",5436=>"Ts",5437=>"Tk",5438=>"TR",5439=>"Uz",5440=>"Ua",5441=>"Vm",5442=>"bq",5443=>"aR",5444=>"Ud|hFFdqT",5445=>'DMAQ',5446=>'m1mJjmm',5447=>"Ud",5448=>"",5449=>"mN") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} global $I1Ill11, $I1IlLII, $I1IlLIl; $I1IlLII =array( "", "AP", I5395, "AD", "AE", "AF", "AG", I5396, "AL", "AM", "AN", "AO", I5397, "AR", "AS", "AT", "AU", I5398, "AZ", "BA", "BB", "BD", I5399, "BF", "BG", "BH", "BI", I5400, "BM", "BN", "BO", "BR", I5401, "BT", "BV", "BW", "BY", I5402, "CA", "CC", "CD", "CF", I5403, "CH", "CI", "CK", "CL", I5404, "CN", "CO", "CR", "CU", I5405, "CX", "CY", "CZ", "DE", I5406, "DK", "DM", "DO", "DZ", I5407, "EE", "EG", "EH", "ER", I5408, "ET", "FI", "FJ", "FK", I5409, "FO", "FR", "FX", "GA", I5410, "GD", "GE", "GF", "GH", I5411, "GL", "GM", "GN", "GP", I5412, "GR", "GS", "GT", "GU", I5413, "GY", "HK", "HM", "HN", I5414, "HT", "HU", "ID", "IE", I5415, "IN", "IO", "IQ", "IR", I5416, "IT", "JM", "JO", "JP", I5417, "KG", "KH", "KI", "KM", I5418, "KP", "KR", "KW", "KY", I5419, "LA", "LB", "LC", "LI", I5420, "LR", "LS", "LT", "LU", I5421, "LY", "MA", "MC", "MD", I5422, "MH", "MK", "ML", "MM", I5423, "MO", "MP", "MQ", "MR", I5424, "MT", "MU", "MV", "MW", I5425, "MY", "MZ", "NA", "NC", I5426, "NF", "NG", "NI", "NL", I5427, "NP", "NR", "NU", "NZ", I5428, "PA", "PE", "PF", "PG", I5429, "PK", "PL", "PM", "PN", I5430, "PS", "PT", "PW", "PY", I5431, "RE", "RO", "RU", "RW", I5432, "SB", "SC", "SD", "SE", I5433, "SH", "SI", "SJ", "SK", I5434, "SM", "SN", "SO", "SR", I5435, "SV", "SY", "SZ", "TC", I5436, "TF", "TG", "TH", "TJ", I5437, "TM", "TN", "TO", "TP", I5438, "TT", "TV", "TW", "TZ", I5439, "UG", "UM", "US", "UY", I5440, "VA", "VC", "VE", "VG", I5441, "VN", "VU", "WF", "WS", I5442, "YT", "YU", "ZA", "ZM", I5443, "ZW", "A1", "A2", "O1" );define("GEOIP_COUNTRY_BEGIN", 16776960); define("GEOIP_STATE_BEGIN_REV0", 16700000); define("GEOIP_STATE_BEGIN_REV1", 16000000); define("GEOIP_STANDARD", 0); define("GEOIP_MEMORY_CACHE", 1); define("GEOIP_SHARED_MEMORY", 2); define("STRUCTURE_INFO_MAX_SIZE",20); define("DATABASE_INFO_MAX_SIZE",100); define("GEOIP_COUNTRY_EDITION",106); define("GEOIP_REGION_EDITION_REV0",112); define("GEOIP_REGION_EDITION_REV1",3); define("GEOIP_CITY_EDITION_REV0",111); define("GEOIP_CITY_EDITION_REV1",2); define("GEOIP_ORG_EDITION",110); define("SEGMENT_RECORD_LENGTH",3); define("STANDARD_RECORD_LENGTH",3); define("ORG_RECORD_LENGTH",4); define("MAX_RECORD_LENGTH",4); define("MAX_ORG_RECORD_LENGTH",300); define("GEOIP_SHM_KEY", 0x4f415401); define(I5444,1); define("CANADA_OFFSET",677); define("WORLD_OFFSET",1353); define("FIPS_RANGE",360); class GeoIP {public $flags; public $I1IlLIL; public $I1IlLI1; public $I1IlLlI; public $I1IlLll; public $I1IlLlL; public $I1IlLl1; }function TITlT1T ($file) {$fp =fopen($file, "rb"); if (!$fp) {print "error opening $file: $php_errormsg\n"; exit; }$I1IlLLI =fstat($fp); $size =$I1IlLLI[I5445]; if ($I1IlLl1 =shmop_open (GEOIP_SHM_KEY, "w", 0, 0)) {shmop_delete ($I1IlLl1); shmop_close ($I1IlLl1); }$I1IlLl1 =shmop_open (GEOIP_SHM_KEY, "c", 0644, $size); shmop_write ($I1IlLl1, fread($fp, $size), 0); shmop_close ($I1IlLl1); }function TITlT1I($gi){ $gi->I1IlLlI =GEOIP_COUNTRY_EDITION; $gi->I1IlLlL =STANDARD_RECORD_LENGTH; if ($gi->flags &GEOIP_SHARED_MEMORY) {$offset =shmop_size ($gi->I1IlLl1) -3; for ($i =0; $i <STRUCTURE_INFO_MAX_SIZE; $i++) {$delim =shmop_read ($gi->I1IlLl1, $offset, 3); $offset += 3; if ($delim == (chr(255).chr(255).chr(255))) {$gi->I1IlLlI =ord(shmop_read ($gi->I1IlLl1, $offset, 1)); $offset++; if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV0){ $gi->I1IlLll =GEOIP_STATE_BEGIN_REV0; }else if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV1){ $gi->I1IlLll =GEOIP_STATE_BEGIN_REV1; }else if (($gi->I1IlLlI == GEOIP_CITY_EDITION_REV0)|| ($gi->I1IlLlI == GEOIP_CITY_EDITION_REV1) || ($gi->I1IlLlI == GEOIP_ORG_EDITION)){ $gi->I1IlLll =0; $I1IlLLl =shmop_read ($gi->I1IlLl1, $offset, SEGMENT_RECORD_LENGTH); for ($j =0;$j <SEGMENT_RECORD_LENGTH;$j++){ $gi->I1IlLll += (ord($I1IlLLl[$j]) << ($j *8)); }if ($gi->I1IlLlI == GEOIP_ORG_EDITION) {$gi->I1IlLlL =ORG_RECORD_LENGTH; }}break; }else {$offset -= 4; }}if ($gi->I1IlLlI == GEOIP_COUNTRY_EDITION){ $gi->I1IlLll =GEOIP_COUNTRY_BEGIN; }}else {$I1IlLLL =ftell($gi->I1IlLIL); fseek($gi->I1IlLIL, -3, SEEK_END); for ($i =0; $i <STRUCTURE_INFO_MAX_SIZE; $i++) {$delim =fread($gi->I1IlLIL,3); if ($delim == (chr(255).chr(255).chr(255))){ $gi->I1IlLlI =ord(fread($gi->I1IlLIL,1)); if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV0){ $gi->I1IlLll =GEOIP_STATE_BEGIN_REV0; }else if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV1){ $gi->I1IlLll =GEOIP_STATE_BEGIN_REV1; }else if (($gi->I1IlLlI == GEOIP_CITY_EDITION_REV0) || ($gi->I1IlLlI == GEOIP_CITY_EDITION_REV1) || ($gi->I1IlLlI == GEOIP_ORG_EDITION)){ $gi->I1IlLll =0; $I1IlLLl =fread($gi->I1IlLIL,SEGMENT_RECORD_LENGTH); for ($j =0;$j <SEGMENT_RECORD_LENGTH;$j++){ $gi->I1IlLll += (ord($I1IlLLl[$j]) << ($j *8)); }if ($gi->I1IlLlI == GEOIP_ORG_EDITION) {$gi->I1IlLlL =ORG_RECORD_LENGTH; }}break; }else {fseek($gi->I1IlLIL, -4, SEEK_CUR); }}if ($gi->I1IlLlI == GEOIP_COUNTRY_EDITION){ $gi->I1IlLll =GEOIP_COUNTRY_BEGIN; }fseek($gi->I1IlLIL,$I1IlLLL,SEEK_SET); }return $gi; }function TITlT1l($filename, $flags) {$gi =new GeoIP; $gi->flags =$flags; if ($gi->flags &GEOIP_SHARED_MEMORY) {$gi->I1IlLl1 =shmop_open (GEOIP_SHM_KEY, "a", 0, 0); }else {$gi->I1IlLIL =fopen($filename,"rb"); if ($gi->flags &GEOIP_MEMORY_CACHE) {$I1IlLLI =fstat($gi->I1IlLIL); $gi->I1IlLI1 =fread($gi->I1IlLIL, $I1IlLLI[size]); }}$gi =TITlT1I($gi); return $gi; }function TITlT11($gi) {return fclose($gi->I1IlLIL); }function TITlITT($gi, $name) {$addr =gethostbyname($name); if (!$addr || $addr == $name) {return false; }return TITlIT1($gi, $addr); }function TITlITI($gi, $name) {$I1IlLL1 =TITlITT($gi,$name); if ($I1IlLL1 !== false) {return $GLOBALS[I5446][$I1IlLL1]; }return false; }function TITlITl($gi, $name) {$I1IlLL1 =TITlITT($gi,$name); if ($I1IlLL1 !== false) {return $GLOBALS['I1IlLIl'][$I1IlLL1]; }return false; }function TITlIT1($gi, $addr) {$I1IlL1I =ip2long($addr); return TITlIIl($gi, $I1IlL1I) -GEOIP_COUNTRY_BEGIN; }function TITlIIT($gi, $addr) {$I1IlLL1 =TITlIT1($gi,$addr); if ($I1IlLL1 !== false) {return $GLOBALS[I5446][$I1IlLL1]; }return false; }function TITlIII($gi, $addr) {$I1IlLL1 =TITlIT1($gi,$addr); if ($I1IlLL1 !== false) {return $GLOBALS['I1IlLIl'][$I1IlLL1]; }return false; }function TITlIIl($gi, $I1IlL1I) {$offset =0; for ($depth =31; $depth >= 0; --$depth) {if ($gi->flags &GEOIP_MEMORY_CACHE) {$I1IlLLl =mb_substr($gi->I1IlLI1, 2 *$gi->I1IlLlL *$offset, 2 *$gi->I1IlLlL); }elseif ($gi->flags &GEOIP_SHARED_MEMORY) {$I1IlLLl =shmop_read ($gi->I1IlLl1, 2 *$gi->I1IlLlL *$offset, 2 *$gi->I1IlLlL );}else {if(fseek($gi->I1IlLIL, 2 *$gi->I1IlLlL *$offset, SEEK_SET) != 0) {trigger_error("_geoip_seek_country: fseek failed", E_USER_WARNING); return false; }$I1IlLLl =fread($gi->I1IlLIL, 2 *$gi->I1IlLlL); }$x =array(0,0); for ($i =0; $i <2; ++$i) {for ($j =0; $j <$gi->I1IlLlL; ++$j) {$x[$i] += ord($I1IlLLl[$gi->I1IlLlL *$i +$j]) << ($j *8); }}if ($I1IlL1I &(1 << $depth)) {if ($x[1] >= $gi->I1IlLll) {return $x[1]; }$offset =$x[1]; }else {if ($x[0] >= $gi->I1IlLll) {return $x[0]; }$offset =$x[0]; }}trigger_error("error traversing database - perhaps it is corrupt?", E_USER_WARNING); return false; }function TITlII1($gi,$I1IlL1I){ $I1IlL1l =TITlIIl($gi,$I1IlL1I); if ($I1IlL1l == $gi->I1IlLll) {return NULL; }$I1IlL1L =$I1IlL1l +(2 *$gi->I1IlLlL -1) *$gi->I1IlLll; if ($gi->flags &GEOIP_SHARED_MEMORY) {$I1IlL11 =shmop_read ($gi->I1IlLl1, $I1IlL1L, MAX_ORG_RECORD_LENGTH); }else {fseek($gi->I1IlLIL, $I1IlL1L, SEEK_SET); $I1IlL11 =fread($gi->I1IlLIL,MAX_ORG_RECORD_LENGTH); }$I1IlL11 =mb_substr($I1IlL11, 0, mb_strpos($I1IlL11, 0)); return $I1IlL11; }function TITlIlT ($gi,$addr) {if ($addr == NULL) {return 0; }$I1IlL1I =ip2long($addr); return TITlII1($gi, $I1IlL1I); }function TITlIlI($gi,$I1IlL1I){ if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV0){ $I1Il1II =TITlIIl($gi,$I1IlL1I) -GEOIP_STATE_BEGIN_REV0; if ($I1Il1II >= 1000){ $I1Il1Il =I5447; $region =chr(($I1Il1II -1000)/26 +65) .chr(($I1Il1II -1000)%26 +65); }else {$I1Il1Il =$GLOBALS[I5446][$I1Il1II]; $region =""; }return array ($I1Il1Il,$region); }else if ($gi->I1IlLlI == GEOIP_REGION_EDITION_REV1){ $I1Il1II =TITlIIl($gi,$I1IlL1I) -GEOIP_STATE_BEGIN_REV1; if ($I1Il1II <US_OFFSET){ $I1Il1Il =""; $region =""; }else if ($I1Il1II <CANADA_OFFSET){ $I1Il1Il =I5447; $region =chr(($I1Il1II -US_OFFSET)/26 +65) .chr(($I1Il1II -US_OFFSET)%26 +65); }else if ($I1Il1II <WORLD_OFFSET){ $I1Il1Il ="CA"; $region =chr(($I1Il1II -CANADA_OFFSET)/26 +65) .chr(($I1Il1II -CANADA_OFFSET)%26 +65); }else {$I1Il1Il =$GLOBALS[I5446][($I1Il1II -WORLD_OFFSET) /FIPS_RANGE]; $region =I5448; }return array ($I1Il1Il,$region); }}function TITlIll ($gi,$addr) {if ($addr == NULL) {return 0; }$I1IlL1I =ip2long($addr); return TITlIlI($gi, $I1IlL1I); }function TITlIl1 ($l,$ip){ $r =new Net_DNS_Resolver(); $r->nameservers =array("ws1.maxmind.com"); $p =$r->search($l."." .$ip .".s.maxmind.com","TXT",I5449); $str =is_object($p->answer[0])?$p->answer[0]->string():''; mb_ereg("\"(.*)\"",$str,$regs); $str =$regs[1]; return $str; }?>
