<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       3644 xkqwypssrwurwslnyxmqqprxqmulizimkymsmxipwkuwsnkwrqugrnriytmtxgywlkpkpnir
 */ ?><?php foreach(array(5626=>'odT|cRhNp|RqdghNdq',5627=>'GrHW',5628=>"IDP",5629=>'',5630=>"WHSQ") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} define('HST_OK', 0); define('HST_EMPTY_BATCH', 1); define(I5626, 2); define('HST_WRONG_RESPONSE_TYPE', 4); define('HST_INCOMPLETE_RESPONSE', 8); define('HST_ERROR_RESPONSE', 16); class HstCmd {public $desc; public $ret; function HstCmd($type, $proc, $args =null, $id =null) {$this->desc =array( 'type' => $type, I5627 => $proc, 'args' => $args, 'id' => $id, );$this->ret =array('code' => null); }function TITllTl() {return $this->desc; }function TITllT1() {return $this->ret["code"]; }function TITllIT() {return $this->ret[I5628]; }function TITllII() {return $this->ret["data"]; }function TITllIl($code, $msg ='', $data =null) {$this->ret =array("code" => $code, I5628 => $msg, "data" => $data); }}class HstBatch {public $commands; function HstBatch() {$this->commands =array(); }function &Add(&$command) {return $this->commands[] =&$command; }function Send(&$daemon) {if(empty($this->commands)) {return HST_EMPTY_BATCH; }$ret =null; $request =array(); foreach ($this->commands as $cmd) {$request[] =$cmd->TITllTl(); }if($daemon->TlTTI1l($request)) {$res =unserialize(base64_decode($daemon->GetLastResponse())); _d($res, I5629, 4); if(is_array($res['results'])) {$ret =HST_OK; foreach ($res['results'] as $key => $val) {if(is_object($this->commands[$key])) {$this->commands[$key]->TITllIl($val["code"], $val[I5628], $val["data"]); if($val[I5630] >0) {$ret |= HST_ERROR_RESPONSE; }}else {$ret |= HST_INCOMPLETE_RESPONSE; trigger_error('Returned unexpected result for package '.$key, E_USER_WARNING); }}return $ret; }else {return HST_WRONG_RESPONSE_TYPE; }}else {return HST_WRONG_RESPONSE; }}function TITllI1() {return $this->commands; }function TITlllT() {return $this->commands =array(); }}?>