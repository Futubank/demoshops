<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       39332 xkqwlnkyiqxwqxuynqitxkyiptktpmxgzsqzyyxrqksuppqzquuqulrswwulqgniimiwpnir
 */ ?><?php foreach(array(5767=>'JZDtRQWHrS',5768=>"",5769=>'000',5770=>"GOG|IQIHrB|JMIMt",5771=>'NQCiZPMWKcZnS',5772=>'wjzddqd|gzTo',5773=>"\\",5774=>"CZtQr|",5775=>"|",5776=>"*NqcoqmpoT&`",5777=>"RhhT|gzTo",5778=>":04S",5779=>"KY|rQfQrQnWQ",5780=>'|MtQI',5781=>'Qxt|MIP|fMQJSD',5782=>"!?",5783=>"?M?jqFT?lhmN?",5784=>'JZDteuQrB',5785=>"GHGuG|",5786=>'Qxt|MIP|DHurWQ',5787=>'Qxt|MIP',5788=>'GMWturQ',5789=>"IMIQ",5790=>'IHSmS',5791=>'IMIQTBGQ',5792=>'',5793=>"'?DMAQ?",5794=>'GHGuG|',5795=>'|IZxOQMPOt',5796=>'Qxt|DIZJJ|GMWturQ',5797=>'|GHDtf',5798=>'CZtQrIZrK|GHDtf',5799=>'|DCt',5800=>"RhhT|gzTo|ccc",5801=>"CZtQrIZrK|GMWturQ",5802=>"CZtQrIZrK|IQtOHS",5803=>"DtZtMW|CZtQrIZrK",5804=>"WQntQr",5805=>"MIZPQ~PMf") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} $GLOBALS['I1I1lLl'] =array ('lastQuery' => null, I5767 => null );class IMG_Proc{ public $I1I1lLL; public $I1I1lL1; public $I1I1l1I; public $I1I1l1l; public $I1ILl1I; public $I1ILl1l; public $I1I1l1L; public $tmpDir; public $I1I1l11; public $I1I1LII; public $procData; public $I1I1LIl; public $I1I1LIL; public $I1I1lIL; function IMG_Proc($II1ILLl ="php", $I1I1LI1 ="", $I1I1LlI =""){ $I1I1Lll =16000000; $I1I1LlL =ini_get('memory_limit'); if($I1I1LlL == -1){ $I1I1LlL =I5768; }if(!empty($I1I1LlL)){ $I1I1LlL =intval(str_replace(array('M', 'K', ' '), array('000000', I5769, ''), mb_strtoupper($I1I1LlL))); }if(!empty($I1I1LlL) && $I1I1LlL >$I1I1Lll){ $this->I1ILl1I =$I1I1LlL; }else if(isset($GLOBALS["Core"]) && is_object($GLOBALS["Core"]) && $GLOBALS["Core"]->IssetOption(I5770)){ $this->I1ILl1I =$GLOBALS["Core"]->GetOption(I5770)-4000000; }else{ $this->I1ILl1I =$I1I1Lll; }$this->I1ILl1l =80; $this->tmpDir ="tmp"; $this->I1I1LII =100; $this->I1I1l11 ="_wt"; $this->I1I1l1L ="jpg"; $this->TTIIII1($II1ILLl); $this->TIT1Tl1($I1I1LI1); $this->TIT1T1T($I1I1LlI); $this->TIT1T1l(array()); $this->I1I1LIl =I5768; $this->I1I1LIL =array("max_memory_exceeded" => "Maximum\nexceeded:\n_MAXMP_", "tmp_file_postf" => I5768); $this->I1I1lIL ="#555555"; }function TTIIII1($II1ILLl){ switch($II1ILLl){ case "magickwand": if(function_exists(I5771)){ require_once $GLOBALS['CLASSES_PATH'] .'IMG_DrvMagickWand.php'; $this->I1I1lLL =new IMG_DRVMAGICKWAND(); $this->I1I1lLL->I1ILl1I =$this->I1ILl1I; $this->I1I1lLL->I1ILl1l =$this->I1ILl1l; break; }case "imagick": if(class_exists("Imagick", false)){ require_once $GLOBALS[I5772] .'IMG_DrvIMagick.php'; $this->I1I1lLL =new IMG_DRVIMAGICK(); $this->I1I1lLL->I1ILl1I =$this->I1ILl1I; $this->I1I1lLL->I1ILl1l =$this->I1ILl1l; break; }default: require_once $GLOBALS[I5772] .'IMG_DrvPHP.php'; $this->I1I1lLL =new IMG_DRVPHP(); $this->I1I1lLL->I1ILl1I =$this->I1ILl1I; $this->I1I1lLL->I1ILl1l =$this->I1ILl1l; break; }}function TIT1Tll(){ if(is_object($this->I1I1lLL)) return true; else return false; }function TIT1Tl1($I1ILl1L){ $this->I1I1lL1 =I5768; if(@is_file($I1ILl1L)) $this->I1I1lL1 =$I1ILl1L; $this->TIT1TIT(); }function TIT1T1T($I1I1Ll1){ $this->I1I1l1l =I5768; if(is_dir($I1I1Ll1)) $this->I1I1l1l =$I1I1Ll1; }function TIT1T1I($I1I1LLI){ $this->I1ILl1I =$I1I1LLI; if($this->TIT1Tll()) $this->I1I1lLL->I1ILl1I =$this->I1ILl1I; }function TIT1T1l($cData){ $this->procData =$cData; }function TIT1TIT(){ $this->I1I1l1I =array(); if($this->TIT1Tll()) $this->I1I1l1I =$this->I1I1lLL->TIT1TIT($this->I1I1lL1); }function TIT1T11(){ return $this->I1I1l1I[0]; }function TIT1ITT(){ return $this->I1I1l1I[1]; }function getType(){ return $this->I1I1l1I[2]; }function TIT1TlT($cType =I5768){ return $this->I1I1lLL->TIT1TlT(mb_strtolower($cType)); }function TIT1TI1($I1ILl11, $I1I1LLl, $I1IL1Il, $I1IL1IL, $I1IL1I1 =true, $I1ILLlI =0, $I1IL1lI =Array(), $I1IL1ll =Array()){ return $this->I1I1lLL->TIT1TI1($I1ILl11, $I1I1LLl, $I1IL1Il, $I1IL1IL, $I1IL1I1, $I1ILLlI, $I1IL1lI, $I1IL1ll); }function TIT1ITI($I1I1LLL, $I1I1LL1 =true){ return false; }function TIT1ITl($cX, $cY, $I1IL1L1, $I1IL11I){ return false; }function TIT1TII($I1ILl11, $I1I1L1I, $I1I1LLl, $I1ILLIL =0, $I1ILLI1 ="center", $cX =0, $cY =0, $I1ILLlI =0){ return $this->I1I1lLL->TIT1TII(empty($I1ILl11) ?$this->I1I1lL1 :$I1ILl11, $I1I1L1I, $I1I1LLl, $I1ILLIL, $I1ILLI1, $cX, $cY, $I1ILLlI); }function TIT1TlI($I1ILLIl, $I1IL1L1, $I1IL11I, $I1IL11l, $I1IL11L, $errData){ return $this->I1I1lLL->TIT1TlI($I1ILLIl, $I1IL1L1, $I1IL11I, $I1IL11l, $I1IL11L, $errData); }function TIT1IT1($I1I1L1l =I5768, $I1I1L1L =I5768, $I1IL1L1 =0, $I1IL11I =0, $I1I1L11 =true, $I1I11II =0, $I1IL1lI =Array(), $I1IL1ll =Array()){ $this->I1I1LIl =I5768; $I1I11Il =!(!empty($I1I1L1l) && ($I1IL1L1 >0 || $I1IL11I >0)); if(!empty($I1I1L1l) && (!is_file($I1I1L1l) || is_dir($I1I1L1l))) return false; else if(!empty($I1I1L1l)) $this->TIT1Tl1($I1I1L1l); $fileName =basename($this->I1I1lL1); $fileExt =I5768; if(preg_match('/^(.*)\.((jpg)|(jpeg)|(gif)|(png))$/si', $fileName, $matches)){ $fileName =$matches[1]; $fileExt =$matches[2]; }if(!$this->TIT1TlT($fileExt)) return false; $storePath =I5768; $I1I11IL =I5768; if(!empty($I1I1L1L)){ if(is_dir($I1I1L1L)){ $storePath =$I1I1L1L; }else{ $storePath =dirname($I1I1L1L); if(is_dir($storePath)){ $I1I11IL =basename($I1I1L1L); if(preg_match('/^(.*)\.((jpg)|(jpeg)|(gif)|(png))$/si', $I1I11IL, $matches)){ $fileExt =$matches[2]; if(!$this->TIT1TlT($fileExt)) return false; }}else return false; }}if(empty($storePath) && empty($I1I11IL)) $storePath =$this->I1I1l1l; if($this->tmpDir[mb_strlen($this->tmpDir)-1] != "/" && $this->tmpDir[mb_strlen($this->tmpDir)-1] != "\\") $this->tmpDir .= "/"; if($storePath[mb_strlen($storePath)-1] != "/" && $storePath[mb_strlen($storePath)-1] != I5773) $storePath .= "/"; if($this->TIT1Tll() && !empty($fileExt) && in_array($this->getType(), array("1", "2", "3"))){ if($I1I11Il && is_array($this->procData)){ foreach($this->procData as $item){ if(is_array($item) && intval($item[0]) >0 && intval($item[1]) >0){ $item[0] =intval($item[0]); $item[1] =intval($item[1]); $I1I11I1 =false; $tmpFileName =I5768; if(!empty($item[2])){ $tmpFileName =I5774.$fileName.".".$fileExt."_".@filesize($this->I1I1lL1)."_".basename($item[2])."_".@filesize($item[2]).I5775.$item[3].".".(empty($item[6]) ?$fileExt :$item[6]); if(is_file($this->tmpDir.$tmpFileName)) $I1I11I1 =true; else $I1I11I1 =$this->TIT1TII($this->I1I1lL1, $item[2], $this->tmpDir.$tmpFileName, $this->I1I1LII, $item[3], 0, 0, $item[5]); }$I1I11lI =$I1I11I1 ?$this->tmpDir.$tmpFileName :$this->I1I1lL1; $I1I11ll =!empty($item[7]) ?$item[7] :($storePath.$fileName."_[NEWWIDTH]x[NEWHEIGHT]".(empty($item[5]) ?($I1I11I1 ?$this->I1I1l11 :I5768) :$item[5]).".".(empty($item[6]) ?$fileExt :$item[6])); if(!$this->TIT1TI1($I1I11lI, $I1I11ll, $item[0], $item[1], true, $item[5])){ return false; }}}}else if(!$I1I11Il){ $I1I11lI =$this->I1I1lL1; $I1I11ll =!empty($I1I11IL) ?$storePath.$I1I11IL :($storePath.$fileName."_[NEWWIDTH]x".I5776.$fileExt); if(!$this->TIT1TI1($I1I11lI, $I1I11ll, $I1IL1L1, $I1IL11I, $I1I1L11, $I1I11II, $I1IL1lI, $I1IL1ll)){ $I1I11lL =$GLOBALS["CUSTOM_PICTURES_HTTP_PATH"]."tmp_err_".$this->I1ILl1I.trim($this->I1I1LIL["tmp_file_postf"]).".gif"; if(is_file($GLOBALS[I5777].$I1I11lL)) $this->I1I1LIl =$I1I11lL; else{ $I1I11l1 =ceil(sqrt($this->I1ILl1I/4/2)); $errData =array(ceil($this->I1ILl1I/1000000), $I1I11l1, $I1I11l1); $errMsg =str_replace(array("_MAXMP_", "_MAXX_", "_MAXY_"), $errData, $this->I1I1LIL["max_memory_exceeded"]); if($this->TIT1TlI($GLOBALS[I5777].$I1I11lL, 120, 80, $errMsg, $this->I1I1lIL, $errData)) $this->I1I1LIl =$I1I11lL; }return false; }}}else{ return false; }return true; }function TIT1IIT(){ if(!empty($this->tmpDir)) if($dir =opendir($this->tmpDir)) {while(($file =readdir($dir)) !== false) if(mb_strlen($file) >5) unlink($this->tmpDir.$file); closedir($dir); }}function TIT1III($I1I11LI){ if(is_array($I1I11LI)) $this->I1I1LIL =array_merge($this->I1I1LIL, $I1I11LI); }function TIT1IIl($I1I11Ll){ if(preg_match('/^\#?[0-9A-Fa-a]{6}$/', $I1I11Ll)) $this->I1I1lIL =$I1I11Ll; }public static function TIT1II1(CMS_Module &$I1I11LL, &$db, $modName, $cId, $cType, $aData, $I1I11LI =array()){ $doMapping =$I1I11LL->issetOption('item_pictures'); $I1I11L1 =I5768; $I1I111I =I5768; $I1I111l =I5768; $I1I111L =false; $I1I1111 =FALSE; $tblName =$I1I11LL->GetTableName(); if(isset($aData["refnum"])){ if($modName == "eshop_reference"){ $tblName ="cms_es_reference_".sprintf(I5778, $aData["refnum"]); }elseif($modName == "portfolio_reference"){ $tblName ="cms_po_reference_".sprintf(I5778, $aData["refnum"]); }elseif($modName == I5779){ $tblName ="cms_kb_reference_".sprintf(I5778, $aData["refnum"]); }}if(mb_strpos($modName, '_price_list') !== false){ $I1lIIII =str_replace('_price_list', I5780, $modName); $I1IllI1 =&$GLOBALS['Core']->GetModule($I1lIIII); if(is_object($I1IllI1)){ $tblName =$I1IllI1->GetTableName(); }}if(!empty($tblName)){ $picSubPath =$modName; if(($pos =mb_strpos($picSubPath, I5775)) !== false) $picSubPath =mb_substr($picSubPath, 0, $pos); $I1lIIIl =false; if($I1I11LL->IssetOption("watermark_postf") && $I1I11LL->GetOption("watermark_postf") != I5768) $I1lIIIl =true; $option =$doMapping ?'item_pictures' :I5781; $I1lIIIL =$I1I11LL->GetOption($option); $I1lIII1 =count($I1lIIIL); $pfx =$doMapping ?'ext_' :''; for($i=0;$i<$I1lIII1;$i++){ if(!empty($I1lIIIL[$i]) && $I1lIIIL[$i] != 'null' && $I1lIIIL[$i] != -222222){ $I1lIIIL[$i] =$pfx .$I1lIIIL[$i]; }else{ unset($I1lIIIL[$i]); }}if(!$I1lIIIl){ $sql ="select ".implode(I5782, $I1lIIIL)." from ".$tblName." where id=".intval($cId); }elseif(mb_strpos($tblName, "_cats") !== false){ $sql ="select ".implode(I5782, $I1lIIIL).", watermark_picture from ".$tblName." where id=".intval($cId); }else{ $sql ="select i.".implode(", i.", $I1lIIIL).", c.watermark_picture from ".$tblName.I5783.str_replace("_items", "_cats", $tblName)." c ON i.id_category=c.id where i.id=".intval($cId); }if ($GLOBALS['I1I1lLl'][I5784] == $sql) {$db->Record =$GLOBALS['I1I1lLl'][I5767]; }else {$GLOBALS['I1I1lLl'][I5784] =$sql; $db->query($sql); if (!$db->next_record()) {$db->Record =null; }$GLOBALS['I1I1lLl'][I5767] =$db->Record; }if($db->Record){ $level =3; $I1lIIlI =$doMapping ?array("small_", I5768, I5785) :array('_small', '', '_popup'); $optionSource =$doMapping ?'prior_source_picture' :I5786; if($I1I11LL->IssetOption($optionSource)){ $source =$I1I11LL->GetOption($optionSource); if($doMapping){ switch($source){ case 'picture': $I1lIIlI[] =''; break; case 'small_picture': $I1lIIlI[] ='small_'; break; }}else{ switch($source){ case I5787: $I1lIIlI[] =''; break; case 'ext_img_small': $I1lIIlI[] ='_small'; break; }}}foreach(array_reverse($I1lIIlI) as $picpref){ $field ='ext_' .($doMapping ?$picpref .I5788 :'img' .$picpref); if(!empty($db->Record[$field])){ $cOrigPicPath =$db->Record[$field]; $origFileLevel =$level; break; }$level--; }$I1lIIll =$db->Record[$doMapping ?'ext_' .$cType :$cType]; if(!empty($I1lIIll) && is_file($GLOBALS[I5777] .$I1lIIll)){ $imgData =imageGetSize($GLOBALS[I5777] .$cOrigPicPath); $I1I11L1 =$GLOBALS["ROOT_PATH_WWW"] .$I1lIIll; $I1I111I =$GLOBALS[I5777] .$I1lIIll; $I1I111l =array_key_exists("mime", $imgData) ?$imgData[I5789] :null; }$option =$doMapping ?'generate_pictures' :'ext_img_creatable'; $genPics =$I1I11LL->IssetOption($option) ?$I1I11LL->GetOption($option) :array(); $origFileName =I5768; $origFileExt =I5768; $origFileX =0; $origFileY =0; if(!empty($I1lIIll) and $cOrigPicPath != $I1lIIll){ $cOrigPicPath =$I1lIIll; }$I1lIIlL =false; if(!empty($cOrigPicPath) && sizeof($genPics) >0 && is_file($GLOBALS[I5777] .$cOrigPicPath)){ if(($pos =mb_strrpos($cOrigPicPath, ".")) !== false){ $origFileExt =mb_substr($cOrigPicPath, $pos+1); $origFileName =mb_substr($cOrigPicPath, 0, $pos); if(mb_strtolower($origFileExt) != 'swf'){ $I1lIIlL =true; }}}if(!$I1lIIlL){ return array($I1I11L1, $I1I111I, $I1I111l, $I1I111L); }$imgData =imageGetSize($GLOBALS[I5777] .$cOrigPicPath); $origFileX =$imgData[0]; $origFileY =$imgData[1]; $I1I111l =array_key_exists(I5789, $imgData) ?$imgData[I5789] :null; $aEvent =array( I5790 => $modName, 'itemId' => $cId, 'source' => $cType, 'width' => $origFileX, 'height' => $origFileY, I5791 => $I1I111l, 'path' => $cOrigPicPath, '_discard' => FALSE );AMI_Event::fire('on_before_image_resize', $aEvent, AMI_Event::MOD_ANY); $preffx =$cType; if($doMapping){ $pos =mb_strpos($preffx, '_'); $preffx =$pos !== FALSE ?mb_substr($preffx, 0, $pos +1) :I5792; }$possiblyWillBeGenerated =false; if(empty($aEvent['_discard'])){ if( defined('AMI_MAX_SOURCE_IMAGE_FILE_SIZE') && ($s =filesize($GLOBALS['ROOT_PATH'] .$cOrigPicPath)) >AMI_MAX_SOURCE_IMAGE_FILE_SIZE ){trigger_error("Maximum source image file '" .$cOrigPicPath .I5793 .$s .' exceeds ' .AMI_MAX_SOURCE_IMAGE_FILE_SIZE); }elseif( !empty($origFileName) && in_array($cType, $genPics) && (empty($I1lIIll) || $I1lIIll == $cOrigPicPath) ){$possiblyWillBeGenerated =true; }}if( $possiblyWillBeGenerated && $origFileX >0 && $origFileY >0 && $I1I11LL->issetOption($cType .'_maxwidth') && $I1I11LL->GetOption($cType .'_maxwidth') >0 && $I1I11LL->GetOption($cType .'_maxheight') >0 ){$currLevel =0; switch($preffx){ case I5794: case 'ext_img_popup': $currLevel =3; break; case I5792: case I5787: $currLevel =2; break; case 'small_': case 'ext_img_small': $currLevel =1; break; }if($origFileLevel <$currLevel){ return array($I1I11L1, $I1I111I, $I1I111l, $I1I111L); }$newFileX =$origFileX; $newFileY =$origFileY; $newFileMaxX =$I1I11LL->GetOption($cType .'_maxwidth'); $newFileMaxY =$I1I11LL->GetOption($cType .I5795); $option =$doMapping ?'generate_bigger_image' :'ext_img_create_bigger'; if( $newFileX >$newFileMaxX || $newFileY >$newFileMaxY || ($newFileX <$newFileMaxX && $newFileY <$newFileMaxY && $I1I11LL->GetOption($option) && mb_strpos($preffx, 'popup') === FALSE) ){if($newFileX /$newFileMaxX >= $newFileY /$newFileMaxY){ $newFileY =ceil($newFileY*$newFileMaxX/$newFileX); $newFileX =$newFileMaxX; }else{ $newFileX =ceil($newFileX*$newFileMaxY/$newFileY); $newFileY =$newFileMaxY; }}else{ $newFileMaxX =$newFileX; $newFileMaxY =$newFileY; }if(!$I1lIIIl && ($newFileX == $origFileX) && ($newFileY == $origFileY)){ return array($I1I11L1, $I1I111I, $I1I111l, TRUE); }$aExtFieldToPostfix =array(); if($doMapping){ $aMap =array( 'ext_picture' => I5787, I5796 => 'ext_img_small', 'ext_popup_picture' => 'ext_img_popup' );foreach($aMap as $field => $apiField){ $field =mb_substr($field, 4); $property ='generate_' .$field .I5797; if($I1I11LL->issetProperty($property)){ $aExtFieldToPostfix[$apiField] =$I1I11LL->getProperty($property); }}$field =isset($aMap['ext_'.$cType]) ?$aMap['ext_'.$cType] :I5792; }else{ if($I1I11LL->issetProperty('ext_img_postfixes')){ $aExtFieldToPostfix =$I1I11LL->getProperty('ext_img_postfixes'); }$field =$cType; }$I1lIIl1 =isset($aExtFieldToPostfix[$field]) ?$aExtFieldToPostfix[$field] :I5792; $I1lIILI =($I1lIIIl ?$I1I11LL->GetOption(I5798) :I5792) .(mb_strpos($preffx, 'small') !== FALSE && $I1I11LL->issetAndTrueOption('static_watermark') && is_file($GLOBALS['ROOT_PATH'] .$I1I11LL->GetOption('static_watermark')) ?I5799 :I5792 );$genFileName =$GLOBALS["CUSTOM_PICTURES_HTTP_PATH"] .$picSubPath ."/generated/" .basename($origFileName) .I5775 .$newFileX ."x" .$newFileY .$I1lIIl1 .$I1lIILI ."." .$origFileExt; if(is_file($GLOBALS[I5777].$genFileName)){ $I1I11L1 =$GLOBALS[I5800].$genFileName; $I1I111I =$GLOBALS[I5777].$genFileName; $I1I111L =true; }else{ $IllIlII ="php"; if(isset($GLOBALS["Core"]) && is_object($GLOBALS["Core"]) && $GLOBALS["Core"]->IssetOption("images_generator_lib")) $IllIlII =$GLOBALS["Core"]->GetOption("images_generator_lib"); $IllIlIl =new IMG_PROC($IllIlII); $IllIlIl->TIT1III($I1I11LI); if($I1I11LL->IssetOption("watermark_postf")) $IllIlIl->TIT1IIl($I1I11LL->GetOption("watermark_postf")); $I1IL1lI =Array(); $I1IL1ll =Array(); if($I1lIIIl && !empty($db->Record[I5801])){ $I1lIILl =$db->Record[I5801]; if($I1lIILl[0] == "*") $I1lIILl =mb_substr($I1lIILl, 1); $I1IL1lI["layer"] =$GLOBALS[I5777].$I1lIILl; $I1IL1lI["orient"] =$I1I11LL->IssetOption("watermark_method") ?$I1I11LL->GetOption(I5802) :I5768; $I1IL1lI["alpha"] =$I1I11LL->IssetOption("watermark_alpha") ?$I1I11LL->GetOption("watermark_alpha") :I5768; }if($preffx != "small_" && $I1I11LL->IssetOption(I5803) && $I1I11LL->GetOption(I5803) != I5768 && is_file($GLOBALS[I5777].$I1I11LL->GetOption(I5803))){ $I1IL1ll["layer"] =$GLOBALS[I5777].$I1I11LL->GetOption(I5803); $I1IL1ll["orient"] =$I1I11LL->IssetOption("static_watermark_method") ?$I1I11LL->GetOption("static_watermark_method") :I5804; $I1IL1ll["alpha"] =$I1I11LL->IssetOption("static_watermark_alpha") ?$I1I11LL->GetOption("static_watermark_alpha") :"85"; }if($IllIlIl->TIT1IT1($GLOBALS[I5777].$cOrigPicPath, $GLOBALS[I5777].$genFileName, $newFileX, $newFileY, true, 0, $I1IL1lI, $I1IL1ll)){ $I1I11L1 =$GLOBALS[I5800].$genFileName; $I1I111I =$GLOBALS[I5777].$genFileName; $I1I111L =true; $I1I1111 =TRUE; }else if(!empty($IllIlIl->I1I1LIl)){ $I1I11L1 =$GLOBALS[I5800].$IllIlIl->I1I1LIl; $I1I111I =$GLOBALS[I5777].$IllIlIl->I1I1LIl; $I1I111l =I5805; }}}else if(!empty($I1lIIll)){ $I1I11L1 =$GLOBALS[I5800].$I1lIIll; $I1I111I =$GLOBALS[I5777].$I1lIIll; }}}return array($I1I11L1, $I1I111I, $I1I111l, $I1I111L, $I1I1111); }}