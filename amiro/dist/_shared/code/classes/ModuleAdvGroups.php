<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       7006 xkqwwlklmnstkpgyzygyiwgxzsnxiquizttmuqznuxnwynlkxmgwqyimuiugxykppmyxpnir
 */ ?><?php foreach(array(6270=>"ZJJHCQS|ZWtMHnD",6271=>"SQJ",6272=>"fJt|nZIQ",6273=>"fJt|GJZWQ|MS",6274=>"",6275=>"fHrWQ",6276=>"nZIQ",6277=>"^",6278=>'nZIQ',6279=>'ZWtMHn',6280=>"ZWtMHn|QSMt",6281=>"QSMt|MS",6282=>"ZWtMHn",6283=>"Hn",6284=>'JQPQnS',6285=>'JQP|SQJ',6286=>"WZnWQJ",6287=>"ZSvnuI",6288=>"ZSv|GJZWQD") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleAdvGroups extends CMS_ActModule {public $IIllLI1; function ModuleAdvGroups(&$cms, &$db, &$cModule) {parent::CMS_ActModule($cms, $db, $cModule); $this->IIllLI1 =array(); }function _Init($IIll1l1 =Array(), $IIll1LI ='', $IIll1Ll ='', $aOptions =Array()) {$IIIIL11[I6270] =Array("add", "edit", "apply", "save", I6271); $IIIIL11["group_operations"] =Array(I6271, "copy"); $IIIIL11['default_prefix'] ='g'; $aOptions += $IIIIL11; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function _InitAdmin() {parent::_InitAdmin(); $sql ="select * from cms_adv_places where lang='".$this->langData."' order by name"; $this->db->query($sql); while($this->db->next_record()) $this->IIllLI1[] =$this->db->Record; }function ProcessAction($IIIL11l, $cId, $cModule ="") {parent::ProcessAction($IIIL11l, $cId, $cModule); }function TTTlIII() {parent::TTTlIII(); $this->filter->AddField("flt_name", "text", stripslashes(unhtmlentities($this->cms->Vars[I6272])), "", " like ", "g.name"); $this->filter->MoveField(I6272,_MOVE_START); if(empty($this->cms->Vars[I6272])) $this->filter->DisableFieldSQL(I6272); $placeId =intval(isset($this->cms->VarsPost["flt_place_id"]) ?$this->cms->VarsPost[I6273] :$this->cms->VarsGet[I6273]); $I1lLlLL =Array(); $I1lLlLL =$this->filter->TITI1TT($I1lLlLL, Array($this->cms->Words["all"]=>0), 55); for($i =0; $i <count($this->IIllLI1); $i++) $I1lLlLL =$this->filter->TITI1TT($I1lLlLL, Array($this->IIllLI1[$i]["name"] => $this->IIllLI1[$i]["id"]), 500); $this->filter->AddField(I6273, "select", $placeId, I6274, "like", "adv_places", $I1lLlLL); $this->filter->MoveField(I6273, _MOVE_START); $this->filter->TITIll1(I6273); if($placeId==0) {$this->filter->DisableFieldSQL(I6273); }else{ $this->filter->TITI1II(I6273, " OR g.adv_places like '%;".intval($placeId).";%'", I6275); }$this->filter->TITI1l1("datefrom"); $this->filter->TITI1l1("dateto"); }function TTTlI1I(&$vData) {parent::TTTlI1I($vData); }function TTTlI11(&$vData, &$aCustom) {for($i =0; $i <sizeof($this->IIllLI1); $i++){ $arr =array( "value" => $this->IIllLI1[$i]["id"], I6276 => $this->IIllLI1[$i][I6276], "selected" => mb_strpos($this->itemData["adv_places"], ";".$this->IIllLI1[$i]["id"].I6277) !== false ?" selected" :I6274, );$vData["adv_places"] .= $this->cms->Gui->get("adv_groups_subform:option", $arr); }$this->browser->InitSQL("g.id, g.name, g.adv_places", "FROM cms_adv_groups g", "WHERE 1 ".$this->_ApplyFilters().$this->TTTlIl1(), "g.id", "g.id" );$aCustom['fields'] =Array( I6278=>Array('action'=>'stripline', 'size'=>100), 'adv_places'=>Array(I6279=>'callback', 'object'=>&$this, 'method'=>'_advnumCB'), I6280=>Array("action"=>"flagicon", "value"=>I6274, "id"=>I6281, "on"=>$this->moduleName."_list:edit","off"=>I6274), 'action_del'=>Array(I6282=>"flagicon", "value"=>I6274, "id"=>"del_id", I6283=>$this->moduleName."_list:del","off"=>I6274), );$aCustom['applied_id'] ='d.id'; $aCustom[I6284] =Array('leg_red', 'leg_yellow', 'leg_blue', 'leg_edit', I6285); $aCustom["form_data"]["buttons"] =Array("add", "apply", I6286, "save"); parent::TTTlI11($vData, $aCustom); }function _advnumCB(&$aItem, &$aData){ $aItem["advnum"] ="0"; foreach(explode(I6277, $aItem["adv_places"]) as $key => $val){ if($val >0) $aItem[I6287]++; }$aItem[I6287] =I6274.$aItem[I6287]; }function TTTl1Tl($cId, $cModule) {parent::TTTl1Tl($cId, $cModule); $sql ="SELECT * ". "FROM cms_adv_groups g ". "WHERE g.id='".$cId."'".$this->_ApplyFilters(); $this->db->query($sql); if($this->db->next_record()) $this->itemData =$this->db->Record; }function TTTll11($cId, $cModule){ parent::TTTll11($cId, $cModule); }function TTTl1lI($cId, $cModule) {parent::TTTl1lI($cId, $cModule); }function _ActionDel($cId, $cModule) {parent::_ActionDel($cId, $cModule); }function TTT1IlI($aSql =Array(), $cId =0) {$name =$this->cms->VarsPost[I6276]; if(!is_array($this->cms->VarsPost[I6288])) $this->cms->VarsPost[I6288] =array(); $IIllLI1 =I6274; for($i =0; $i <sizeof($this->cms->VarsPost[I6288]); $i++) $IIllLI1 .= I6277.$this->cms->VarsPost[I6288][$i]; $IIllLI1 .= I6277; if($name != '' && $IIllLI1 != ';'){ $aSql =Array( I6276=>$name, I6288=>$IIllLI1, );}$aSql =parent::TTT1IlI($aSql, $cId); return $aSql; }}?>
