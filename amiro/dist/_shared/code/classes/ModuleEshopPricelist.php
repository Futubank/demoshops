<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       32827 xkqwwnuztigigisnyqtsrutitxsrgriztnwwysqzpgtxllwiqxmsttuztwitkpykruqqpnir
 */ ?><?php foreach(array(8725=>"",8726=>'OMSQ|futurQ|MtQID',8727=>"|WZtD?COQrQ?MS=",8728=>"WuDtHI",8729=>'|GMWturQ',8730=>"MtQI|GMWturQD",8731=>"PQtgZtO",8732=>"YHSB|MtQID",8733=>"WZtHffDQt",8734=>'GuDO',8735=>"'?",8736=>"ZnnHunWQ",8737=>"DuYJMnK",8738=>"SY|WurrQnWB",8739=>"iHSuJQotIJ",8740=>"SQtZMJD|nHMnSQx",8741=>"WZt|GZtO",8742=>'JMDt|DQt|QIGtB',8743=>"WZts",8744=>"|WZtD?",8745=>"WZts|rHC",8746=>"WZts|JMDt|",8747=>'JMDt|SZtZ',8748=>'GZPQ|MtQI|tBGQ',8749=>"frHI",8750=>"ZWtMHn",8751=>'fMQJSD',8752=>'IQtOHS',8753=>"|MtQI",8754=>'WuDtHI|fMQJSD',8755=>"JMDt|WZt|MtQID",8756=>"DQJQWt",8757=>"ZSS|QxtQntMHn|DEJ",8758=>"M`",8759=>'M',8760=>"GrMWQ|OQZSQr",8761=>"GrMWQ|WZGtMHn",8762=>'ZWtMHn',8763=>'GrMWQwurrQnWMQD',8764=>'DGJMttQr|Hff',8765=>'GrMWQwZGtMHnD',8766=>"MS",8767=>"nZIQ",8768=>"GrQfMxTQIGJ",8769=>"rQWHrS",8770=>"ZJt",8771=>"GrHG|nuI",8772=>'',8773=>"MtQI|WZtMtQID",8774=>"M",8775=>"?",8776=>'|WuDtHI|fMQJSD',8777=>"WZt|MS",8778=>"WZtMS",8779=>"JMnK",8780=>"WZt|ZnnHunWQ",8781=>"nH|GrHSuWtD",8782=>"HtOQr|GrMWQ|OQZSQr",8783=>"MtQID|OQZSQr",8784=>"nZv|SZtZ",8785=>'Qxt|MIZPQD',8786=>"WZtMS|DuYJMnK",8787=>"nZIQ|JMnK",8788=>"DKu",8789=>"SQDWrMGtMHn",8790=>"MtQID|JMDt",8791=>"MtQI") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleEshopPricelist extends CMS_ActModule {public $oEshop; public $catId; public $IIllILI; public $I1IL1Ll; public $lIII1L1; public $lIlII11; public $catSublink; public $lIII1IL; public $lIlIlII; public $lIlIlIl; public $lIlIlIL; public $lIlIlI1; public $lIlIllI; public $IILLL11; public $showEmptyCaptions; public $Il11IL1; public $_path; public $lIlIlll; public $lIlIllL; public $lIII11l; public $lIlIll1; public $lIlIlLI; public $lIlIlLl; public $lIlIlLL; public $lIlIlL1; public $lIlIl1I; public $lIlIl1l; public $lIlIl1L; function ModuleEshopPricelist(&$cms, &$db, &$cModule) {parent::CMS_ActModule($cms, $db, $cModule); require_once $GLOBALS['CLASSES_PATH'] .'EshopFront.php'; $this->I1IL1Ll =I8725; if($this->side != "admin") {CreateEshop($cms); $this->oEshop =&$cms->Eshop; }$this->lIlIl1I =I8725; $this->lIlIl1l =I8725; }function _Init($IIll1l1 =Array(), $IIll1LI ='', $IIll1Ll ='', $aOptions =Array()) {$aOptions['multi_sites'] =true; $aOptions[I8726] =false; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); $this->lIlIlLL =I8725; $this->lIlIlL1 =false; }function TTTlTI1() {if(!$this->lIII1L1) {parent::TTTlTI1(); $this->lIII1L1 =true; $this->oEshop->TT1l11l($this->options["multi_sites"], $this->siteId); $this->catId =$this->oEshop->rootCatId; if(isset($this->cms->VarsGet["catid"])) {$this->catId =intval($this->cms->VarsGet["catid"]); }if($this->catId >0){ $sql ="select dataset_id, dataset_data from ".$this->oEshop->dbTablePrefix.I8727.intval($this->catId); $this->db->query($sql); if($this->db->next_record()){ $IL1ILLl =array(); $IIlLIIL =Array("action"=>"set_dataset", "id"=>0, "item_data"=>&$this->db->Record, I8728=>&$IL1ILLl); $this->TTT1lI1($IIlLIIL); $this->lIIlIIl =$IL1ILLl["prop_num"] >0; }}$this->TT11TTT(); $this->lIlII11 =false; $this->IILLL11 =$this->oEshop->ILlLL1I->GetOption("show_empty_cats"); $this->showEmptyCaptions =$this->oEshop->ILlLL1I->GetOption("show_empty_captions"); $this->oEshop->showEmptyCaptions =$this->showEmptyCaptions; $this->Il11IL1 =$this->oEshop->ILlLL1I->GetOption("selected_fields"); foreach($this->Il11IL1 as $lIlIl11 => $lIlILII){ if( mb_strpos($lIlILII,I8729) !== FALSE){ $this->Il11IL1[$lIlIl11] =preg_replace_callback('/[\w\d\.\_]*picture[\s\,]*/', create_function( '$matches', 'if(mb_strpos($matches[0],"ext_") === FALSE)return "";return $matches[0];' ),$this->Il11IL1[$lIlIl11]); }}if(!$this->oEshop->ILlLL1I->GetOption("show_buy_links")) {$this->oEshop->TITTT11(); }if(sizeof($this->options[I8730]) >0) {$aImages =array ();foreach ($this->options[I8730] as $lIlILIl) {if(!empty($lIlILIl) && $lIlILIl != 'null' && $lIlILIl != -222222){ $aImages[] ='ext_' .$lIlILIl; }}$this->lIlIl1I =", i.".implode(", i.", $aImages); }}}function TT11TTT() {$this->oEshop->tree->setCallbackObject($this); $this->oEshop->tree->setCallbackMethod(I8731, "_getPathFrontCB"); $this->oEshop->tree->TI11IIT("path", "name, is_price_list, sublink"); }function &TTTllTl(&$aCustom) {$aData =parent::TTTllTl($aCustom); $this->oEshop->TITTITT(); return $aData; }function TTTllIl(&$aData, &$aCustom) {parent::TTTllIl($aData, $aCustom); $this->IIllI1l =false; $this->IIllI1I =false; $this->IIllI11 =false; }function TTTllTI(&$aCustom) {if($this->catId >0) {if(!$this->lIlII11) {$this->SetBodyType("body_cats"); }else {$this->SetBodyType(I8732); }}parent::TTTllTI($aCustom); }function TTTlllT(&$vData) {parent::TTTlllT($vData); $this->cms->SetsTemplate =$this->moduleName."_list"; $this->oEshop->TITTIIl($vData, $this->cms->SetsTemplate); $this->oEshop->ILLlllI ="pricelist"; $this->catId =$this->oEshop->rootCatId; if(isset($this->cms->VarsGet["catid"])) {$this->catId =intval($this->cms->VarsGet["catid"]); }$this->catOffset =0; if(isset($this->cms->VarsGet[I8733])) {$this->catOffset =intval($this->cms->VarsGet[I8733]); }$I1LLLLI =$this->oEshop->mEshop->GetOption("path_settings_front"); $I1LLLLl =$this->oEshop->mEshop->GetOption('path_settings_front_strip_text'); $path =I8725; $this->oEshop->tree->initResult($path); $this->_path =$this->oEshop->tree->getPath($this->catId, "path", "name", abs((int)$I1LLLLI[0]), abs((int)$I1LLLLI[1]), abs((int)$I1LLLLI[3]), abs((int)$I1LLLLI[2]), $I1LLLLl); $this->lIlIll1 =Array(); $this->lIlIlLI =Array(); $this->lIII1IL =true; $this->lIlIlll =I8725; $this->lIlIllL =I8725; $this->lIII11l =Array(); $this->lIlIl1L =0; $this->TTITTTI(I8734); $sql ="SELECT id, announce, description, sublink, id_parent, name ".$this->oEshop->getPriceFields("price_caption%d, SUBSTRING(price%d, INSTR(price%d, '#')+1, 3) AS currency%d, SUBSTRING(price%d, INSTR(price%d, ':')+1, 3) AS db_currency%d").", sm_data, details_noindex, dataset_id FROM ".$this->oEshop->dbTablePrefix."_cats WHERE id='".$this->catId.I8735.$this->_ApplyFilters(); $this->TTITTTI('pop'); $this->db->query($sql); if(!$this->db->next_record()) {$this->lIII1IL =false; }else {$this->cms->Gui->AddGlobalVars(Array("CURRENT_CAT_ID" => $this->catId)); $this->cms->Core->Cache->TT1TI1l("CURRENT_CAT_ID", $this->catId); $this->lIlIlll =$this->db->Record["description"]; $this->lIlIllL =$this->db->Record[I8736]; $this->lIlIl1L =$this->db->Record['dataset_id']; $navData["catid"] =$this->db->Record["id"]; $navData["catid_sublink"] =$this->db->Record[I8737]; $this->lIII11l =$this->cms->ApplyNav($navData); for($i=0;$i<$this->oEshop->numPrices;$i++) {$numPrice =$this->oEshop->priceFields[$i]; $this->lIlIll1["price_caption".$numPrice] =$this->db->Record["price_caption".$numPrice]; $this->lIlIlLI["currency".$numPrice] =$this->db->Record["currency".$numPrice]; $this->lIlIlLI[I8738.$numPrice] =$this->db->Record[I8738.$numPrice]; }if(isset($this->db->Record["sm_data"])) {$IIl1IL1 =unserialize($this->db->Record["sm_data"]); $GLOBALS[I8739]["headers"] =$this->cms->TITlTl1($GLOBALS[I8739]["headers"], $IIl1IL1); }if($this->db->Record[I8740] == '1') {$this->TTTllT1(); }}$this->lIlIlII =false; $this->lIlIlIL =true; $this->lIlIlIl =false; if($this->catId != $this->oEshop->rootCatId) {$this->filter->AddField("catid", "hidden", $this->catId); }}function TTTll1T(&$vData, &$aCustom) {$this->browser->InitPager($this->catOffset, $this->oEshop->ILlLL1I->GetOption("cat_page_size")); $vData[I8741] =$this->_path; $vData[I8741] =$this->cms->TTITI1l("cat", "path", $vData); if($this->lIII1IL && $this->catId >0) {$vData["top_cat_announce"] =$this->lIlIllL; $vData["top_cat_detail"] =$this->lIlIlll; $aCustom[I8742] =''; if(!$this->lIlII11) {$aCustom['page_item_type'] ="body_cats"; $vData['description'] =$this->cms->TTITI1l(I8743, "description", $this->db->Record); $this->TTTllll($vData, $aCustom); $this->browser->InitPager($this->catOffset, $this->oEshop->ILlLL1I->GetOption("cat_page_size")); $this->browser->InitSQL("id, name, announce, description, sublink", "FROM ".$this->oEshop->dbTablePrefix.I8744, "WHERE id_parent='".$this->catId."'  ".$this->_ApplyFilters('', '', false) );$this->browser->SetForceRules("ORDER BY urgent DESC, ".$this->oEshop->ILlLL1I->GetOption("page_sort_col_cats")." ".$this->oEshop->ILlLL1I->GetOption("page_sort_dim_cats")); $aCustom['row_set'] =I8745; $aCustom['list_set'] ="catD_list"; $aCustom['list_data']["splitter_prefix"] =I8746; $aCustom['simple_set_fields'] =Array("fdate", "name", I8736, "description"); $aCustom[I8747]['simple_prefix'] ="catD_"; parent::TTTll1T($vData, $aCustom); $this->lIlIlIl =$this->db->num_rows(); }else {$this->lIlIlI1 =$this->oEshop->ILlLL1I->GetOption("page_sort_col_pricecats"); $this->lIlIllI =$this->oEshop->ILlLL1I->GetOption("page_sort_dim_pricecats"); if(empty($aCustom[I8748])) {$aCustom['page_body_type'] =I8732; }$this->TTT1I11(); $this->options["default_prefix"] ="c."; $this->lIlIlLl =Array("select"=>I8725, I8749=>I8725, "join"=>I8725, "where"=>I8725, "group"=>I8725, "order"=>I8725); $IIlLIIL =Array(I8750=>"add_extention_sql", "id"=>0, "item_data"=>I8725, "data"=>&$this->lIlIlLl, I8728=>&$aCustom); $this->TTT1lI1($IIlLIIL); if(isset($aCustom[I8751]['custom_fields']) && is_object($aCustom[I8751]['custom_fields']['object']) && !empty($aCustom[I8751]['custom_fields'][I8752])) {$this->lIlIlLL =$aCustom[I8751]['custom_fields'][I8752]; $this->lIlIlL1 =$aCustom[I8751]['custom_fields']['object']; }else {$this->lIlIlLL ="_CustomFiledStubCB"; $this->lIlIlL1 =&$this; }$this->lIlIl1l =$this->_ApplyFilters(); $this->TTTlll1($this->oEshop->ownerName.I8753); $aCustom[I8748] =I8732; $this->TTTllll($vData, $aCustom); $IIlLIIL =Array(I8750=>"add_extention_sql", "id"=>0, "item_data"=>I8725, "data"=>&$this->lIlIlLl, I8728=>&$aCustom); $this->TTT1lI1($IIlLIIL); if(isset($aCustom[I8751][I8754]) && is_object($aCustom[I8751][I8754]['object']) && !empty($aCustom[I8751][I8754][I8752])) {$this->lIlIlLL =$aCustom[I8751][I8754][I8752]; $this->lIlIlL1 =&$aCustom[I8751][I8754]['object']; }else {$this->lIlIlLL ="_CustomFiledStubCB"; $this->lIlIlL1 =&$this; }$vData["list_cat_items"] =$this->TIIll1T($this->catId); $this->TTT1lTT(); $this->lIlIlIL =($vData[I8755] == I8725); $this->lIlIlII =!$this->lIlIlIL; }if($this->lIlII11) {$itemType ="item"; }else {$itemType =I8743; }$this->I1IL1Ll["prefixTempl"] =$itemType."_topitems"; $aCustom[I8748] =I8732; if($this->lIlIlIL) {$this->browser->InitPager($this->offset, $this->oEshop->ILlLL1I->GetOption("page_size")); }else {$this->browser->PageSize =99999999; }$this->lIlIlLl =Array(I8756=>I8725, I8749=>I8725, "join"=>I8725, "where"=>I8725, "group"=>I8725, "order"=>I8725); $IIlLIIL =Array(I8750=>I8757, "id"=>0, "item_data"=>I8725, "data"=>&$this->lIlIlLl, I8728=>&$aCustom); $this->TTT1lI1($IIlLIIL); $this->TTT1I11(); $this->options["default_prefix"] =I8758; $this->browser->InitSQL("i.id, i.name,i.rest,i.weight,i.size,i.price AS price0". $this->oEshop->getPriceFields("i.price%d"). ", ".$this->Il11IL1[$itemType."_topitems"]."i.tax, i.tax_type, i.charge_tax_type, ". "date_format(i.date,'".$this->cms->DFMT["db"]."') as fdate, ". "i.discount, i.discount_type, i.sublink, i.item_type, i.num_files, i.files_size, i.sku, ". "(LENGTH(i.description) = 0) AS descr_empty".$this->lIlIlLl[I8756], "FROM ".$this->oEshop->dbTablePrefix."_items i", "WHERE i.id_category='".$this->catId."'  ".$this->_ApplyFilters(I8759, '', false).$this->oEshop->TITTIII("i"), '' );$this->browser->SetForceRules("ORDER BY i.urgent DESC, i.name ASC"); $this->TTT1lTT(); if($this->oEshop->showBasePrice) {$vData[I8760] =$this->cms->TTITI1l($itemType, "topitems_price_header", $vData); }$vData[I8760] =$this->cms->TTITI1l($itemType, "topitems_price_header", $vData); $vData['other_price_header'] =''; for($i=0; $i<$this->oEshop->numPrices; $i++) {$numPrice =$this->oEshop->priceFields[$i]; if($this->oEshop->showEmptyCaptions || $this->lIlIll1[I8761.$numPrice] != I8725) {$vData["other_price_header"] .= $this->cms->TTITI1l($itemType, "topitems_other_price_header", Array("caption" => $this->lIlIll1[I8761.$numPrice], "num_price"=>$numPrice) +$vData); }}$IIlLIIL =Array(I8750=>"get_price_list_header", "id"=>0, I8728=>&$vData); $this->TTT1lI1($IIlLIIL); $aCustom[I8747]['items_header'] =$this->cms->TTITI1l($itemType, "topitems_header", $vData); $aCustom[I8751]['other'] =Array(I8762=>'callback', 'object'=>&$this, I8752=>'_getItemRowCB'); $aCustom[I8747]['priceCaptions'] =$this->lIlIll1; $aCustom[I8747][I8763] =$this->lIlIlLI; $aCustom['row_set'] =$itemType."_topitems_row"; $aCustom['list_set'] =$itemType."_list_topitems"; $aCustom[I8764] =1; parent::TTTll1T($vData, $aCustom); $this->lIlIlII =$this->db->num_rows(); }$lIlILIL =$this->lIlIlII ?false :($this->lIlII11 || !$this->lIlIlIl); if($lIlILIL) {$vData["content"] =$this->cms->TTITI1l($aCustom[I8748], "content_empty", I8725); $aCustom['page_body_type'] ="body_empty"; }}function _getItemRowCB(&$aItem, &$aData) {$aTmp =$aItem +$aData[I8765] +$aData[I8763]; $aItem["itemid"] =$aItem["id"]; $aItem['dataset_id'] =$this->lIlIl1L; if($this->oEshop->mEshop->IsFrontAllowed()) {$navData =Array(); $navData += $this->lIII11l; if($this->oEshop->showDetailLink || !$aItem["descr_empty"]) {$navData[I8766] =$aItem[I8766]; $navData["id_sublink"] =$aItem[I8737]; }$navData =$this->cms->ApplyNav($navData); $aItem["name"] =$this->cms->TTITI1l($this->I1IL1Ll["prefixTempl"], "name_link", Array(I8767=>$aItem[I8767]) +$navData); if ($this->lIIlIIl) {$this->oEshop->TITTT11(); }}$aItem["nav_data"] =$this->lIII11l["nav_data"]; $price =$this->oEshop->TITTITI($aItem, $aItem, $this->I1IL1Ll["prefixTempl"], $this->I1IL1Ll["prefixTempl"]); $lIlILI1 =$this->oEshop->TITTITl($aItem, $aTmp, $this->I1IL1Ll[I8768], $this->I1IL1Ll[I8768]); $aItem["price"] =$price; $aItem["other_price"] =$lIlILI1; }function TTT1I1l() {return $this->IIllILI; }function _getPathFrontCB(&$res, $itemId, $itemName, $stripItemName, &$Il11L1l) {$tmp =I8725; if($Il11L1l["record"]["is_price_list"]) {$this->lIlII11 =true; $this->catId =$itemId; $this->catSublink =$Il11L1l[I8769][I8737]; }if($Il11L1l["skip_item"]) {$tmp =$this->cms->Gui->getAbs("eshop_price_list_list:cat_path_skip_item", Array(I8767=>$stripItemName)); }else {if($Il11L1l["is_current"]) {if($itemId != $this->oEshop->rootCatId || $this->oEshop->ILlLLLL->GetOption("show_root_cat")) {$tmp =$this->cms->Gui->getAbs("eshop_price_list_list:cat_path_name", Array(I8767=>$stripItemName, "alt" =>$itemName)); }}else {$vNavData["catid"] =$itemId; $vNavData["catid_sublink"] =$Il11L1l[I8769][I8737]; $vNavData =$this->cms->ApplyNav($vNavData); $tmp =$this->cms->Gui->getAbs("eshop_price_list_list:cat_path_nav_name", Array(I8766=>$itemId, I8767=>$stripItemName, I8770=>$itemName) +$vNavData); }}if($itemId != $this->oEshop->rootCatId && !empty($tmp) ){$res .= ($this->cms->TTITI1l("cat", "path_Hsplitter", I8725)).$tmp; }else {$res .= $tmp; }$this->lIII1Ll++; return !$this->lIlII11; }function TIIll1T($parentId, $lIlILlI =0, $firstIter =true) {$db =new DB_si; $lIlILll =array ();$sql ="SELECT id, dataset_id, dataset_data " ."FROM ".$this->oEshop->dbTablePrefix.I8744 ."WHERE id_parent = '". $parentId ."'"; $db->query($sql); while ($db->next_record()) {$lIILlLL =array(); $IL1ILLl =array(); $IIlLIIL =Array(I8750=>"set_dataset", I8766=>0, "item_data"=>&$db->Record, I8728=>&$IL1ILLl); $this->TTT1lI1($IIlLIIL); $lIlILll[$db->Record['id']] =$IL1ILLl[I8771] >0; }$lIlILlL =false; $lIlILl1 =''; if ($this->options['use_special_list_view'] && $this->bodyType == 'body_items') {$lIlILl1 =', i.urgent DESC'; $this->bodyType =I8772; }$sql ="SELECT i.id".$this->lIlIlLl[I8756].", c.id AS cat_id, c.sublink AS cat_sublink, i.name,i.rest,i.weight,i.size,i.price AS price0, ". "i.tax,i.tax_type,i.charge_tax_type,i.discount,i.discount_type, i.sublink, i.id_category, i.sku, ". "i.item_type, i.num_files, i.files_size, ".$this->Il11IL1[I8773]. "c.name AS cat_name, c.dataset_id, ". "date_format(i.date,'".$this->cms->DFMT["db"]."') as fdate, ". "i.id IS NULL AS no_products". $this->oEshop->getPriceFields("i.price%d, SUBSTRING(c.price%d, INSTR(c.price%d, '#')+1, 3) AS currency%d, SUBSTRING(c.price%d, INSTR(c.price%d, ':')+1, 3) AS db_currency%d, c.price_caption%d").$this->lIlIlLl[I8756].$this->lIlIl1I. " FROM ".$this->oEshop->dbTablePrefix."_cats c LEFT JOIN ".$this->oEshop->dbTablePrefix."_items AS i ON i.id_category=c.id ".$this->_ApplyFilters(I8774, I8772, false)." AND i.lang='".$this->langData."'".$this->oEshop->TITTIII(I8774). " WHERE c.id_parent='".$parentId.I8735.$this->lIlIl1l. " ORDER BY c.".$this->lIlIlI1.I8775.$this->lIlIllI.$lIlILl1.", i.".$this->browser->TI1TTlT(); if ($this->options['use_special_list_view']) {$this->bodyType ='body_items'; }$db->query($sql); $curCatId =-1; $lIlILLI =false; $lIlILLl =false; $lIlILLL =false; $lIlILL1 =&$this->ext['ext_' .$this->oEshop->ownerName .I8776]; if($db->num_rows() >0) {$lIlIL1I["cat_level"] =$lIlILlI; while($db->next_record()) {$lIlILLl =$db->Record["no_products"]; if($curCatId != $db->Record["cat_id"]) {if($lIlILLI) {$lIlILLI =false; if($firstIter) {$firstIter =($lIlILLL && !$this->IILLL11); }else {if(!$lIlILLL || $this->IILLL11) {$html .= $this->cms->TTITI1l("item", "list_catitems_splitter", $itemData +$lIlIL1I); }}if($lIlILLL) {if($this->IILLL11) {$html .= $this->cms->TTITI1l("item", "list_catitems_empty", $itemData +$lIlIL1I); }}else {$html .= $this->cms->TTITI1l("item", "list_catitems", $itemData +$lIlIL1I); }$html .= $this->TIIll1T($curCatId, $lIlILlI+1, $firstIter); }if(!$lIlILLI) {$curCatId =$db->Record[I8777]; $itemData["items_list"] =I8725; $itemData["cat_name"] =$db->Record["cat_name"]; if(!$db->Record["no_products"] && $this->oEshop->mEshop->IsFrontAllowed()) {$navData =Array(); $navData[I8778] =$db->Record[I8777]; $navData["catid_sublink"] =$db->Record["cat_sublink"]; $navData =$this->cms->ApplyNav($navData); $itemData["cat_name"] =$this->cms->TTITI1l("cat_name", I8779, Array("cat_name"=>$db->Record["cat_name"]) +$navData); }else {$itemData["cat_name"] =$db->Record["cat_name"]; }$itemData[I8780] =isset($db->Record[I8780])?$db->Record[I8780]:I8725; $itemData["cat_description"] =isset($db->Record["cat_description"])?$db->Record["cat_description"]:I8725; $lIlILLL =$db->Record["no_products"]; if(!$db->Record[I8781]) {$lIlIL1l =Array(); if($this->oEshop->showBasePrice) {$lIlIL1l[I8760] =$this->cms->TTITI1l("item", "catitems_price_header", $lIlIL1I); }$lIlIL1l["other_price_header"] =I8725; for($i=0;$i<$this->oEshop->numPrices;$i++) {$caption =$db->Record[I8761.$this->oEshop->priceFields[$i]]; if($this->showEmptyCaptions || $caption!=I8725) {if(trim($caption) == I8725) {$caption ="&nbsp;"; }$lIlIL1l[I8782] .= $this->cms->TTITI1l("item", "catitems_other_price_header", Array("caption" => $caption) +$lIlIL1I); }}$IIlLIIL =Array(I8750=>"get_price_list_header", I8766=>0, I8728=>&$lIlIL1l); $this->TTT1lI1($IIlLIIL); $itemData[I8783] =$this->cms->TTITI1l("item", "catitems_header", $lIlIL1l +$lIlIL1I); }$lIlILLI =true; }}$lIlIL1L =Array(); $lIlIL1L =$db->Record; $lIlIL1L["itemid"] =$lIlIL1L[I8766] =$db->Record[I8766]; $lIlIL1L["nav_data"] =$this->lIII11l[I8784]; $vData =array("simple_prefix"=>"item_"); if(!$db->Record[I8781]) {$IIlLIIL =Array(I8750=>"_GetPicturesCB", "data"=> $_data =array(&$lIlIL1L, &$vData)); $this->TTT1lI1($IIlLIIL, array(I8785)); if ($lIlILll[$lIlIL1L['cat_id']]) {$lIlIL1L['ESHOP_BUY_ZERO'] =I8772; }$basePrice =$this->oEshop->TITTITI($lIlIL1L, $db->Record, I8773, I8773); $lIlILI1 =$this->oEshop->TITTITl($lIlIL1L, $db->Record, I8773, I8773); $lIlIL1L["price"] =$basePrice; $lIlIL1L["other_price"] =$lIlILI1; if($this->oEshop->mEshop->IsFrontAllowed()) {$navData =Array(); $navData[I8778] =$db->Record[I8777]; $navData[I8786] =$db->Record["cat_sublink"]; if($this->oEshop->showDetailLink || !$db->Record["descr_empty"]) {$navData[I8766] =$db->Record[I8766]; $navData["id_sublink"] =$db->Record[I8737]; }$navData =$this->cms->ApplyNav($navData); $lIlIL1L[I8767] =$this->cms->TTITI1l("item", I8787, Array(I8767=>$db->Record[I8767]) +$navData); }else {$lIlIL1L[I8767] =$db->Record[I8767]; }$lIlIL1L[I8736] =isset($db->Record[I8736])?$db->Record[I8736]:"&nbsp;"; if($lIlIL1L[I8736] == I8725) {$lIlIL1L[I8736] ="&nbsp;"; }$lIlIL1L["sku"] =$db->Record["sku"]; if($lIlIL1L[I8788] == I8725) {$lIlIL1L[I8788] ="&nbsp;"; }if($lIlIL1L["fdate"] == I8725) {$lIlIL1L["fdate"] ="&nbsp;"; }$lIlIL1L[I8789] =isset($db->Record[I8789])?$db->Record[I8789]:I8725; $this->oEshop->TT1111T("pricelist_catitems", $db->Record, $lIlIL1L); $this->lIlIlL1->{$this->lIlIlLL}($lIlIL1L, $lIlIL1L); $itemData["items_list"] .= $this->cms->TTITI1l("item", "catitems_row", $lIlIL1L +$lIlIL1I); }else {$itemData[I8790] .= $this->cms->TTITI1l("item", "catitems_row_empty", $lIlIL1I); }}if($firstIter) {$firstIter =($lIlILLL && !$this->IILLL11); }else {if(!$lIlILLl || $this->IILLL11) {$html .= $this->cms->TTITI1l("item", "list_catitems_splitter", $itemData +$lIlIL1I); }}if($lIlILLl) {if($this->IILLL11) {$html .= $this->cms->TTITI1l(I8791, "list_catitems_empty", $itemData +$lIlIL1I); }}else {$html .= $this->cms->TTITI1l(I8791, "list_catitems", $itemData +$lIlIL1I); }$html .= $this->TIIll1T($curCatId, $lIlILlI+1, $firstIter); }return $html; }function _CustomFiledStubCB(&$aTmp, &$aTmp) {}}