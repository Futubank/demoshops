<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       9106 xkqwyzzxtkiwtmyitxzxsugykiuywpxupzxnussrpmtgtszxzuzyzqktlxltzxrmyxpppnir
 */ ?><?php foreach(array(9160=>"PrHuG|HGQrZtMHnD",9161=>"QSMt",9162=>"ZWtMHn",9163=>"MSD|frHI|JMDt",9164=>"nZIQ",9165=>"QSMtmS",9166=>"ZSS",9167=>"ZWtMHn|HrMPMnZJ",9168=>"GrMWQ",9169=>"ZSSQSNZIQ",9170=>"ZGGJB|GrMWQ",9171=>"{?",9172=>"MS",9173=>"r`MS?NhT?mN?}",9174=>".",9175=>"r`MS?sqdw",9176=>"DtrMGJMnQ",9177=>"DQJ|MS",9178=>"ZWtMHn|QSMt",9179=>"Hn",9180=>"fJZPMWHn",9181=>"Hff",9182=>"JQP|YJuQ",9183=>"YuttHnD",9184=>"r`MS",9185=>"IQtZD",9186=>"PrG|ZGGJB|GrMWQ",9187=>"PrGgrMWQ") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleEshopShippingRegionsPopup extends ModuleEshopShippingRegions {public $lIlLLI1; public $lIlLLlI; public $lIlLLll; function ModuleEshopShippingRegionsPopup(&$cms, &$db, &$cModule) {parent::ModuleEshopShippingRegions($cms, $db, $cModule); }function _Init($IIll1l1 =array (),$IIll1LI ='', $IIll1Ll ='', $aOptions =array ()){$IIIIL11 =array (I9160 => array ("del", "apply_price"), "allowed_actions" => array ("add", I9161, "apply", "save", "del"), );$aOptions += $IIIIL11; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function _InitAdmin() {$this->lIlLLlI =""; $this->lIlLLll =array ();parent::_InitAdmin(); }function TTTlIII() {parent::TTTlIII(); if (isset($this->cms->VarsPost[I9162]) && $this->cms->VarsPost[I9162] == "add" && mb_strlen($this->cms->VarsPost["price"]) >0) {$this->lIlLLI1 =(isset($this->cms->VarsPost["ids_from_list"]) ?($this->cms->VarsPost["ids_from_list"] .(mb_strlen($this->cms->VarsPost[I9163]) >0 ?"," :"")) :"") .$this->appliedId; }else {if (isset($this->cms->VarsPost[I9163])) {$this->lIlLLI1 =$this->cms->VarsPost[I9163]; }else {$this->lIlLLI1 =$this->cms->VarsGet[I9163]; }}$this->filter->AddField(I9163, "hidden", $this->lIlLLI1); }function TTTlI1I(&$vData) {parent::TTTlI1I($vData); if (count($this->itemData) == 0) {$vData[I9164] =""; }else {$vData[I9164] =$this->itemData[I9164]; }$vData["addedId"] =$vData["addedPrice"] =$vData["addedName"] =$vData[I9165] =$vData["id_to_update"] =$vData["price_to_update"] =""; if (!empty($this->cms->VarsPost["price"])) {if ($this->action == I9166) {$vData["addedId"] =$this->appliedId; $vData["addedPrice"] =trim($this->cms->VarsPost["price"]); $vData["addedName"] =trim($this->cms->VarsPost[I9164]); $this->appliedId =0; }else if ($this->cms->Vars[I9167] == "apply") {if (in_array($this->appliedId, explode(',', $this->lIlLLI1))) {$vData["id_to_update"] =$this->appliedId; $vData["price_to_update"] =trim($this->cms->VarsPost[I9168]); $vData[I9165] =$this->appliedId; $this->cms->Gui->AddGlobalVars(Array("FORM_MODE"=>"EDIT")); }else {$vData["addedId"] =$this->appliedId; $vData["addedPrice"] =trim($this->cms->VarsPost[I9168]); $vData[I9169] =trim($this->cms->VarsPost[I9164]); }}}else if ($this->action == I9161) {$vData[I9165] =$this->IIllIlI; }if (empty($this->lIlLLlI)) {$vData["apply_price"] =$vData["ids_to_apply_price"] =$vData["names_to_apply_price"] =""; }else {$vData[I9170] =$this->lIlLLlI; $orderDirection =$this->cms->Core->GetModOption($this->oEshop->ownerName ."_shipping_regions", "page_sort_dim"); $orderField =$this->cms->Core->GetModOption($this->oEshop->ownerName ."_shipping_regions", "page_sort_col"); $sql ="SELECT `id`, `name` " ."FROM `" .$this->oEshop->dbTablePrefix ."_shipping_regions` " ."WHERE `id` IN (" .implode(",", $this->lIlLLll) .I9171 ."ORDER BY `" .$orderField ."` " .$orderDirection; $this->db->query($sql); $ids =array ();$vData["names_to_apply_price"] =""; while ($this->db->next_record()) {$ids[] =$this->db->Record[I9172]; $vData["names_to_apply_price"] .= $this->cms->Gui->getAbs($this->moduleName ."_subform:name_to_apply_price", array (I9164 => $this->db->Record[I9164])); }$vData["ids_to_apply_price"] =implode(",", $ids); }$this->appliedId =0; }function TTTlI11(&$vData, &$aCustom) {$lIlLLlL =mb_strlen($this->lIlLLI1) >0 ?I9173 .$this->lIlLLI1 .I9171 :"1 "; $this->browser->InitSQL( "r.* ", array ("tables" => array ("r" => I9174 .$this->oEshop->dbTablePrefix ."_shipping_regions` ")), "WHERE " .$lIlLLlL .$this->_ApplyFilters() .$this->TTTlIl1(), "r.id", "", I9175 );$this->browser->AddSQLJoinedTables($this->cms->Core, "r", array ("m2r" => I9174 .$this->oEshop->dbTablePrefix ."_shipping_methods_regions` ")); $aCustom["fields"] += array (I9168 => array (I9162 => I9176, "size" => 64), "action_select" => array (I9162 => "flagicon", "value" => 1, I9172 => I9177, "on" => $this->moduleName ."_list:select_icon", "off" => $this->moduleName ."_list:select_icon" ),I9178 => array (I9162 => "flagicon", "value" => "", I9172 => "edit_id", I9179 => $this->moduleName ."_list:edit", "off" => "" ),"action_del" => array (I9162 => I9180, "value" => "", I9172 => "del_id", I9179 => $this->moduleName ."_list:del", I9181 => "" ));$aCustom["legend"] =array ("leg_red", "leg_yellow", I9182, "leg_edit", "leg_del", "leg_delete_from_list"); $aCustom["form_data"][I9183] =array (I9166, "apply", "cancel", "save"); $aCustom["applied_id"] =I9184; parent::TTTlI11($vData, $aCustom); }function &TTTlI1T(&$aCustom) {$data =parent::TTTlI1T($aCustom); $this->cms->Gui->delScript(); $this->cms->Gui->addScript("jsapi.php"); $this->cms->Gui->addScript($GLOBALS['CURRENT_SKIN_PATH']."_js/ami.admin.js"); $data["scripts"] =$this->cms->Gui->getScripts(); $data[I9185] =$this->cms->Gui->getMetas(); $data["status"] =$this->cms->GetStatusMessages(); global $conn; echo $lIlLLl1 =$this->cms->Gui->get($this->moduleName ."_popup", $data); $conn->Out(); die(); }function TTTlITT($IIIL11l, $cId, $cModule ="") {if ($this->side == "admin" && $IIIL11l == I9186) {$this->TIIl1Il($this->aGroupIds, $cModule); }else {parent::TTTlITT($IIIL11l, $cId, $cModule); }}function TTTl1lI($cId, $cModule) {parent::TTTl1lI($cId, $cModule); $this->redirect =false; }function TIIl1Il($aGroupIds, $cModule) {if (empty($this->cms->Vars["grpPrice"])) {$this->SetLastError(1000, "Price applying failed"); $this->cms->AddStatusMsg("status_apply_price_fail", "red"); }else {$this->lIlLLlI =trim($this->cms->Vars[I9187]); $this->lIlLLll =$aGroupIds; $this->redirect =false; }}}?>