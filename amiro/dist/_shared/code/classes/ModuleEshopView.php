<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       6083 xkqwtkzlulwtitgszgtnkqzzxumukrgzruqpuxlillnttmqukrxrywgupguggmwkkqlypnir
 */ ?><?php foreach(array(9456=>"",9457=>'wjzddqd|gzTo',9458=>"YHSB|MtQID",9459=>"MtQI|rHC",9460=>'JMDt|SZtZ',9461=>"FRhi?",9462=>'fMQJSD',9463=>'IQtOHS',9464=>"wurgZPQTBGQ",9465=>"GZrQntwZtduYJMnK",9466=>"]HffDQt=",9467=>"MS|DMtQ") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleEshopView extends CMS_ViewModule {function ModuleEshopView(&$cms, &$db, &$cModule) {parent::CMS_ViewModule($cms, $db, $cModule); if($this->cms->Core->Side!="admin") {CreateEshop($cms); $this->oEshop =&$cms->Eshop; }}function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll =I9456, $aOptions =Array()) {$aOptions["multi_sites"] =true; $aOptions["use_id_page"] =true; $aOptions["use_options_form"] =true; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); $this->oEshop->init($this->moduleName); $this->oEshop->TT1l11l($this->options["multi_sites"], $this->siteId); }function _InitAdmin() {parent::_InitAdmin(); require_once $GLOBALS[I9457] .'EshopAdmin.php'; $this->oEshop =new EshopAdmin($this->cms, $this->words); }function TTTlTI1() {parent::TTTlTI1(); $this->cms->SetsTemplate =$this->moduleName."_list"; }function TTTll1T(&$vData, &$aCustom) {$aDefault =Array(); $IIllIL1 =$this->IIllIL1; foreach($IIllIL1 as $IIlL1L1 => $tmp) {$IIlL1Ll =$aCustom; $Il11I1l =$vData; switch($IIlL1L1) {case "body_items": $aDefault["page_item_type"] =I9458; $IIlL1Ll += $aDefault; $sql ="SELECT with_subcats, filter_data FROM ".$this->oEshop->dbTablePrefix."_view WHERE id='".$this->viewId."' AND public=1"; $this->db->query($sql); if($this->db->next_record()) {$IIlL1Ll['row_set'] =I9459; $IIlL1Ll['simple_set_fields'] =Array("name", "announce", "description"); $IIlL1Ll[I9460]['simple_prefix'] ="item_"; $aDefault['list_set_empty'] ="item_empty"; $this->browser->InitSQL("i.id,i.name,i.announce,i.description,i.price AS price0".$this->cms->Eshop->getPriceFields("i.price%d"). ", i.tax,i.tax_type,i.charge_tax_type,i.on_special,i.ext_picture,i.ext_popup_picture,". "i.discount,i.discount_type, i.sublink, (LENGTH(i.description) = 0) AS descr_empty, i.item_type, ". "i.num_files, i.files_size ", I9461.$this->oEshop->dbTablePrefix."_items i ", "WHERE i.public=1".$this->_ApplyFilters(). $this->cms->Eshop->TITTIII("i").$this->TTTlIl1(), I9456, "name" );$IIlL1Ll[I9462]['item'] =Array('action'=>'callback', 'object'=>&$this, I9463=>'_getItemCB'); $aCustom[I9460]["nsplitter_prefix"] ="item_nsplitter"; $this->cms->Eshop->ILlL1l1["item_list"][I9464] =$IIlL1Ll['page_item_type']; $this->cms->Eshop->ILlL1l1["item_list"]["parentCatId"] =$this->catId; $this->cms->Eshop->ILlL1l1["item_list"][I9465] =$this->catSublink; $this->cms->Eshop->ILlL1l1["item_list"]["aPriceCaptions"] =Array(); $this->cms->Eshop->ILlL1l1["item_list"]["addParams"] =I9466.$this->offset."&catoffset=".$this->catOffset; $IIlL1Ll[I9460]["catCurrency"] =Array(); parent::TTTll1T($Il11I1l, $IIlL1Ll); $vData["item_list"] =$Il11I1l["item_list"]; }break; default: parent::TTTll1T($Il11I1l, $IIlL1Ll); $vData += $Il11I1l; }}}function _getItemCB(&$aItem, &$aData) {$this->cms->Eshop->getItemCB($aItem, $aData); }function TTTlI1I(&$vData) {$IILIlL1 =$this->siteId; if(isset($this->itemData[I9467])) {$IILIlL1 =$this->itemData[I9467]; }$this->TTT11TI($vData, $IILIlL1, ($this->siteId >0)); parent::TTTlI1I($vData); $vData['form_width'] ='100%'; }function TTT1IlI($aSql =Array(), $cId =0) {$aSql["mod_name"] =$this->oEshop->ownerName."_item"; $aSql =parent::TTT1IlI($aSql, $cId); return $aSql; }}