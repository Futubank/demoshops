<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       4407 xkqwingqkltikilnqsyylxxtutwgxgmkwrpttrpmnznyynupxyzutiinsilxuqxkisgwpnir
 */ ?><?php foreach(array(9723=>'WuDtHI|tZYD|JMnQ',9724=>'',9725=>'tBGQ',9726=>'ihsUjq|gmwTURqd|gzTo',9727=>'wHrQ',9728=>'wjzddqd|gzTo',9729=>'ZvZtZrD|PQnQrZtQS') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleForumDataExchange extends CMS_DataExchangeModule {function ModuleForumDataExchange(&$cms, &$db, &$cModule) {parent::CMS_DataExchangeModule($cms, $db, $cModule); }function TTTlI11(&$vData, &$aCustom) {$vData['custom_tabs_js'] =",'other'"; $vData[I9723] =$this->cms->Gui->getAbs($this->moduleName .'_subform:custom_tabs_line', array ());$vData['custom_tabs'] =$this->cms->Gui->getAbs($this->moduleName .'_subform:custom_tabs', array ());$vData['custom_tabs_content'] =$this->cms->Gui->getAbs($this->moduleName .'_subform:custom_tabs_content', array ());$vData['custom_js'] .= $this->cms->Gui->getAbs($this->moduleName .'_subform:custom_js', array ());$vData['custom_buttons'] =$this->cms->Gui->getAbs($this->moduleName .'_subform:custom_buttons', array ());parent::TTTlI11($vData, $aCustom); }function TTTlITT($IIIL11l, $cId, $cModule =I9724) {if ($IIIL11l == 'generate_avatars' && $this->side == 'admin') {$this->TII1T1l(); $IIIL11l ='none'; }parent::TTTlITT($IIIL11l, $cId, $cModule); }function TTII1lI($II1LLL1) {$this->cms->StatusMsgs[] =array ('msg' => $this->II1lIII->II1ILIL->I1IIlll, I9725 => 'none'); }function TII1T1l() {$lIl11II =$GLOBALS[I9726] .'users/'; $lIl11Il =$lIl11II .'avatars/'; $aFiles =array ();if ($handle =@opendir($lIl11II)) {while (false !== ($file =readdir($handle))) {if (preg_match('/^.+\..+$/', $file) && is_file($lIl11II .$file)) {$aFiles[] =$file; }}closedir($handle); }if (sizeof($aFiles)) {$maxWidth =$GLOBALS[I9727]->GetModOption('forum', 'avatar_maxwidth'); $maxHeight =$GLOBALS[I9727]->GetModOption('forum', 'avatar_maxheight'); require_once $GLOBALS[I9728] .'IMG_Proc.php'; $IllIlII =$GLOBALS[I9727]->IssetOption('images_generator_lib') ?$GLOBALS[I9727]->GetOption('images_generator_lib') :'php'; $IllIlIl =new IMG_PROC($IllIlII); foreach ($aFiles as $file) {$imgData =@getImageSize($lIl11II .$file); if (is_array($imgData)) {list ($w, $h) =$imgData; if ($w >$maxWidth || $h >$maxHeight) {$IllIlIl->TIT1IT1($lIl11II .$file, $lIl11Il .$file, $maxWidth, $maxHeight); }else {@copy($lIl11II .$file, $lIl11Il .$file); }}}$this->cms->AddStatusMsg(I9729); }else {$this->cms->AddStatusMsg('no_avatars_to_generate', 'red'); }}}?>
