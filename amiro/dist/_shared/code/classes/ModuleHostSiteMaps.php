<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       11429 xkqwtyyytultisngnrgppstiplqgswkykguirxikpgsszsxzyytqpytqqkppxqigxplrpnir
 */ ?><?php foreach(array(10249=>'zSIiHSuJQ`GOG',10250=>"",10251=>"SQfZuJt",10252=>'MS|tZrMff',10253=>"SZtQfrHI",10254=>'MS|GQrMHS',10255=>"?MS!?MD|SQfZuJt!?MD|SQfZuJt?ZD?MD|SQfZuJt|fJZP!?GHDMtMHn!?tBGQ!?nZIQ!?SQDWrMGtMHn!?DBD|nZIQ!?GZWKZPQD!?GrMWQD|JMIMtD!?JMWQnDQ!?MS|tZrMff!?MS|GQrMHS?",10256=>"?",10257=>"MD|SQfZuJt",10258=>"MS",10259=>"QSMt|MS",10260=>"ZWtMHn",10261=>"|JMDt%SQJ",10262=>"Hn",10263=>'ZWtMHn',10264=>"ZGGJMQS|MS",10265=>"fHrI|SZtZ",10266=>"DuYfHrI",10267=>"ZWtMHnD",10268=>"ZWtMHn|QSMt",10269=>"ZIHunt|YuB",10270=>"tBGQ",10271=>"MS|tZrMff",10272=>"?coqRq?MS='",10273=>"nZIQ",10274=>"GZWKZPQD",10275=>"JMWQnDQ",10276=>"GrMWMnP",10277=>"'{",10278=>"DBD|nZIQ") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} require_once $GLOBALS['CLASSES_PATH'] .I10249; class ModuleHostSiteMaps extends AdmModule {public $lILLLII; function ModuleHostSiteMaps(&$cms, &$db, &$cModule) {$this->lILLLII =Array(); parent::AdmModule($cms,$db,$cModule); }function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll =I10250, $aOptions =Array()) {$IIIIL11["group_operations"] =Array(); $IIIIL11["use_positions"] =true; $IIIIL11["lang_data"] =false; $aOptions += $IIIIL11; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function ProcessAction($IIIL11l, $cId, $cModule ='') {switch ($IIIL11l) {case I10251: $this->TIIl1I1($cId, $cModule); break; default: parent::ProcessAction($IIIL11l, $cId, $cModule); break; }}function _InitAdmin() {parent::_InitAdmin(); if($GLOBALS["BUILDER_VERSION"] <2){ }else{ $sql ="select t.id as id_tariff, t.name, p.id as id_period, p.period ". "from cms_hst_tariff t ". "left join cms_hst_tariff_period p on p.id_tariff=t.id ". "left join cms_hst_tariff_pkg tp on tp.id_tariff=t.id ". "left join cms_hst_pkg_res pr on pr.id_pkg=tp.id_pkg ". "left join cms_hst_res r on r.id=pr.id_res ". "where r.type='cms' and t.archive=0 ".$this->_ApplyFilters(). " order by t.id, p.period"; if ($this->db->query($sql)) {while ($this->db->next_record()) {$aRow =$this->db->Record; $this->lILLLII[$aRow[I10252]][$aRow['id_period']] =$aRow; }}}}function TTTlTI1() {parent::TTTlTI1(); }function TTTlITT($IIIL11l, $cId, $cModule =I10250) {parent::TTTlITT($IIIL11l, $cId, $cModule); }function GetHtml(&$aCustom) {return parent::GetHtml($aCustom); }function TTTlIT1(&$aCustom, $cType ="small", $IIlLI11 =I10250, $IIlLlII ="_small") {return parent::TTTlIT1($aCustom, $cType, $IIlLI11, $IIlLlII); }function TTlTll1() {parent::TTlTll1(); }function TTTlIII() {$this->filter->TITI1l1("dateto"); $this->filter->TITI1l1(I10253); }function _ApplyFilters($prefix ='', $bodyType ='', $IIlLLl1 =true) {$res =parent::_ApplyFilters($prefix, $bodyType, $IIlLLl1); return $res; }function &TTTlI1T(&$aCustom) {return parent::TTTlI1T($aCustom); }function TTTlI1I(&$vData) {parent::TTTlI1I($vData); $vData['tariff_options'] =''; if (count($this->lILLLII)) {foreach ($this->lILLLII as $lILLLIl) {foreach ($lILLLIl as $aRow) {if($this->itemData[I10252] == $aRow[I10252] && $this->itemData[I10254] == $aRow[I10254]) {$aRow['selected'] =1; }$vData['tariff_options'] .= $this->cms->Gui->get($this->moduleName."_subform:tariff_option", $aRow); }}}}function &TTTlTIT() {return DB_si::admInstance(); }function TTTlI11(&$vData, &$aCustom) {$sql =I10255; $from ="from ".$this->module->GetTableName().I10256; $this->browser->InitSQL($sql, $from, "WHERE 1 ".$this->_ApplyFilters().$this->TTTlIl1(), I10250,"name","name ASC" ,array() );$aCustom["fields"] += Array( I10257=>Array("action"=>"flagicon", "value"=>"1", I10258=>"def_id", "on"=>$this->moduleName."_list:is_default_on","off"=>$this->moduleName."_list:is_default_off"), "action_edit"=>Array("action"=>"flagicon", "value"=>I10250, I10258=>I10259, "on"=>$this->moduleName."_list:edit","off"=>I10250), "action_del"=>Array(I10260=>"flagicon", "value"=>I10250, I10258=>"del_id", "on"=>$this->moduleName.I10261,"off"=>I10250), "action_empty"=>Array(I10260=>"flagicon", "value"=>I10250, I10258=>I10250, I10262=>$this->moduleName."_list:icon_del","off"=>I10250) );$aCustom["fields"] += Array( 'name'=>array(I10263=>'callback','object'=>&$this,'method'=>'CBRow') );$aCustom[I10264] =I10258; $aCustom["legend"] =Array("leg_blue", "leg_edit", "leg_del"); $aCustom[I10265]["buttons"] =Array("add", "apply", "cancel"); parent::TTTlI11($vData, $aCustom); $vData[I10266] =$this->cms->Gui->get($this->moduleName."_subform", $vData); }function CBRow(&$aItem,&$aData) {global $ADMIN_PATH_WWW; $links[I10259] =$aItem['id']; if ($aItem["is_default_flag"]=="1"){ $aItem[I10267] =$aItem["action_edit"].$aItem["action_empty"]; }else{ $links["del_id"] =$aItem['id']; $aItem[I10267] =$aItem[I10268].$aItem["action_del"]; }$lILLLIL =unserialize($aItem["prices_limits"]); $aItem["pricing_amount_buy"] =$lILLLIL["pricing"][I10269]; $aItem["pricing_amount_rent"] =$lILLLIL["pricing"]["amount_rent"]; $aItem["type"] =$this->words[$aItem[I10270]]; if($aItem["id_tariff"] != 0 && $aItem["id_period"] != 0) {$aItem["tariff"] =$this->cms->Gui->get($this->moduleName."_list:tariff_desc", $this->lILLLII[$aItem[I10271]][$aItem["id_period"]]); }else {$aItem["tariff"] =''; }}function TTTll11($cId, $cModule) {parent::TTTll11($cId, $cModule); }function TTTl1T1($cId, $cModule) {parent::TTTl1T1($cId, $cModule); }function _ActionDel($cId, $cModule) {parent::_ActionDel($cId, $cModule); }function TTTl1Tl($cId, $cModule) {parent::TTTl1Tl($cId, $cModule); $sql ="SELECT * FROM ".$this->module->GetTableName().I10272.$cId."'"; $this->db->query($sql); $this->db->next_record(); $this->TII1111($this->db->Record, $this->itemData); }function TTTl1lI($cId, $cModule) {parent::TTTl1lI($cId, $cModule); }function TTT1IlI($aSql =Array(), $cId =0) {$aSql =parent::TTT1IlI($aSql, $cId); $lILLLI1 =explode(":", $this->cms->VarsPost["tariff"]); $id_tariff =intval($lILLLI1[0]); $id_period =intval($lILLLI1[1]); $aSql =Array( I10270=>$this->cms->VarsPost[I10270], "name"=>$this->cms->VarsPost[I10273], "description"=>$this->cms->VarsPost["description"], "sys_name"=>$this->cms->VarsPost["sys_name"], I10274=>trim(unhtmlentities($this->cms->VarsPost[I10274])), I10275=>$this->cms->VarsPost[I10275], I10271=>$id_tariff, "id_period"=>$id_period );foreach($this->cms->VarsPost as $key=>$value){ if (mb_substr($key, 0, 6)=="quotas"){ $lILLLIL["quotas"][mb_substr($key, 7)] =$value; }if (mb_substr($key, 0, 7)=="pricing"){ $lILLLIL[I10276][mb_substr($key, 8)] =$value; }}$aSql["prices_limits"] =serialize($lILLLIL); return $aSql; }function TIIl1I1($cId, $cModule){ if (!empty($cId)) {$sql ="UPDATE `" .$this->module->GetTableName() ."` " ."SET `is_default` = (id = '" .$cId .I10277; $this->db->query($sql); $this->cms->AddStatusMsg('default_changed','blue'); }}function TII1111(&$lILLLlI, &$lILLLll){ $lILLLll[I10258] =$lILLLlI[I10258]; $lILLLll[I10270] =$lILLLlI[I10270]; $lILLLll[I10273] =$lILLLlI[I10273]; $lILLLll["description"] =$lILLLlI["description"]; $lILLLll[I10278] =$lILLLlI[I10278]; $lILLLll[I10274] =$lILLLlI[I10274]; $lILLLll[I10275] =$lILLLlI[I10275]; $lILLLll[I10271] =$lILLLlI[I10271]; $lILLLll["id_period"] =$lILLLlI["id_period"]; $lILLLlL =unserialize($lILLLlI["prices_limits"]); if (is_array($lILLLlL)){ foreach($lILLLlL as $lILLLl1 => $lILLLLI){ if (is_array($lILLLLI)){ foreach($lILLLLI as $key => $value){ $lILLLll[$lILLLl1."_".$key] =$value; }}}}}function TIlTTTT(&$lILllII){ $db =DB_si::admInstance(); $sql ="SELECT * FROM cms_wz_sitemaps ORDER BY position"; $db->query($sql); while($db->next_record()){ $lILlI1L =Array(); ModuleHostSiteMaps::TII1111($db->Record, $lILlI1L); $lILllII[] =$lILlI1L; }}function TIlTTTI($cId, &$lILlI1L){ $db =DB_si::admInstance(); $sql ="SELECT * FROM cms_wz_sitemaps WHERE id='".$cId."'"; $db->query($sql); if($db->next_record()){ ModuleHostSiteMaps::TII1111($db->Record, $lILlI1L); return true; }else{ return false; }}}?>