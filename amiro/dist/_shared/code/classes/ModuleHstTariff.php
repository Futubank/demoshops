<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       31632 xkqwniqgpimuzwrpnggllspuywppstpzunlsgywzktmgqrqrwqtxurywtgplsmszqpkupnir
 */ ?><?php foreach(array(11251=>"SQfZuJt|GrQfMx",11252=>"'",11253=>"fJt|nZIQ",11254=>"tQxt",11255=>"fJt|DQtuG|fQQ|IZx",11256=>"WOQWKYHx",11257=>"fJt|DQtuG|fQQ|IMn",11258=>'ZgQrMHSD',11259=>'nuI',11260=>'GQrMHS|fQQ',11261=>'',11262=>"ZSS|GZWKZPQD|rHCD",11263=>'MnWJuSQS',11264=>"",11265=>'DuYD|WHunt',11266=>"rQD|rHCD",11267=>'!',11268=>'tG',11269=>"t_tG",11270=>'t_tG',11271=>"t`MS",11272=>"ZWtMHn",11273=>"Hn",11274=>"DtrMGJMnQ",11275=>"IQtOHS",11276=>'|FHrIZtduYDwHunt',11277=>"ZWtMHn|QSMt",11278=>"|JMDt%QSMt",11279=>"MS",11280=>"fJZPMWHn",11281=>"|JMDt%MWHn|nHnQ",11282=>"JQP|BQJJHC",11283=>"YuttHnD",11284=>'JMDt|SZtZ',11285=>"DtZtuD|ZSS|fZMJ",11286=>'ZRQD',11287=>'GuYJMW',11288=>"SMDZYJQS",11289=>'MS|rQD',11290=>'HvQrYHunS|DtQG',11291=>"rQS",11292=>"ZGGJB",11293=>'WID|ODt|tZrMff|GKP',11294=>"nZIQ",11295=>'Hn',11296=>"ZrWOMvQ",11297=>"^",11298=>"MS|GKP",11299=>"GKP|MnWJuSQS|",11300=>"GQrMHS|JQn|",11301=>"MS|rQD",11302=>'rQD|YHunS|',11303=>"HvQrYHunS|GrMWQ",11304=>"DQtuG|fQQ",11305=>"'?",11306=>'nZIQ',11307=>'ZgZWKZPQD') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleHstTariff extends ModuleHst {public $lI1Ll1I; public $aResources; function ModuleHstTariff(&$cms, &$db, &$cModule) {parent::ModuleHst($cms, $db, $cModule); }function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll ="", $aOptions =Array()) {$IIIIL11 =array(); $IIIIL11[I11251] ="t"; $IIIIL11["name_field_name"] ="name"; $aOptions += $IIIIL11; $this->lI1Ll1I =Array(); $sql ="SELECT p.id, p.name, p.id as count_masters FROM cms_hst_pkg p WHERE p.lang='".$this->langData.I11252; $this->db->query($sql); if ($this->db->num_rows()) {while ($this->db->next_record()) {$aRes =$this->db->Record; $this->lI1Ll1I[intval($this->db->Record['id'])] =$this->db->Record; }}$this->aResources =$this->TIlTII1(); parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function _InitAdmin() {if($this->TTTTlTI() || $this->TTTTII1()) {trigger_error("Access violation.", E_USER_ERROR); }parent::_InitAdmin(); }function TTTlIII() {parent::TTTlIII(); $this->filter->AddField("flt_name", "text", stripslashes(unhtmlentities($this->cms->Vars[I11253])), "", " like ", "name"); $this->filter->AddField("flt_setup_fee_min", I11254, stripslashes(unhtmlentities($this->cms->Vars["flt_setup_fee_min"])), "", " >= ", "setup_fee"); $this->filter->AddField(I11255, I11254, stripslashes(unhtmlentities($this->cms->Vars[I11255])), "", " <= ", "setup_fee"); $this->filter->AddField("flt_archive", I11256, $this->cms->Vars["flt_archive"], "0", " <= ", "archive"); if(empty($this->cms->Vars[I11257])) {$this->filter->DisableFieldSQL(I11257); }if(empty($this->cms->Vars[I11255])) {$this->filter->DisableFieldSQL(I11255); }}function &TTTlI1I(&$aData) {$aData["no_change_hint"] =""; if($this->itemData['subs_count']) {$aTmp =Array(); $aData["no_change_hint"] .= $this->cms->Gui->get($this->moduleName."_subform:cant_change_tariff_hint", $aTmp); }$aData['currency_postfix'] =$this->TTTTlT1(); if (count($this->lI1Ll1I)) {foreach ($this->lI1Ll1I as $aPkg) {$aData["packages_bank_options"] .= $this->cms->Gui->get($this->moduleName."_subform:option", $aPkg); }}if(is_array($this->itemData['aPeriods'])) {$aPeriods =$this->itemData[I11258]; }else {$aPeriods =Array(Array('num' => 1, 'period_len' => 1, 'period_fee' => ''), Array(I11259 => 2, 'period_len' => 2, 'period_fee' => ''), Array(I11259 => 3, 'period_len' => 3, I11260 => ''), Array(I11259 => 4, 'period_len' => 6, I11260 => ''), Array(I11259 => 5, 'period_len' => 12, I11260 => I11261) );}if (is_array($aPeriods) && count($aPeriods)) {foreach ($aPeriods as $lI1LlLI) {$lI1LlLI['subs_count'] =$this->itemData['subs_count']; $aData['periods_rows'] .= $this->cms->Gui->get($this->moduleName."_subform:period_line", $lI1LlLI); }}$aData[I11262] =""; if(is_array($this->itemData['aPackages'])) {foreach ($this->itemData['aPackages'] as $aPkg) {$aData['add_packages_rows'] .= "document.getElementById('packages_bank').value = ". $aPkg['id_pkg']."; insertPackageRow('". $aPkg['public']."', '". $aPkg[I11263]."', '". $aPkg['price']."');\n"; }}$aData["res_rows"] =I11264; $lI1lLI1 =1; $aResId =array(); if (count($this->aResources)) {foreach ($this->aResources as $aRes) {$aResId[] =$aRes['id']; $aRes["class"] ="row".$lI1lLI1; $aRes['subs_count'] =$this->itemData[I11265]; $lI1lLI1 =3 -$lI1lLI1; if(isset($this->itemData['aRes'][$aRes['id']])) {$aRes += $this->itemData['aRes'][$aRes['id']]; }$aData[I11266] .= $this->cms->Gui->get($this->moduleName."_subform:res_row", $aRes); }}else {$aRes =Array(); $aData[I11266] .= $this->cms->Gui->get($this->moduleName."_subform:empty_res_row", $aRes); }$aData["resources_count"] =count($this->aResources); $aData["res_id_list"] =implode(I11267, $aResId); parent::TTTlI1I($aData); }function TTTlI11(&$vData, &$aCustom) {$this->browser->InitSQL("t.id, t.archive, t.name, t.setup_fee, t.comments, count(distinct tp.id) as tariff_pkgs, count(distinct s.id) as subs_count", Array('tables'=>Array('t' => 'cms_hst_tariff', I11268 => 'cms_hst_tariff_pkg', 's' => 'cms_hst_subscription'), 'joins'=>Array(I11269=>"tp.id_tariff=t.id", "tp|s"=>"s.id_tariff=t.id"), 'joins_types'=>Array(I11270=>'LEFT', 'tp|s'=>'LEFT') ),"WHERE 1 ".$this->_ApplyFilters().$this->TTTlIl1(), I11271, "t.name", "t.setup_fee" );$aCustom["fields"] += Array( "archive"=>Array(I11272=>"flagicon", "value"=>1, "id"=>"arch_id", I11273=>$this->moduleName."_list:archive_on", "off"=>$this->moduleName."_list:archive_off", ),"name"=>Array(I11272=>I11274, "size"=>120), "setup_fee"=>Array(I11272=>"callback", "object"=>&$this, I11275=>'_FormatSetupFee'), "subs_count"=>Array(I11272=>"callback", "object"=>&$this, I11275=>I11276), "tariff_pkgs"=>Array(I11272=>"callback", "object"=>&$this, I11275=>'_FormatTariffPkgs'), I11277=>Array(I11272=>"flagicon", "value"=>I11264, "id"=>"edit_id", I11273=>$this->moduleName.I11278,"off"=>I11264), "action_copy"=>Array(I11272=>"flagicon", "value"=>I11264, I11279=>"copy_id", I11273=>$this->moduleName."_list:copy","off"=>I11264), "is_deleteable"=>Array(I11272=>I11280, "value"=>I11264, I11279=>"del_id", I11273=>$this->moduleName."_list:del","off"=>$this->moduleName.I11281), );$this->browser->AddSQLJoinedTables($this->cms->Core, 't', array(I11268=>'cms_hst_tariff_pkg')); $aCustom["applied_id"] =I11271; $aCustom["legend"] =Array(I11282, "leg_blue", "leg_edit", "leg_del"); $aCustom["form_data"][I11283] =Array("add", "apply", "cancel", "save"); $aCustom[I11284]['currency_postfix'] =$this->TTTTlT1(); parent::TTTlI11($vData, $aCustom); }function TTTll11($cId, $cModule) {$aPackages =$this->TIllTlT(); if($this->TIllITT($aPackages)) {parent::TTTll11($cId, $cModule); if(!$this->errno) {$lI1lLLl=$this->db->lastInsertId(); $this->TIllT1T($lI1lLLl, 'cms_hst_tariff_pkg', $aPackages); $aPeriods =$this->TIllTlI(); $this->TIllT1T($lI1lLLl, 'cms_hst_tariff_period', $aPeriods); $aResources =$this->TIllTll(); $this->TIllT1T($lI1lLLl, 'cms_hst_tariff_res', $aResources); }}else {$this->itemData =$this->TIllIT1(); $this->cms->AddStatusMsg(I11285, "red"); $this->SetLastError(1, "Adding failed"); }}function TTTl1Tl($cId, $cModule) {parent::TTTl1Tl($cId, $cModule); $sql ="SELECT t.id, t.archive, t.name, t.setup_fee, ". "t.comments, t.hidden_comments, t.tariff_link, pk.id_pkg, pk.price, ". "pk.public, pk.included, pr.period, pr.period_fee, tr.id_res, tr.bound as res_bound, tr.overbound_price, tr.overbound_step ". "FROM " .$this->module->GetTableName() ." t ". "LEFT JOIN cms_hst_tariff_pkg pk ON pk.id_tariff=t.id ". "LEFT JOIN cms_hst_tariff_period pr ON pr.id_tariff=t.id ". "LEFT JOIN cms_hst_tariff_res tr ON tr.id_tariff=t.id ". "WHERE t.id='".$cId.I11252.$this->_ApplyFilters()." ". "ORDER BY pr.period, pk.id_pkg"; $this->db->query($sql); $lIL1L1I =true; $lI1Ll1l =1; while ($this->db->next_record()) {if ($lIL1L1I) {$this->itemData =$this->db->Record; $this->itemData[I11258] =Array(); $this->itemData['aPackages'] =Array(); $this->itemData[I11286] =Array(); $lIL1L1I=false; }$lI1Ll1L =Array('id_pkg' => $this->db->Record['id_pkg'], 'price' => $this->db->Record['price'], I11287 => $this->db->Record[I11287] ?"checked" :I11264, I11263 => $this->db->Record[I11263] ?"checked" :I11264 );if($lI1Ll1L[I11263] == 'checked') {$lI1Ll1L['disabled'] =I11288; }if(!in_array($lI1Ll1L, $this->itemData['aPackages'])) {$this->itemData['aPackages'][] =$lI1Ll1L; }$lI1Ll11 =Array('period_len' => $this->db->Record['period'], I11260 => $this->db->Record[I11260] );if(!in_array($lI1Ll11, $this->itemData[I11258])) {$this->itemData[I11258][] =$lI1Ll11; }if($this->db->Record[I11289]) {$this->itemData[I11286][intval($this->db->Record[I11289])] =array('bound' => $this->db->Record['res_bound'], 'overbound_price' => $this->db->Record['overbound_price'], I11290 => $this->db->Record[I11290]); }}if(count($this->itemData[I11258])) {for($i =0; $i <count($this->itemData[I11258]); $i++) {$this->itemData[I11258][$i][I11259] =$i +1; }}$lI1LLII =$this->TIllT11($cId); $this->itemData[I11265] =$lI1LLII; }function TTTl1lI($cId, $cModule) {$lI1LLII =$this->TIllT11($cId); if($lI1LLII) {$this->cms->Vars["arch"] =$this->cms->Vars["archive"]; $this->_ActionArchive($cId, $cModule); }else {$aPackages =$this->TIllTlT(); if($this->TIllITT($aPackages)) {parent::TTTl1lI($cId, $cModule); $this->TIllT1l($cId, 'cms_hst_tariff_pkg'); $this->TIllT1T($cId, 'cms_hst_tariff_pkg', $aPackages); $this->TIllT1l($cId, 'cms_hst_tariff_period'); $aPeriods =$this->TIllTlI(); $this->TIllT1T($cId, 'cms_hst_tariff_period', $aPeriods); $this->TIllT1l($cId, 'cms_hst_tariff_res'); $aResources =$this->TIllTll(); $this->TIllT1T($cId, 'cms_hst_tariff_res', $aResources); }else {$this->cms->AddStatusMsg("status_apply_fail", I11291); $this->SetLastError(2, "Apply failed"); }}}function TTTl1ll($cId, $cModule) {$IIl1llI =false; if($this->cms->VarsPost["action_original"] != I11264) {$this->ProcessAction($this->cms->VarsPost["action_original"], $cId); if($this->cms->VarsPost["action_original"] == I11292) {$IIl1llI =true; }elseif($this->cms->VarsPost["action_original"] == "add") {$cId =$this->appliedId; }}$lI1LLIl =$this->errno; if($IIl1llI || empty($this->errno)) {$appliedId =$this->appliedId; $this->ProcessAction("edit", $cId); if($lI1LLIl) {$this->itemData =$this->TIllIT1(); }$this->appliedId =$appliedId; }}function _ActionArchive($cId, $cModule) {parent::_ActionArchive($cId, $cModule); }function _ActionDel($cId, $cModule) {$sql ="SELECT count(*) as cnt FROM cms_hst_subscription WHERE id_tariff = '$cId'"; if ($this->db->getValue($sql) >0) {$this->SetLastError(3, "Deleting failed"); $this->cms->AddStatusMsg("status_del_fail_subscription_exists", I11291); }else {parent::_ActionDel($cId, $cModule); $sql="DELETE FROM cms_hst_tariff_pkg WHERE id_tariff='$cId'"; $this->db->query($sql); $this->TIllT1l($cId, 'cms_hst_tariff_pkg'); $this->TIllT1l($cId, 'cms_hst_tariff_period'); $this->TIllT1l($cId, 'cms_hst_tariff_res'); }}function _ActionCopy($cId, $cModule) {parent::_ActionCopy($cId, $cModule); if(!$this->errno) {$lI1LLIL=$this->db->lastInsertId(); $aData =$this->TIllT1I($cId, 'cms_hst_tariff_pkg'); $this->TIllT1T($lI1LLIL, I11293, $aData); $aData =$this->TIllT1I($cId, 'cms_hst_tariff_period'); $this->TIllT1T($lI1LLIL, 'cms_hst_tariff_period', $aData); $aData =$this->TIllT1I($cId, 'cms_hst_tariff_res'); $this->TIllT1T($lI1LLIL, 'cms_hst_tariff_res', $aData); }}function TTT1IlI($aSql =Array(), $cId =0) {$name =$this->cms->VarsPost[I11294]; $setup_fee =$this->cms->VarsPost["setup_fee"]; $archive ='0'; if(isset($this->cms->VarsPost["archive"]) && $this->cms->VarsPost["archive"] == I11295) {$archive ='1'; }$comments =$this->cms->VarsPost["comments"]; $hidden_comments =$this->cms->VarsPost["hidden_comments"]; $tariff_link =mb_substr($this->cms->VarsPost["tariff_link"], 0, 255); if(($name != I11264) && ($setup_fee != I11264) && ($lI1LLI1 !== false)) {$aSql =Array( I11296 => $archive, I11294 => $name, "setup_fee" => $setup_fee, "comments" => $comments, "hidden_comments" => $hidden_comments, "tariff_link" => $tariff_link, );}$aSql =parent::TTT1IlI($aSql, $cId); return $aSql; }function TIllTlT() {$lI1LLlI =Array(); foreach (explode(I11297, $this->cms->VarsPost['packagesOrder']) as $I1ILIL1) {$I1ILIL1 =$this->TIllTl1("pkg_id_".$I1ILIL1); if($I1ILIL1 !== false) {$price =(float)$this->cms->VarsPost["pkg_price_".$I1ILIL1]; if($this->cms->VarsPost["pkg_included_".$I1ILIL1]) {$price =0; }$lI1LLlI[] =Array (I11298 => $I1ILIL1, "price" => $price, "public" => ($this->cms->VarsPost["pkg_public_".$I1ILIL1]) ?1 :0, "included" => ($this->cms->VarsPost[I11299.$I1ILIL1]) ?1 :0, );}}return $lI1LLlI; }function TIllTlI() {$lI1LLll =Array(); foreach (explode(I11297, $this->cms->VarsPost['periodsOrder']) as $lI1LLlL) {if((intval($lI1LLlL) >0) && ($this->cms->VarsPost["period_len_".$lI1LLlL] != I11264) && ($this->cms->VarsPost["period_fee_".$lI1LLlL]) != I11264) {$lI1LLll[] =Array ("period"=>intval($this->cms->VarsPost[I11300.$lI1LLlL]), "period_fee"=>(float)$this->cms->VarsPost["period_fee_".$lI1LLlL] );}}return $lI1LLll; }function TIllTll() {$lIL1L1l =Array(); if (is_array($this->aResources)) {foreach ($this->aResources as $aRes) {if ($aRes["subtype"] == "on-off") {$lI1LLl1 =Array (I11301 => $aRes['id'], "bound" => 2147483647, "overbound_price" => 0, "overbound_step" => 0, );$lIL1L1l[$lI1LLl1[I11289]] =$lI1LLl1; }else {$lI1LLLI =I11302.$aRes['id']; if ($this->cms->VarsPost[$lI1LLLI] != I11264) {$lI1LLl1 =Array (I11301 => $aRes['id'], "bound" => abs(intval($this->cms->VarsPost[$lI1LLLI])), "overbound_price" => abs(intval($this->cms->VarsPost['res_overbound_price_'.$aRes['id']])), "overbound_step" => abs(intval($this->cms->VarsPost['res_overbound_step_'.$aRes['id']])), );if($lI1LLl1[I11303] >0 && $lI1LLl1["overbound_step"] == 0) {$lI1LLl1["overbound_step"] =1; }$lIL1L1l[$lI1LLl1[I11289]] =$lI1LLl1; }}}}return $lIL1L1l; }function TIllTl1($cVarName) {$I1ILIL1 =intval($this->cms->VarsPost[$cVarName]); if($I1ILIL1 && in_array($I1ILIL1, array_keys($this->lI1Ll1I))) {return $I1ILIL1; }return false; }function TIllT1T($cId, $IIl11LI, $aData) {if ($cId >0 && $IIl11LI !=I11261 && count($aData)) {foreach ($aData as $aRow) {if(isset($aRow[I11279])) {unset($aRow[I11279]); }$aRow["id_tariff"] =$cId; $sql =$this->db->GenInsertSQL($IIl11LI, $aRow); $this->db->query($sql); }}}function TIllT1I($cId, $IIl11LI){ $aRes =Array ();if($cId >0 && $IIl11LI != I11261) {$sql ="SELECT * FROM $IIl11LI WHERE id_tariff='$cId'"; $this->db->query($sql); while ($this->db->next_record()) {$aTmp =Array(); foreach($this->db->Record as $key => $val) {if($key != I11261.intval($key)) {$aTmp[$key] =$val; }}$aRes[] =$aTmp; }}return $aRes; }function TIllT1l($cId, $IIl11LI){ if($cId >0 && $IIl11LI != I11261) {$sql="DELETE FROM $IIl11LI WHERE id_tariff='$cId'"; $this->db->query($sql); }}function _FormatSetupFee(&$vItem, &$vData) {$vItem["setup_fee"] =FormatNumber($vItem[I11304], 0, 0); }function _FormatTariffPkgs(&$vItem, &$vData) {$vItem["tariff_pkgs"] =FormatNumber($vItem["tariff_pkgs"], 0, 0); }function _FormatSubsCount(&$vItem, &$vData) {$vItem["subs_count"] =FormatNumber($vItem["subs_count"], 0, 0); }function TIlTII1() {$aRes =Array(); $sql ="SELECT id, name, subtype, unit as res_unit FROM cms_hst_res WHERE lang='".$this->langData.I11252; $this->db->query($sql); if ($this->db->num_rows()) {while ($this->db->next_record()) {$aRes[$this->db->Record['id']] =$this->db->Record; }}return $aRes; }function TIllT11($cId) {$sql ="SELECT count(distinct s.id) as subs_count FROM cms_hst_tariff t LEFT JOIN cms_hst_subscription s ON s.id_tariff=t.id ". "WHERE t.id='".$cId."' AND s.lang='".$this->langData.I11305.$this->_ApplyFilters(); $res =$this->db->GetValue($sql); return $res; }function TIllITT($aPackages) {$res =true; $lI1LLLl =array(); $lI1LLLL =array(); if (is_array($aPackages) && count($aPackages)) {foreach ($aPackages as $lI1LLL1) {if ($lI1LLL1[I11263]) {$lI1LLLl += $this->TIllITl($this->db, $lI1LLL1); }else {$lI1LLLL += $this->TIllITl($this->db, $lI1LLL1); }}if (count($lI1LLLl)) {$lI1LL1I =array_keys($lI1LLLl); if(!$this->TIllITI($lI1LLLl, $lI1LL1I, "res_master_of_included_resource_missing")) {$res =false; }}if (count($lI1LLLL)) {$lI1LL1I =array_merge(array_keys($lI1LLLl), array_keys($lI1LLLL)); if(!$this->TIllITI($lI1LLLL, $lI1LL1I, "res_master_of_buy_resource_missing")) {$res =false; }}}return $res; }function TIllITI($aRes, $lI1LL1I, $lI1LL1l) {if (!count($lI1LL1I)) {return true; }if (!count($aRes)) {return false; }$res =true; foreach ($aRes as $resId => $lI1LL1L) {$lI1LL11 =Array(); if (count($lI1LL1L)) {foreach ($lI1LL1L as $lI1Il1l) {if (!in_array($lI1Il1l, $lI1LL1I)) {$lI1LL11[$lI1Il1l] =$this->aResources[$lI1Il1l]['name']; $res =false; }}}if (count($lI1LL11)) {$lI1L1II =Array('slave_name' => $this->aResources[$resId][I11306], 'masters_list' => implode(I11267, $lI1LL11)); $this->cms->AddStatusMsg($lI1LL1l, I11291, I11264, I11264, $lI1L1II); }}return $res; }function TIllITl(&$db, $aPkg) {$res =Array(); if ($aPkg['id_pkg']) {$sql ="SELECT p.id_res, r.id_res_master ". "FROM cms_hst_pkg_res p ". "LEFT JOIN cms_hst_res_dep r ON p.id_res=r.id_res_slave ". "WHERE p.id_pkg='".$aPkg['id_pkg'].I11252; $lI1lIl1 =$db->select($sql); while ($aRow =$lI1lIl1->nextRecord()) {if(!isset($res[$aRow[I11289]])) {$res[$aRow[I11289]] =Array(); }if($aRow['id_res_master']) {$res[$aRow[I11289]][] =$aRow['id_res_master']; }}}return $res; }function TIllIT1() {$aRes =$this->cms->VarsPost; $aRes[I11258] =Array(); $aRes[I11307] =Array(); $aRes[I11286] =Array(); $aRes[I11307] =$this->TIllTlT(); $aRes[I11258] =$this->TIllTlI(); if(count($aRes[I11258])) {for($i =0; $i <count($aRes[I11258]); $i++) {$aRes[I11258][$i]['period_len'] =$aRes[I11258][$i]['period']; $aRes[I11258][$i][I11259] =$i +1; }}$aRes[I11286] =$this->TIllTll(); if (intval($this->cms->VarsPost['id']) >0) {$lI1LLII =$this->TIllT11(intval($this->cms->VarsPost['id'])); $aRes[I11265] =$lI1LLII; }return $aRes; }}?>