<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       3296 xkqwkqptlyrksllnsxugpmlzlgzlttisgiryrlrqlqsgmuunkgumktqxuiyzzswlqkztpnir
 */ ?><?php foreach(array(12743=>"`[ ",12744=>'}',12745=>'',12746=>'!?MS?',12747=>"MS!?JMnK!?nHMnSQx!?IHSuJQ|nZIQ!?nZIQ!?ZnnHunWQ!?ZnnHunWQ|fuJJ!?MS|GZPQ!?MS|GZPQ|IZMn!?ZWtMvQ!?MS|DMtQ!?MS|GZPQ|rQZJ!?MS|MtQI!?MS|WZt!?SZtQ|IHSMfMQS?",12748=>'rQMnSQx',12749=>"?",12750=>"nZIQ",12751=>'~DMu',12752=>'\1') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleSearchFunctions extends CMS_Functions{ public $lllII1L; function ModuleSearchFunctions(&$cms, &$db, &$cModule, &$IlILIl1) {parent::CMS_Functions($cms, $db, $cModule, $IlILIl1); $this->lllII1L =''; }function TIl1ITI($aWords){ $lllII11 =$this->lllII1L; if(empty($lllII11) && is_array($aWords)){ $lllIlII =array(); foreach($aWords as $lllIlIl){ $lllIlIl =str_replace(array("\\*"), array(I12743), preg_quote($lllIlIl, "/")); if(mb_strpos($lllIlIl, I12743) === 0){ $lllIlIl ="[^ ]*?".mb_substr($lllIlIl, 3); }if(!empty($lllIlIl)){ $lllIlII[] ='(?:'.$lllIlIl.')'; }}$lllII11 =I12744.implode('|', $lllIlII).')'; $this->lllII1L =$lllII11; }return $lllII11; }function TIl1ITl($filter, $llI1IlI ='', $orderDir ='asc', $lllIlIL =I12745){ $lllIlI1 =I12745; $sort =I12745; $lllIllI =array(); if($llI1IlI == 'id' && !empty($lllIlIL)){ $lllIlI1 =', '.$lllIlIL." as rel, IF(announce='' OR ISNULL(announce), 0, 1) as hasbody "; $sort ='rel '.$orderDir.I12746.$orderDir; $lllIllI =array('id' => '=|hasbody'); }$this->IlILIlL->browser->InitSQL( I12747.$lllIlI1, "FROM " .($this->cms->Core->IsInstalled("reindex") && $this->cms->Core->GetModOption(I12748, 'mode') == 'fulltext' ?'cms_site_search_index' :'cms_site_search') .I12749, "WHERE public&cat_public AND ".$filter, "link, id_page", "", $sort, $lllIllI );}function TIl1IT1(&$vItem, &$vData, &$llI11Il){ $vItem["title"] =$vItem[I12750]; $lllIlll =$this->cms->Gui->get($this->IlILIlL->moduleName."_list:found_word_start", $vItem); $lllIllL =$this->cms->Gui->get($this->IlILIlL->moduleName."_list:found_word_end", $vItem); $lllII11 =$this->TIl1ITI($llI11Il->lLIlL1I); if(!empty($lllII11)){ $vItem["title"] =preg_replace('/'.$lllII11.I12751, $lllIlll.'\1'.$lllIllL, $vItem["title"]); $vItem["announce"] =preg_replace('/'.$lllII11.I12751, $lllIlll.I12752.$lllIllL, $vItem["announce"]); }$vItem["link"] =$GLOBALS['ROOT_PATH_WWW'].$vItem["link"]; }}