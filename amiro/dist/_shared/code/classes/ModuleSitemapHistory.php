<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       9838 xkqwmnkukngxungwgqkizypwyqsqzxkpxwwgkuylnpwtmqqsykkqlpmswpnwprniwttupnir
 */ ?><?php foreach(array(12753=>"PrHuG|HGQrZtMHnD",12754=>"ZWtMHn",12755=>"DIZJJ",12756=>"ZWt|DQnS|DMtQIZG",12757=>"",12758=>"fJt|ZWtMHn",12759=>"uDQrZPQnt",12760=>"SZtQ",12761=>'HYLQWt',12762=>"CHrSD",12763=>"vMQC|MS",12764=>'ZWtMHn',12765=>'WZJJYZWK',12766=>"vZJuQ",12767=>"Hff",12768=>"DMAQ",12769=>"JQP|vMQC",12770=>"WZnWQJ",12771=>"ZWt|HutGut|DMtQIZG",12772=>"nuI|urJD",12773=>"coqRq?P`MS='",12774=>"DMtQIZG|fMJQ",12775=>"DMtQIZG|fMJQ|JMnK",12776=>"DMtQIZG|DMAQ",12777=>"MG") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleSitemapHistory extends CMS_ActModule {function ModuleSitemapHistory(&$cms, &$db, &$cModule) {parent::CMS_ActModule($cms, $db, $cModule); }function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll ="", $aOptions =Array()) {$IIIIL11[I12753][] ="del"; $IIIIL11["use_id_page"] =true; $IIIIL11["use_options_form"] =true; $IIIIL11["name_field_name"] =I12754; $IIIIL11["description_field_name"] ="status"; $aOptions += $IIIIL11; $this->cms->InitMessages($this->cms->Gui->ParseLangFile("templates/lang/_google_sitemap_msgs.lng")); parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function _InitAdmin() {parent::_InitAdmin(); }function TTTlTI1() {parent::TTTlTI1(); }function TTTlITT($IIIL11l, $cId, $cModule ="") {parent::TTTlITT($IIIL11l, $cId, $cModule); }function GetHtml(&$aCustom) {return parent::GetHtml($aCustom); }function TTTlIT1(&$aCustom, $cType =I12755, $IIlLI11 ="", $IIlLlII ="_small") {return parent::TTTlIT1($aCustom, $cType, $IIlLI11, $IIlLlII); }function TTlTll1() {parent::TTlTll1(); }function TTTlIII() {parent::TTTlIII(); foreach(array("act_gen_sitemap", "act_auto_gen_sitemap", I12756, "act_auto_send_sitemap", "act_output_sitemap", "all") as $action) {$aAction =$this->filter->TITI1TT($aAction, Array($this->words[$action] => ($action=="all") ?I12757 :$action), 35, false); }$IIL1IIl =$this->cms->Vars["flt_action"]; $this->filter->AddField("flt_action", "select", $IIL1IIl, I12757, "=", I12754, $aAction); if(empty($IIL1IIl)) {$this->filter->DisableFieldSQL(I12758); }$search =stripslashes(unhtmlentities($this->cms->Vars["flt_useragent"])); $this->filter->AddField("flt_useragent", "text", $search, I12757, " LIKE ", I12759); }function _ApplyFilters($prefix ='', $bodyType ='', $IIlLLl1 =true) {$res =parent::_ApplyFilters($prefix, $bodyType, $IIlLLl1); return $res; }function &TTTlI1T(&$aCustom) {return parent::TTTlI1T($aCustom); }function TTTlI1I(&$vData) {parent::TTTlI1I($vData); }function TTTlI11(&$vData, &$aCustom) {$this->browser->InitSQL( "id, action, FORMAT(time, 2) AS time, status AS action_status, date, DATE_FORMAT(date,'".$this->cms->DFMT["db"]."') as fdate, DATE_FORMAT(date,'".$this->cms->DFMT["db_time"]."') as ftime, sitemap_file,  sitemap_size, num_urls, useragent ", "FROM cms_google_sitemap", "WHERE 1 ".$this->TTTlIl1(), I12757, I12760, "id desc"); $aCustom["fields"] += Array( I12754=>Array('action'=>'callback', I12761=>&$this, 'method'=>'_actionsAction'), "status"=>Array(I12754=>"get_word", I12762=>&$this->words), "action_view"=>Array(I12754=>"flagicon", "value"=>I12757, "id"=>I12763, "on"=>"sitemap_history_list:view","off"=>I12757), "sitemap_size"=>Array(I12764=>'callback', I12761=>&$this, 'method'=>'_actionsRow'), "num_urls"=>Array(I12764=>I12765, I12761=>&$this, 'method'=>'_actionsUrl'), "action_del"=>Array(I12754=>"flagicon", I12766=>I12757, "id"=>"del_id", "on"=>"sitemap_history_list:del",I12767=>I12757), "id"=>Array("edit_id", "del_id"), I12759=>Array(I12754=>"stripline", I12768=>47), );$aCustom["applied_id"] ="id"; $aCustom["legend"] =Array("leg_red", I12769, "leg_del"); $aCustom["form_data"]["buttons"] =Array("apply", I12770); parent::TTTlI11($vData, $aCustom); }function _actionsRow(&$aItem, &$aData) {if ($aItem["sitemap_size"] >0) {$aItem["sitemap_size"] =getBytesAsText($aItem["sitemap_size"], $this->words, 1); }else {$aItem["sitemap_size"] =I12757; }}function _actionsAction(&$aItem, &$aData) {if ($aItem[I12754] == I12771) {$aItem["sitemap_file_link"] =$GLOBALS['ROOT_PATH_WWW'].$aItem["sitemap_file"]; }elseif ($aItem[I12754] == "act_gen_sitemap" || $aItem[I12754] == "act_auto_gen_sitemap") {$aItem["sitemap_file_link"] =$GLOBALS['II1l111'].$aItem["sitemap_file"]; }}function _actionsUrl(&$aItem, &$aData) {if (!$aItem["num_urls"]) {$aItem[I12772] =I12757; }}function &TTTllTl(&$aCustom) {return parent::TTTllTl($aCustom); }function TTTllTI(&$aCustom) {parent::TTTllTI($aCustom); }function TTTlllT(&$vData) {parent::TTTlllT($vData); }function TTTll11($cId, $cModule) {parent::TTTll11($cId, $cModule); }function TTTll1l($cId, $cModule) {parent::TTTll1l($cId, $cModule); $sql ="SELECT g.id, g.action AS sm_action, FORMAT(g.time, 2) AS time, g.sitemap_size, g.num_urls, g.sitemap_file, g.status AS action_status, g.daemon_mode, g.login, g.ip, g.useragent, DATE_FORMAT(g.date,'".$this->cms->DFMT["db"]." %H:%i:%S') AS fdate ". "FROM cms_google_sitemap g ". I12773.$cId."'"; $this->db->query($sql); if($this->db->next_record()) {$this->itemData =$this->db->Record; if ($this->db->Record["sm_action"] == I12771) {$this->itemData["sitemap_file_link"] =$GLOBALS['ROOT_PATH_WWW'].$this->itemData[I12774]; }elseif ($this->db->Record["sm_action"] == "act_gen_sitemap" || $this->db->Record["sm_action"] == "act_auto_gen_sitemap") {$this->itemData[I12775] =$GLOBALS['II1l111'].$this->itemData[I12774]; }if ($this->db->Record["sitemap_size"] >0) {$this->itemData["sitemap_size"] =getBytesAsText($this->db->Record["sitemap_size"], $this->words, 1); }else {$this->itemData[I12776] =I12757; }if (!$this->db->Record[I12772]) {$this->itemData[I12772] =I12757; }if (!$this->db->Record["daemon_mode"]) {$this->itemData["user_login"] =$this->db->Record["login"]; $this->itemData["user_ip"] =$this->db->Record[I12777]; }}}function TTTl1T1($cId, $cModule) {parent::TTTl1T1($cId, $cModule); }function _ActionDel($cId, $cModule) {parent::_ActionDel($cId, $cModule); }function TTTl1lI($cId, $cModule) {parent::TTTl1lI($cId, $cModule); }function TTT1lTl($IILIIl1, &$IILIILI, &$vData, &$IILIILl) {parent::TTT1lTl($IILIIl1, $IILIILI, $vData, $IILIILl); }}?>