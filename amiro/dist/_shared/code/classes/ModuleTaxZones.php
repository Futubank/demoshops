<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       10247 xkqwtznmkmxpkmmggrnitwyrimzgyskqpilqpylypgyuqypgrnkyryiqslukuzrmksmgpnir
 */ ?><?php foreach(array(13077=>'qDOHGzSIMn`GOG',13078=>"JZnP|SZtZ",13079=>"ZSS",13080=>"PrHuG|HGQrZtMHnD",13081=>"fJt|AMG",13082=>"fJt|nZIQ",13083=>'',13084=>"tZx|tBGQ",13085=>"",13086=>"AHnQ|DtZtQ",13087=>"DtZtQD|LD",13088=>"MD|SQfZuJt",13089=>'WZJJYZWK',13090=>'ZWtMHn',13091=>'Hn',13092=>"ZWtMHn",13093=>"CHrSD",13094=>"|PQtTZxTBGQwy",13095=>"JQP|BQJJHC",13096=>"YuttHnD",13097=>"SQJ|MS",13098=>'|JMDt%MWHn|nHnQ',13099=>"|nuI|rHCD",13100=>"?",13101=>"WHuntrB",13102=>"DtZtQ") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleTaxZones extends ModuleTaxes {public $oEshop; function ModuleTaxZones(&$cms, &$db, &$cModule) {parent::ModuleTaxes($cms, $db, $cModule); if ($this->cms->Core->Side == "admin") {require_once $GLOBALS['CLASSES_PATH'] .I13077; $this->oEshop =new EshopAdmin($this->cms, $this->words); $this->oEshop->init($this->moduleName); }else {CreateEshop($cms); $this->oEshop =&$cms->Eshop; }$this->cms->Gui->AddGlobalVars(array("TAX_SYSTEM" => $this->lllI1Ll)); }function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll ="", $aOptions =Array()) {$IIIIL11 =array( "stop_use_sublinks" => false, I13078 => true, "check_public" => false, "use_modified_date" => false, "use_positions" => false, "allowed_actions" => array(I13079, "edit", "apply", "save", "del"), I13080 => array("del") );$aOptions += $IIIIL11; parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function _InitAdmin() {parent::_InitAdmin(); }function TTTlITT($IIIL11l, $cId, $cModule ="") {parent::TTTlITT($IIIL11l, $cId, $cModule); }function GetHtml(&$aCustom) {return parent::GetHtml($aCustom); }function TTlTll1() {parent::TTlTll1(); }function TTTlIII() {parent::TTTlIII(); $this->filter->TITI1l1("datefrom"); $this->filter->TITI1l1("dateto"); $this->filter->AddField(I13081, "text", stripslashes(unhtmlentities($this->cms->Vars[I13081])), "", " like ", "zip"); $this->filter->MoveField(I13081,_MOVE_START); $this->filter->AddField(I13082, "text", stripslashes(unhtmlentities($this->cms->Vars[I13082])), "", " like ", "name"); $this->filter->MoveField(I13082,_MOVE_START); }function _ApplyFilters($prefix =I13083, $bodyType =I13083, $IIlLLl1 =true) {return parent::_ApplyFilters($prefix, $bodyType, $IIlLLl1); }function &TTTlI1T(&$aCustom) {return parent::TTTlI1T($aCustom); }function TTTlI1I(&$vData) {parent::TTTlI1I($vData); $vData["type_options"] =$this->TIl1I11("tax_type", "option_row", $this->lllI1LI, count($this->itemData) ?$this->itemData["tax_type"] :$this->cms->Vars[I13084], true); $lllI1lI =""; if (isset($this->itemData['country'])) {$lllI1lI =$this->itemData['country']; unset($this->itemData['country']); }$lllI1ll =I13085; if (isset($this->itemData['state'])) {$lllI1ll =$this->itemData['state']; unset($this->itemData['state']); }$vData["zone_country"] =$lllI1lI; $vData[I13086] =$lllI1ll; require_once($GLOBALS["FUNC_INCLUDES_PATH"]."func_gui.php"); $vData["country"] =TlTl11T($this->cms, $lllI1lI, true); $vData["state"] =TlTl11I($this->cms, $lllI1lI, $lllI1ll, true); $vData[I13087] =TlTl11l($this->cms); }function TTTlI11(&$vData, &$aCustom) {$this->browser->InitSQL("id, is_default, name, zip, state, country, tax_rate, tax_type ", "FROM " .$this->module->GetTableName() ." m ", "WHERE 1 ".$this->_ApplyFilters().$this->TTTlIl1(), I13085, I13088, "is_default asc" );$aCustom["fields"] += Array( 'actions' => Array('action'=>I13089, 'object'=>&$this, 'method'=>'_CreateActions'), 'is_default' => Array(I13090=>'flagicon', 'value'=>1, 'is'=>'spec_act2_id', I13091=>$this->moduleName.'_list:spec4_active_on','off'=>$this->moduleName.'_list:spec4_active_off'), 'country' => Array(I13092=>"get_word", "words"=>&$this->words), 'state' => Array(I13092=>"get_word", I13093=>&$this->words), 'type' => Array(I13092 => "callback", "object" => &$this, "method" => I13094) );$aCustom["applied_id"] ="id"; $aCustom["legend"] =Array("leg_red", I13095, "leg_blue", "leg_edit", "leg_del"); $aCustom["form_data"][I13096] =Array(I13079, "apply", "cancel", "save"); parent::TTTlI11($vData, $aCustom); }function _CreateActions(&$aItem, &$aData) {$aItem["edit_id"] =$aItem[I13097] =$aItem['id']; if ($aItem[I13088] == 1) {$aItem["actions"] =$this->cms->Gui->get($this->moduleName.'_list:icons_edit_deloff', $aItem); $aItem["actions"] .= $this->cms->Gui->get($this->moduleName.I13098, $aItem); }else {$aItem["actions"] =$this->cms->Gui->get($this->moduleName.'_list:icons_edit_del', $aItem); }if ($aItem["row_index"] == 1) {$style =$this->browser->style["simple"]; if ($aData[I13099]%2) $style =$this->browser->style["even"]; $aData["style"] =$style; }}function &TTTllTl(&$aCustom) {return parent::TTTllTl($aCustom); }function TTTlllT(&$vData) {parent::TTTlllT($vData); }function TTTll1T(&$vData, &$aCustom) {$aDefault =Array(); foreach($this->IIllIL1 as $IIlL1L1 => $tmp) {parent::TTTll1T($vData, $IIlL1Ll); }}function TTTll11($cId, $cModule) {parent::TTTll11($cId, $cModule); }function TTTl1Tl($cId, $cModule) {parent::TTTl1Tl($cId, $cModule); $sql ="SELECT * ". "FROM " .$this->module->GetTableName() .I13100. "WHERE id='".$cId."'".$this->_ApplyFilters(); $this->db->query($sql); if($this->db->next_record()) {$this->itemData =$this->db->Record; $this->itemData[I13088] =($this->itemData[I13088] == 1) ?"checked": I13085; }}function TTTl1T1($cId, $cModule) {parent::TTTl1T1($cId, $cModule); }function _ActionDel($cId, $cModule) {parent::_ActionDel($cId, $cModule); }function TTTl1I1(&$aGroupIds, $cModule) {$index =array_search($this->lllI1l1, $aGroupIds); if ($index !== false) {unset($aGroupIds[$index]); }parent::TTTl1I1($aGroupIds, $cModule); }function TTTl1lI($cId, $cModule) {parent::TTTl1lI($cId, $cModule); }function TTT1IlI($aSql =Array(), $cId =0) {$name =$this->cms->VarsPost["name"]; $country =$this->cms->VarsPost[I13101]; $state =$this->cms->VarsPost["state"]; $zip =$this->cms->VarsPost["zip"]; $tax_rate =floatval($this->cms->VarsPost["tax_rate"]); $tax_type =$this->cms->VarsPost[I13084]; if ($name != I13085) {$aSql =Array( "name" => $name, I13101 => $country, I13102 => $state, "zip" => $zip, "tax_rate" => $tax_rate, I13084 => $tax_type );}$aSql =parent::TTT1IlI($aSql, $cId); return $aSql; }function _GetDetailsLinkCB(&$aItem, &$aData) {if(!empty($aItem["body"])) {$aItem["details_link"] =1; }}}?>