<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @package    core 
 * @version    $Id$ 
 * @size       6628 xkqwwyuskpukruwwmwrrggnqkrgrplyyxwnmzmupznlngtmpnksngulzxmnmwtmlygwmpnir
 */ ?><?php foreach(array(13234=>"PQtZJJvZJuQD",13235=>'nZIQ',13236=>"WHrrQWtvZJuQ",13237=>'RhhT|gzTo',13238=>"C",13239=>'||ZIM|ZJJ|PZSPQtD',13240=>"vZJuQ",13241=>"WZGtMHn",13242=>"PQtvZJuQ",13243=>'iHSuJQVMDuZJqSMtHr',13244=>'tBGQ',13245=>'`tGJ') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class ModuleVisualEditor extends CMS_ActModule {function ModuleVisualEditor(&$cms, &$db, &$cModule) {parent::CMS_ActModule($cms, $db, $cModule); }function _Init($IIll1l1 =Array(), $IIll1LI ="", $IIll1Ll ="", $aOptions =Array()) {parent::_Init($IIll1l1, $IIll1LI, $IIll1Ll, $aOptions); }function setSmilesCollectionCB($cData, $IIL1lL1, &$res, &$aData, $IIL1l1I =I13234){ $llllLIl =array('base', 'aiwanlight', 'aiwandark'); switch($IIL1l1I){ case I13234: $llllLIL =$this->cms->Gui->ParseLangFile("templates/lang/options/ce_rules_values.lng"); $res =Array(); for($i =0; $i <sizeof($llllLIl); $i++){ $res[] =array( I13235 => $llllLIl[$i], 'caption' => $llllLIL['smile_collection_'.mb_strtoupper($llllLIl[$i])], 'selected' => $cData["value"] == $llllLIl[$i] ?1 :0 );}break; case I13236: break; case "getvalue": $res =$cData["value"]; break; case "apply": $smilesFolder =$cData["value"]; $llllLI1 =$GLOBALS[I13237].'_mod_files/smiles/'.$smilesFolder.'/'; $llllLlI =$GLOBALS[I13237].'_mod_files/smiles/current.dat'; if(!is_dir($llllLI1)){ $smilesFolder ='base'; }if($hFile =fopen($llllLlI, I13238)){ fwrite($hFile, $smilesFolder); fclose($hFile); }break; }return true; }function setGadgetsAllowedCB($cData, $IIL1lL1, &$res, &$aData, $IIL1l1I =I13234){ switch($IIL1l1I){ case I13234: $llllLll =$this->cms->Gui->parseLangFile($GLOBALS['CURRENT_SKIN_PATH'] .'templates/lang/gadgets.lng'); $llllLlL =$this->cms->Gui->parseLangFile("_local/_admin/templates/lang/gadgets.lng"); $llllLl1 =array_merge($llllLll, $llllLlL); unset($llllLll); unset($llllLlL); $res =array( array( "name" => I13239, "caption" => $llllLl1['all_gadgets'], "selected" => (is_array($cData["value"]) && in_array(I13239, $cData[I13240]) ?"selected" :"") ));$numRows =0; $llllLLI =ModuleVisualEditor::TIl1lIl(); $llllLLl =''; foreach ($llllLLI as $llllLLL) {$numRows++; $res[] =array( "name" => $llllLLL[I13235], I13241 => (isset($llllLl1[$llllLLL[I13235]]) ?$llllLl1[$llllLLL[I13235]] :$llllLLL[I13235]), "selected" => (is_array($cData[I13240]) && in_array($llllLLL[I13235], $cData[I13240]) ?"selected" :"") );}$aData['allow_empty'] =true; if($numRows == 0){ return false; }break; case I13242: $res =$cData[I13240]; break; case I13236: $res =array(); foreach($this->module->GetOption("gadgets_allowed") as $modName) $res[] =$modName; break; case "apply": break; }return true; }function TIl1lIl() {$llllLL1 =array(); $path =$GLOBALS['CURRENT_SKIN_PATH'] .'templates/gadgets/'; $system =self::TIl1lI1($path); if(!is_null($system)) {$system =array_map(array(I13243, 'gadgetsFileNameCutter'), $system); foreach ($system as $llllLLL) $llllLL1[] =array(I13235 => $llllLLL, 'type' => 'system'); }$path =$GLOBALS[I13237] .'_local/_admin/templates/gadgets/'; $users =self::TIl1lI1($path); if(!is_null($users)) {$users =array_map(array(I13243, 'gadgetsFileNameCutter'), $users); foreach ($users as $llllLLL) $llllLL1[] =array(I13235 => $llllLLL, I13244 => 'users'); }return $llllLL1; }function TIl1lI1($dir){ return is_dir($dir) ?array_filter(scandir($dir), array(I13243, 'isFileAGadget')) :array(); }function isFileAGadget($filename) {return (strpos($filename, '.tpl') != 0 && strpos($filename, '_parameters') === false); }private function gadgetsFileNameCutter($filename) {return substr($filename, 0, strpos($filename, I13245)); }}?>