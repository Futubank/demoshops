<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       11513 xkqwixiugtpnykipxximupguplskkrmziqnggsygzqspznqumupislyqswlxqwzitpqxpnir
 */ ?><?php foreach(array(13981=>"rQDQJJQr",13982=>"ZSIMn") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} require_once $GLOBALS['CLASSES_PATH'] .'CMS_Member.php'; class Reseller extends CMS_Member {public $dbTablePrefix; function Reseller(&$sess, $IIIL1ll =I13981) {parent::CMS_Member($sess, $IIIL1ll); }function TI1ITlT(&$cms, &$db, $data, $sendMail =false, $update =true, $genData ='') {$res =0; $id_member =$this->checkUsername($db, $data["username"]); if($id_member >0) {$sql ="SELECT id FROM cms_hst_resellers WHERE id_member='$id_member'"; $db->query($sql); $add =!$db->next_record(); if($update) {$this->updateMember($cms, $db, $id_member, $data, true); }}else {$add =$this->createMember($cms, $db, $data, $sendMail, $genData); $id_member =$db->lastInsertId(); }if($add) {$sql ="INSERT INTO cms_hst_resellers (id_member, is_active) VALUES ('$id_member', 1)"; $db->query($sql); $res =$id_member; }return $res; }function TI1ITlI(&$cms, &$db, $id, $data, $IIIL1lL =false) {global $lang_data; $res =0; $balance =$data["balance"]; $currency =$data["currency"]; if($this->updateMember($cms, $db, $id, $data, $IIIL1lL)) {$this->updateBalance($db, $id, $balance, $currency, true, I13982); $res =$id; }return $res; }function TI1ITll(&$cms, &$db, $id) {$sql ="DELETE FROM cms_hst_resellers WHERE id='$id'"; $db->query($sql); }function TT1I1Tl(&$cms, &$db, $id, $status) {$res =false; $sql ="SELECT m.active FROM cms_hst_resellers hr INNER JOIN cms_members m ON m.id=hr.id_member WHERE hr.id='$id'"; $llLlLll =$db->getValue($sql); if($llLlLll) {$sql ="UPDATE cms_hst_resellers SET is_active='$status' WHERE id='$id'"; $db->query($sql); $res =true; }return $res; }function TT1I1T1(&$cms, &$db, $id =0) {if(empty($id)) {$id =$this->User["id"]; }$sql ="SELECT (m.active & hr.active) as active FROM cms_members m ". "INNER JOIN cms_hst_resellers hr ON hr.id_member=m.id WHERE hr.id='$id'"; $active =$db->getValue($sql); $res =($active == 1); return $res; }}?>
