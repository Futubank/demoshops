<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       1892 xkqwxuxgmlqszpsktxwgyrgrlzzusukqngggrywskxgzknkmgskzsrpuumgutqipptlipnir
 */ ?><?php foreach(array(14180=>'JJ1mmm1') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} require_once $GLOBALS['CLASSES_PATH'] .'BaseObject.php'; class SiteLock extends BaseObject {public $tpl; public $ll1IIIL; public $fd; function SiteLock(&$tpl) {$this->BaseObject(); $this->tpl =&$tpl; $this->ll1IIIL =$GLOBALS[I14180]; }function TI1llTl($type) {$fname =$type; return $this->ll1IIIL.$fname; }function put($type,$set,$data=array()) {$text =$this->tpl->getAbs("site_locks:lock_$set",$data); $text =$this->tpl->getAbs("site_locks:page",array('content'=>$text)); $fname =$this->TI1llTl($type); if(!($this->fd[$type]=fopen($fname,'w'))) return $this->TTTITTI("Cannot open $fname for writing"); fwrite($this->fd[$type],$text); flock($this->fd[$type],LOCK_SH|LOCK_NB); return $fname; }function remove($what) {if(!file_exists($what)) {if(isset($this->fd[$what])) {@fclose($this->fd[$what]); unset($this->fd[$what]); }$what =$this->TI1llTl($what); }if(!@unlink($what)) return $this->TTTITTI("Cannot unlink $what"); return true; }}?>