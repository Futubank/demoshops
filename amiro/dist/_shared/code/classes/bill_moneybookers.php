<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       14299 xkqwwnlxpusuukmygkkyyiqpwgizpyyrpgutwxxrwsnmsmiskyirtytsrwigklplmrtupnir
 */ ?><?php foreach(array(14837=>"duWWQDD",14838=>"WurrQnWB",14839=>"QrrnH",14840=>"YuttHn",14841=>"WZJJYZWK",14842=>"rQturn",14843=>"ZIHunt",14844=>"HrSQr",14845=>"SMDZYJQS",14846=>"JZnPuZPQ",14847=>"QrrHr",14848=>"SQDWrMGtMHn",14849=>'JZnPuZPQ',14850=>'DtZtuD',14851=>"IS5DMP",14852=>"IY|WurrQnWB",14853=>'MnnQr',14854=>"trZnDZWtMHn|MS") as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} if(!class_exists("BILL_driver_moneybookers", false)){ class BILL_driver_moneybookers extends BILL_driver_base {function getPayButton(array &$vRes, array $cData, $ll11ILL =false){ $res =true; $data =$cData; $vRes["error"] =I14837; $vRes["errno"] =0; if(empty($data["pay_to_email"])){ $vRes["errno"] =1; $vRes["error"] ="pay_to_email is missed"; $res =false; }else if(empty($data["amount"])){ $vRes["errno"] =2; $vRes["error"] ="amount is missed"; $res =false; }else if(empty($data[I14838])){ $vRes["errno"] =3; $vRes["error"] ="currency is missed"; $res =false; }else if(empty($data["description_title"])){ $vRes[I14839] =4; $vRes["error"] ="description title is missed"; $res =false; }else if(empty($data["description"])){ $vRes[I14839] =5; $vRes["error"] ="description is missed"; $res =false; }else if(empty($data["order"])){ $vRes[I14839] =6; $vRes["error"] ="order id is missed"; $res =false; }else if(empty($data["button_name"]) && empty($data[I14840])){ $vRes[I14839] =7; $vRes["error"] ="button is missed"; $res =false; }foreach(Array("return", "cancel", I14841, "description_title", "description", "button_name") as $fldName) $data[$fldName] =htmlspecialchars($data[$fldName]); $ll11IL1 =$data; if(isset($ll11IL1["return"])) unset($ll11IL1[I14842]); if(isset($ll11IL1["cancel"])) unset($ll11IL1["cancel"]); if(isset($ll11IL1[I14841])) unset($ll11IL1[I14841]); if(isset($ll11IL1["pay_to_email"])) unset($ll11IL1["pay_to_email"]); if(isset($ll11IL1[I14843])) unset($ll11IL1[I14843]); if(isset($ll11IL1[I14838])) unset($ll11IL1[I14838]); if(isset($ll11IL1["description_title"])) unset($ll11IL1["description_title"]); if(isset($ll11IL1["description"])) unset($ll11IL1["description"]); if(isset($ll11IL1[I14844])) unset($ll11IL1[I14844]); if(isset($ll11IL1["button_name"])) unset($ll11IL1["button_name"]); if(isset($ll11IL1[I14840])) unset($ll11IL1[I14840]); foreach($ll11IL1 as $key => $value) $data["hiddens"] .= "<input type=\"hidden\" name=\"$key\" value=\"$value\">\r\n"; $data[I14840] =trim($data[I14840]); if(!empty($data[I14840])) {$data["_button_html"] =1; }if(!$res) {$data[I14845] =I14845; }return parent::getPayButton($vRes, $data, $ll11ILL); }function getPayButtonParams(array $cData, array &$vRes){ $data =$cData; $vRes["error"] =I14837; $vRes[I14839] =0; if(empty($data["pay_to_email"])){ $vRes[I14839] =1; $vRes["error"] ="pay_to_email is missed"; return false; }else if(empty($data[I14846])){ $vRes[I14839] =2; $vRes["error"] ="interface language is missed"; return false; }else if(empty($data[I14843])){ $vRes[I14839] =3; $vRes["error"] ="amount is missed"; return false; }else if(empty($data[I14838])){ $vRes[I14839] =4; $vRes[I14847] ="currency is missed"; return false; }else if(empty($data[I14844])){ $vRes[I14839] =5; $vRes[I14847] ="transaction id is missed"; return false; }else if(empty($data["description_title"])){ $vRes[I14839] =6; $vRes[I14847] ="description title is missed"; return false; }else if(empty($data[I14848])){ $vRes[I14839] =7; $vRes[I14847] ="description is missed"; return false; }else if(empty($data[I14842])){ $vRes[I14839] =8; $vRes[I14847] ="return url is missed"; return false; }else if(empty($data["cancel"])){ $vRes[I14839] =9; $vRes[I14847] ="cancel url is missed"; return false; }else if(empty($data[I14841])){ $vRes[I14839] =10; $vRes[I14847] ="result url is missed"; return false; }foreach(Array(I14842, I14841, "cancel", "description_title", I14848, "button_name") as $fldName) if(isset($data[$fldName])) $data[$fldName] =htmlspecialchars($data[$fldName]); $data['language'] =mb_strtoupper($data[I14849]); $data['currency'] =mb_strtoupper($data['currency']); return parent::getPayButtonParams($data, $vRes); }function payProcess(array $cGet, array $cPost, array &$vRes, array $ll11I1I, array $aOrderData){ $status ='fail'; if(!@is_array($cGet)) $cGet =Array(); if(!@is_array($cPost)) $cPost =Array(); $params =array_merge($cGet, $cPost); if(!empty($params['status'])) $status =$params[I14850]; return ($status == 'ok'); }function payCallback(array $cGet, array $cPost, array &$vRes, array $ll11I1I, array $aOrderData){ if(!@is_array($cGet)) $cGet =Array(); if(!@is_array($cPost)) $cPost =Array(); $params =array_merge($cGet, $cPost); $status =isset($params["transaction_id"]) ?'fail' :'inner'; if(isset($params[I14851])){ $sign =mb_strtoupper(md5( $params["merchant_id"]. $params["transaction_id"]. mb_strtoupper(md5(mb_strtolower($ll11I1I["secret_word"]))). $params["mb_amount"]. $params[I14852]. $params["status"] ));if($params[I14851] == $sign){ if($params["status"] == 2){ $status ='ok'; }else if($params["status"] == 0){ $status =I14853; }}else{ $vRes[I14847] ="Hashes do not match"; }}else{ $vRes[I14847] ="MD5 signature is not found"; }return ($status == I14853 ?-1 :($status == 'ok' ?1 :0)); }function getProcessOrder(array $cGet, array $cPost, array &$vRes, array $additionalParams){ $orderId =0; if(!empty($cGet["transaction_id"])) $orderId =$cGet[I14854]; if(!empty($cPost[I14854])) $orderId =$cPost[I14854]; return intval($orderId); }}}?>