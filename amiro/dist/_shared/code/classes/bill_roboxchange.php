<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       11397 xkqwtszuygkwymsulmlmkmggpnmpmuqknpmigztxupwkynunxzrqpkyksqqisurtiutzpnir
 */ ?><?php foreach(array(14951=>"QrrHr",14952=>"QrrnH",14953=>'SQDWrMGtMHn',14954=>'WZnWQJ',14955=>'YuttHn',14956=>"|YuttHn|OtIJ",14957=>'rQturn|urJ',14958=>'WZJJYZWK',14959=>'ZIHunt',14960=>'%dogMtQI|nuIYQr=',14961=>'!',14962=>'mnvmS',14963=>'QrrHr',14964=>'WrW',14965=>'GZDDCHrS2',14966=>'HK',14967=>'dtZtuD%?200?hk') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} class BILL_driver_roboxchange extends BILL_driver_base {public $lLIILlL =array('ru', 'en'); public function __construct($ll11ILl){ parent::__construct($ll11ILl); $this->clearCartOnPayProcess =true; }function getPayButton(array &$vRes, array $cData, $ll11ILL =false) {$res =true; $data =$cData; $vRes[I14951] ="Success"; $vRes["errno"] =0; if(empty($data["process_url"])){ $vRes["errno"] =1; $vRes[I14951] ="process_url is missed"; $res =false; }else if(empty($data["return"])){ $vRes["errno"] =2; $vRes[I14951] ="return url is missed"; $res =false; }else if(empty($data["merchant_id"])){ $vRes[I14952] =3; $vRes[I14951] ="merchant purse is missed"; $res =false; }else if(empty($data["amount"])){ $vRes[I14952] =4; $vRes[I14951] ="amount is missed"; $res =false; }else if(empty($data["description"])){ $vRes[I14952] =5; $vRes[I14951] ="description is missed"; $res =false; }else if(empty($data["button_name"]) && empty($data["button"])){ $vRes[I14952] =6; $vRes[I14951] ="button is missed"; $res =false; }foreach (array ('return', I14953, 'button_name') as $fldName) {$data[$fldName] =htmlspecialchars($data[$fldName]); }$ll11IL1 =$data; unset($ll11IL1['process_url'], $ll11IL1['return'], $ll11IL1['callback'], $ll11IL1[I14954], $ll11IL1['merchant_id'], $ll11IL1['amount'], $ll11IL1[I14953], $ll11IL1['order'], $ll11IL1['button_name'], $ll11IL1[I14955]); foreach($ll11IL1 as $key => $value) {$data["hiddens"] .= "<input type=\"hidden\" name=\"$key\" value=\"$value\" />\r\n"; }$data["button"] =trim($data["button"]); if(!empty($data["button"])) {$data[I14956] =1; }if (!$res) {$data['disabled'] ='disabled'; }return parent::getPayButton($vRes, $data, $ll11ILL); }function getPayButtonParams(array $cData, array &$vRes){ $data =$cData; $vRes[I14951] ="Success"; $vRes[I14952] =0; if(empty($data["return"])){ $vRes[I14952] =2; $vRes[I14951] ="return url is missed"; return false; }else if(empty($data["amount"])){ $vRes[I14952] =3; $vRes[I14951] ="amount is missed"; return false; }else if(empty($data["merchant_id"])){ $vRes[I14952] =4; $vRes[I14951] ="merchant purse is missed"; return false; }foreach (array (I14957, 'callback_url', 'cancel_url', I14953, 'button_name') as $fldName) {if (isset($data[$fldName])) {$data[$fldName] =htmlspecialchars($data[$fldName]); }}$ll11IL1 =$data; unset($ll11IL1['return'], $ll11IL1[I14954], $ll11IL1[I14958]); foreach ($ll11IL1 as $key => $value) {$data["hiddens"] .= "<input type=\"hidden\" name=\"$key\" value=\"$value\">\r\n"; }$data['crc'] =md5($data['merchant_id'] .':' .$data[I14959] .':' .$data['order_id'] .':' .$data['password1'] .I14960 .$data['order_id']); $lang =$this->gui->lang; if (!in_array($lang, $this->lLIILlL)) {$lang ='en'; }$data['lang'] =$lang; $data['supported_languages'] =implode(I14961, $this->lLIILlL); return parent::getPayButtonParams($data, $vRes); }function payProcess(array $cGet, array $cPost, array &$vRes, array $ll11I1I, array $aOrderData) {$status ='fail'; if (!is_array($cGet)) {$cGet =array ();}if (!is_array($cPost)) {$cPost =array ();}$params =$cPost +$cGet; if (isset($params['crc'])) {$sign =md5($params['OutSum'] .':' .$params[I14962] .':' .$ll11I1I['password1'] .I14960 .$params[I14962]); if (!strcasecmp($params['crc'], $sign)) {$status ='ok'; }else {$vRes[I14963] ='Hashes do not match'; }}else {$vRes[I14963] ='Hash not found'; }return $status == 'ok' ?1 :0; }function payCallback(array $cGet, array $cPost, array &$vRes, array $ll11I1I, array $aOrderData){ $status ='fail'; if (!is_array($cGet)) {$cGet =array ();}if (!is_array($cPost)) {$cPost =array ();}$params =$cPost +$cGet; if (isset($params[I14964])) {$sign =md5($params['OutSum'] .':' .$params['inv_id'] .':' .$ll11I1I[I14965] .I14960 .$params['inv_id']); if (!strcasecmp($params[I14964], $sign)) {$status ='ok'; }else {$vRes[I14963] ='Hashes do not match'; }}else {$vRes[I14963] ='Hash not found'; }return $status == I14966 ?1 :0; }function getProcessOrder(array $cGet, array $cPost, array &$vRes, array $additionalParams) {$orderId =0; if (!empty($cGet['inv_id'])) {$orderId =$cGet['inv_id']; }if (!empty($cPost['inv_id'])) {$orderId =$cPost['inv_id']; }return intval($orderId); }function onPaymentConfirmed($orderId) {while (ob_get_level()) {ob_end_clean(); }header(I14967); header('HTTP/1.0 200 OK'); die('OK' .$orderId); }}?>
