<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       3892 xkqwgirmnrzttsktgtxuumuzswwwzspgwsnlssyxpitqrmrnlrlngsxnpwgnkpkytumxpnir
 */ ?><?php foreach(array(19044=>"GZPQ|404",19045=>"JMnK|rQEuQDtQS",19046=>"~}",19047=>"`",19048=>"{~DM",19049=>"dtZtuD%?200?hk",19050=>"nHtMfB|tH",19051=>"WJMQnt",19052=>"DMtQ|nZIQ",19053=>"QIZMJ",19054=>"WHIGZnB|nZIQ",19055=>"404?IHSuJQ%?DQnSMnP?QIZMJ?fZMJQS```",19056=>'uDQr|ZPQnt') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .'init.php'; $lLLLLLl =&$frn->Core->GetModule(I19044); $frn->Gui->addBlock(I19044, "templates/page_404.tpl"); $vData =array("link_requested"=>$ROOT_PATH_WWW.$ActiveScriptFullLink, "company_email"=>$frn->Core->GetOption("company_email") );$lLLLLLL =false; $uri =$vData[I19045]; if(!empty($uri) && $lLLLLLl->issetOption("ban_list")){ $IILlLll =mb_strrpos($uri, "?"); if($IILlLll!==false) $uri =mb_substr($uri, 0, $IILlLll); $lLLLLL1 =$lLLLLLl->GetOption("ban_list"); $re ="/.*\\/($lLLLLL1)\$/"; if(preg_match($re, $uri)){ $lLLLLLL =true; }}$lLLLL1I =true; if(!empty($uri) && $lLLLLLl->issetProperty("ignore_mail_reporting_case")){ $re =I19046.str_replace(array("\\?", "\\*", "|", "/"), array(I19047, ".*?", ")|(", "\\/"), quotemeta($lLLLLLl->GetProperty("ignore_mail_reporting_case"))).I19048; if(preg_match($re, $uri)) $lLLLL1I =false; }$vData[I19045] =str_replace(Array('%%'), Array('&#037;&#037;'), htmlspecialchars($vData[I19045])); if(!$lLLLLLL){ if(!$lLLLLLl->issetOption("set_404_header") || $lLLLLLl->GetOption("set_404_header")){ $conn->DelHeader(I19049); $conn->DelHeader($GLOBALS["SERVER_PROTOCOL"]." 200 OK"); $conn->AddHeader($GLOBALS["SERVER_PROTOCOL"]." 404 Not Found", true); $conn->SetSkip200Status(true); }$lLLLL1l =$lLLLLLl->GetOption(I19050); $vData["host"] =$_SERVER["SERVER_ADDR"].",".@getenv("LOCAL_ADDR"); $vData[I19051] =@getenv("REMOTE_ADDR"); $vData["user_agent"] =@getenv("HTTP_USER_AGENT"); $vData["site_www"] =$ROOT_PATH_WWW; $vData[I19052] =@getenv("REMOTE_ADDR"); $vData["link_referer"] =@getenv("HTTP_REFERER"); $vData["actual_link"] =getCurrentURL(); if(in_array(I19053, $lLLLL1l) && $lLLLL1I){ require_once($GLOBALS["CLASSES_PATH"]."Mailer.php"); $oMail =new Mailer(); $oMail->RecipientAddress =$frn->Core->GetOption('errors_notification_email'); $oMail->SenderAddress =$frn->Core->GetOption("company_robot_email"); $oMail->SenderName =$frn->Core->GetOption(I19054); $oMail->Subject =$frn->Gui->getAbs("page_404:mail_subject", $vData); $oMail->Body =$frn->Gui->getAbs("page_404:mail_body", $vData); $oMail->BodyFormat ="plain"; $oMail->Prepare(); if(!$oMail->Send()){ trigger_error(I19055, E_USER_WARNING); }}if(in_array("logfile", $lLLLL1l)){ AMI_ErrorHandler::getInstance()->log( '404 Page not found: [' .$vData['link_requested'] .'], client_ip [' .$vData['client'] .'], user_agent [' .$vData[I19056] ."], host: [" .$vData['host'] .']' );}EventApplyVars($frn, "body_page_404", $vData); $HtmlBody =$frn->Gui->getAbs(I19044, $vData); }else{ $HtmlBody =$frn->Gui->getAbs("page_404:banned_page", $vData); }require $GLOBALS['DEFAULT_INCLUDES_PATH'] .'done.php'; ?>