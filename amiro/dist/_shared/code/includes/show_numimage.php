<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       3257 xkqwinzlgslkuiizmkkwzwyqtiwitsytyzquszqzmttkgpzkuxzlpixzztulkwmmxywlpnir
 */ ?><?php foreach(array(19138=>"DMS",19139=>"IHSuJQ",19140=>"MIZPQ|SMPMtD|EtB",19141=>"nHMDQ|JQvQJ",19142=>'nHMDQwHJHr',19143=>'') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} $ActiveModule ="show_num_image"; $ENABLE_BUFFERING =false; if($_SIDE == "front") {$skip_detect_page =1; require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .files_subpath. 'detector.php'; }$lLLL1L1 ='show_num_image'; $defaultModule ='show_numimage'; $cms->PrepareVars(); $sid =isset($cms->VarsGet["sid"]) ?$cms->VarsGet[I19138] :""; if (empty($sid)) {die(); }$lLLL11I =isset($cms->VarsGet["optionsSource"]) ?$cms->VarsGet["optionsSource"] :$lLLL1L1; $module =isset($cms->VarsGet[I19139]) ?$cms->VarsGet[I19139] :$defaultModule; $lLLL11l =isset($cms->VarsGet["l"]); $lLLL11L =$Core->IsInstalled($lLLL11I); $_options =array (I19140, "image_symbols_set", "jitter_amplitude", "wave_amplitude", "type", I19141, "noise_color", );foreach ($_options as $lLLL111) {$$lLLL111 =$lLLL11L && $Core->issetModOption($lLLL11I, $lLLL111) ?$Core->getModOption($lLLL11I, $lLLL111) :$Core->getModOption($lLLL1L1, $lLLL111); }AMI::addResourceMapping(require_once($CLASSES_PATH .'/60/resourceMapping.php')); $oCaptcha =AMI::getResource('captcha', array($module, $sid, $image_digits_qty, AMI_Captcha::getConstantCharset($image_symbols_set))); $oImageGenerator =$oCaptcha->getImageGenerator(); $num =$cms->Core->GetOption("numimage_mode"); $lLL1III =($num == 0) ?false :true; if (!$oImageGenerator->isGDLibInstalled() && !$lLL1III) {trigger_error("GDlib is not found...", E_USER_ERROR); die(); }if (!$lLL1III) {$oImageGenerator->setGenerateOption('digitJitterAmplitude',$aOptions['jitter_amplitude']); $oImageGenerator->setGenerateOption('waveAmplitude',$aOptions['wave_amplitude']); $oImageGenerator->setGenerateOption(I19142, $aOptions['noise_color']); $oImageGenerator->setGenerateOption('noiseLevel', $aOptions['noise_level']); if ($lLLL11l) {$imageString =$oCaptcha->loadImageString(); }else {$imageString =$oImageGenerator->generateRandomImageString(); SetLocalCookie('captcha_' .$sid, md5($imageString), time() +600, I19143, true); }$oImageGenerator->createImage($type, $imageString); }if (!$lLLL11l) {$oCaptcha->saveImageString(); }if (!$lLL1III) {$oImageGenerator->outToStream(); }