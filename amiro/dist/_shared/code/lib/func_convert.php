<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       11472 xkqwirpmmrkxwkqlmiksipigwikzriywzgypwrmmsnmugxtrrtzsxrlzuryuimtrngqzpnir
 */ ?><?php foreach(array(19581=>"",19582=>'?0',19583=>"V",19584=>"X",19585=>"jX",19586=>"ww",19587=>"sww",19588=>"iii",19589=>"iiiiiiii",19590=>']',19591=>'~|ZSIMn~',19592=>"RhhT|gzTo|ccc",19593=>'~;CCC\`~DM',19594=>']EuHt^',19595=>'\'',19596=>'#NhmNsqX@',19597=>'?rQJ="nHfHJJHC"',19598=>'',19599=>'WHSQwHntQntdtHrZPQ',19600=>"RhhT|gzTo",19601=>"~",19602=>'qXTRz|dimjqd',19603=>"%s",19604=>"#Yr@\r\n",19605=>'~\*jmdT\&~M',19606=>'#~jm@#~Uj@',19607=>'}#\~gRq@{~',19608=>'M',19609=>'GrQ',19610=>'}?_@{~DM',19611=>'"^{`PMf"',19612=>'"frHCn`PMf"',19613=>'}*;\`&- {',19614=>'~\%\%\{\%~',19615=>'%{') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} function TlTllT1($hex, $isRev =true){ $out =I19581; if(preg_match('/^(0x)?([0-9a-fA-F]+)$/i', $hex, $matches)){ for($i =0; $i <mb_strlen($matches[2]); $i++){ $out .= str_pad(decbin(hexdec($matches[2][$i])), 4, "0", STR_PAD_LEFT); }}if($isRev) $out =strrev($out); return $out; }function TlTllIT($lL1lI11, $lL1llII =true, $lL1llIl =false){ $out =''; if(!$lL1llII){ $lL1lI11 =strrev($lL1lI11); }if(preg_match('/^([01]+)$/i', $lL1lI11, $matches)){ for($i =0; $i <mb_strlen($matches[1]); $i += 4){ $lL1llIL =mb_substr($matches[1], $i, 4); $out =dechex(bindec(strrev($lL1llIL))) .$out; }}if($lL1llIl){ $out =ltrim($out, I19582); }return $out; }function TlTllII($num) {$lL1llI1 =I19581; if ($num <0 || $num >9999) {return $num; }$lL1lllI =array(1=> "I", 2=>"II", 3=>"III", 4=>"IV", 5=>I19583, 6=>"VI", 7=>"VII", 8=>"VIII", 9=>"IX"); $lL1llll =array(1=> I19584, 2=>"XX", 3=>"XXX", 4=>"XL", 5=>"L", 6=>I19585, 7=>"LXX", 8=>"LXXX", 9=>"XC"); $lL1lllL =array(1=> "C", 2=>I19586, 3=>"CCC", 4=>"CD", 5=>"D", 6=>"DC", 7=>I19587, 8=>"DCCC", 9=>"CM"); $lL1lll1 =array(1=> "M", 2=>"MM", 3=>I19588, 4=>"MMMM", 5=>"MMMMM", 6=>"MMMMMM", 7=>"MMMMMMM", 8=>I19589, 9=>"MMMMMMMMM"); $lL1llLI =$num %10; $lL1llLl =($num -$lL1llLI) %100; $lL1llLL =($num -$lL1llLl -$lL1llLI) %1000; $lL1llL1 =($num -$lL1llLL -$lL1llLl -$lL1llLI) %10000; $lL1llLl =$lL1llLl /10; $lL1llLL =$lL1llLL /100; $lL1llL1 =$lL1llL1 /1000; if ($lL1llL1) {$lL1llI1 .= $lL1lll1[$lL1llL1]; }if ($lL1llLL) {$lL1llI1 .= $lL1lllL[$lL1llLL]; }if ($lL1llLl) {$lL1llI1 .= $lL1llll[$lL1llLl]; }if ($lL1llLI) {$lL1llI1 .= $lL1lllI[$lL1llLI]; }return $lL1llI1; }function _pregStripSlashes($content){ return str_replace(array('\"'), array('"'), $content); }function _tagsParamReplace($content, $doCheckImage){ $content =_pregStripSlashes($content); $content =str_replace('&amp;', I19590, $content); do{ $prevLength =mb_strlen($content); $content =preg_replace('/^\s*javascript\:/', '', $content); }while(mb_strlen($content) != $prevLength); if($doCheckImage){ $test =mb_strtolower(preg_replace('/^ *(.*?) *$/', '$1', $content)); if(mb_strpos($test, I19591) !== false){ $content =''; }else{ $isRelativeAddress =!preg_match('/^https?:\/\//', $test); $isLocalAddress =false; if(!$isRelativeAddress){ $test =preg_replace('/^https:\/\//', 'http://', $test); if(mb_strpos($test, $GLOBALS[I19592]) !== false){ $isLocalAddress =true; }}if(($isRelativeAddress || $isLocalAddress) && !preg_match('/^[^\?]*\.(jpg|png|gif|jpeg|swf)$/', $test)){ $content =''; }}}return $content; }function _getLinkContent($url, $content, $useNoIndex, $urlParams){ $url =_pregStripSlashes($url); $realUrl =$url; if(preg_match('/^data\:/si', $url)){ $realUrl =''; }if(preg_match(I19593, $url)){ $realUrl ='http://'.$realUrl; }$content =_pregStripSlashes(trim($content)); $attributes =''; if (isset($urlParams[0]) && $urlParams[0] >0) {$lL1ll1I =strip_tags(html_entity_decode($content, ENT_QUOTES, $urlParams[1])); if (mb_strlen($lL1ll1I) >$urlParams[0]) {$attributes =' title="' .str_replace('"', I19594, $lL1ll1I) .'"'; $content =htmlspecialchars(mb_substr($lL1ll1I, 0, $urlParams[0] -8 -3) .'...' .mb_substr($lL1ll1I, -8)); $content =str_replace(array ('#', '%', I19595), array ('&#035;', '&#037;', '&#039;'), $content); }}$realUrl =_tagsParamReplace($realUrl, false); if($useNoIndex && (!preg_match('/^https?:\/\//i', $realUrl) || (mb_strpos($realUrl, $GLOBALS[I19592]) !== false))) $useNoIndex =false; return ($useNoIndex ?I19596 :'').'<A ' .$attributes .' HREF="'.$realUrl.'"'.($useNoIndex ?I19597 :'').' target="_blank">'.$content.'</A>'.($useNoIndex ?'</NOINDEX>' :I19598); }function _getCodeContent($content){ $content =_pregStripSlashes($content); $content =preg_replace('/<br>/si', I19598, $content); $nlCount =1; $nlPos =mb_strpos($content, "\n"); while($nlPos !== false){ $nlCount++; $nlPos =mb_strpos($content, "\n", $nlPos+1); }if($nlCount >10) $nlCount =10; $codeKey =sizeof($GLOBALS['codeContentStorage']); $GLOBALS[I19599][$codeKey] =$content; return '<PRE class="edCode" style="height:'.($nlCount*15+40).'">CodeId_'.$codeKey.'</PRE>'; }function _getSmileName($smileNames, $smileName){ if(isset($smileNames[$smileName])){ return $smileNames[$smileName]; }return I19598; }function TlTllIl($content, $lL1ll1l =true, $useNoIndex =false, $urlParams =array ()){$smilesFolder ='base'; if(is_file($GLOBALS[I19600].'_mod_files/smiles/current.dat')){ $fileConfig =trim(file_get_contents($GLOBALS[I19600].'_mod_files/smiles/current.dat')); if(!empty($fileConfig) && is_dir($GLOBALS[I19600].'_mod_files/smiles/'.$fileConfig)){ $smilesFolder =$fileConfig; }}$smilesPath =$GLOBALS[I19600]."_mod_files/smiles/".$smilesFolder.I19601; $smilesPathWWW ="_mod_files/smiles/".$smilesFolder.I19601; $smileNames =array(); if(is_file($GLOBALS[I19600].'_local/config_editor.php')){ $configData =parse_ini_file($GLOBALS[I19600].'_local/config_editor.php', true); foreach(array('BASE_SMILES', I19602) as $dataType){ foreach($configData[$dataType] as $smileName => $smileValue){ $smileName =trim($smileName); $smileValue =trim($smileValue); if(strncmp($smileName, $smilesFolder, mb_strlen($smilesFolder)) == 0){ $smileName =mb_substr($smileName, mb_strlen($smilesFolder)+1); $smileNames[$smileName] =$smileValue; }}}}$specSmiles =array(";)" => "wink", ":)" => "smile", I19603 => "laugh", ":(" => "frown"); if(!$lL1ll1l) $content =htmlspecialchars($content); $content =preg_replace('/\r?\n|\r\n?/s', I19604, $content); $rxPatterns =array( '/\[CODE\](.*?)\[\/CODE\]/ies', '/\[(\/?)(B|I|U|S|P)\]/i', '/\[Q\]/i', '/\[Q=&quot;(.*?)&quot;\]/i', '/\[(\/?)(INDENT|Q)\]/i', '/\[(LEFT|RIGHT|CENTER|JUSTIFY)\]/i', '/\[\/(LEFT|RIGHT|CENTER|JUSTIFY)\]/i', '/\[H(\d)\]/i', '/\[\/H(\d)\]/i', I19605, '/\[\/LIST\]/i', '/\[OL\]/i', '/\[\/OL\]/i', '/\[\*\]/i', '/\[FONT=&quot;(.*?)&quot;\]/ie', '/\[(COLOR|SIZE)=&quot;(.*?)&quot;\]/ie', '/\[\/(FONT|SIZE|COLOR)\]/i', '/\[URL=&quot;(.*?)&quot;\](.*?)\[\/URL\]/ies', '/\[IMG\](.*?)\[\/IMG\]/sie', '/(;\)|:\)|:D|:\()/e', '/\:([a-z\_]{1,20})\:/ie', '/(<IMG .*?>|<A .*?<\/A>)/ise', '/(?:https?:\/\/www\.|https?:\/\/|www\.)(?:[a-z0-9\-]+\.)+[a-z]{2,8}[^ \r\n\t\'"><]*/ie', '/(<IMG .*?>|<A .*?<\/A>)/ise' );$rxReplacements =array( '_getCodeContent(\'$1\')', '<\1\2>', '<BLOCKQUOTE class="edQuote">', '<BLOCKQUOTE class="edQuote"><b>\1:</b><br>', '<\1BLOCKQUOTE>', '<DIV class="edParagraph" style="text-align:\1;">', '</DIV>', '<H\1>', '</H\1>', '<UL>', I19606, '<OL>', '</LI></OL>', '<LI>', '"<FONT face=\""._tagsParamReplace(\'$1\', false)."\">"', '"<FONT ".$1."=\""._tagsParamReplace(\'$2\', false)."\">"', '</FONT>', '_getLinkContent(\'$1\', \'$2\', $useNoIndex, \$urlParams)', '"<IMG SRC=\""._tagsParamReplace(\'$1\', true)."\">"', '"<IMG SRC=\"".$smilesPathWWW.$specSmiles[\'$1\'].".gif\" title=\""._getSmileName($smileNames, $specSmiles[\'$1\'])."\">"', 'is_file($smilesPath."$1.gif") ? "<IMG SRC=\"".$smilesPathWWW."$1.gif\" title=\""._getSmileName($smileNames, "$1")."\">" : ":$1:"', 'preg_replace(array ("/www/si", "/http/si"), array ("wBREAKwBREAKw", "htBREAKtp"), _pregStripSlashes(\'$1\'))', '_getLinkContent(\'$0\', \'$0\', $useNoIndex, \$urlParams)', 'preg_replace(array ("/htBREAKtp/si", "/wBREAKwBREAKw/si"), array ("http", "www"), _pregStripSlashes(\'$1\'))', );$GLOBALS[I19599] =array(); $content =preg_replace($rxPatterns, $rxReplacements, $content); for($i =0; $i <sizeof($GLOBALS[I19599]); $i++){ $content =preg_replace('/(<PRE[^>]*?>)CodeId\_'.$i.I19607, '\1'.$GLOBALS["codeContentStorage"][$i].'\2', $content); }$aCheckTags =array('b',I19608,'u','li','font','a',I19609,'blockquote','p','ul'); for($i =0; $i <sizeof($aCheckTags); $i++){ $countOpened =preg_match('/<' .$aCheckTags[$i] .I19610, $content); $countClosed =preg_match('/<\/' .$aCheckTags[$i] .I19610, $content); if($countClosed <$countOpened){ $content .= str_repeat('</' .$aCheckTags[$i] .'>', $countOpened -$countClosed); }}return $content; }function TlTllI1($html){ $smilesFolder ='base'; if(is_file($GLOBALS[I19600].'_mod_files/smiles/current.dat')){ $fileConfig =trim(file_get_contents($GLOBALS[I19600].'_mod_files/smiles/current.dat')); if(!empty($fileConfig) && is_dir($GLOBALS[I19600].'_mod_files/smiles/'.$fileConfig)){ $smilesFolder =$fileConfig; }}$smilesPathWWW ="_mod_files/smiles/".$smilesFolder.I19601; $specSmiles =array ('"wink.gif"' => I19611, '"smile.gif"' => '":).gif"', '"laugh.gif"' => '":D.gif"', I19612 => '":(.gif"'); return preg_replace(array ('/' .preg_quote('<IMG SRC="'.$smilesPathWWW, '/') .I19613 .preg_quote('.gif"', '/') .'([^>]*)?\>/si', '/\:\;\)\:/', I19614, '/\:\:\D\:/', '/\:\:\(\:/' ),array (':\\1:', ';)', I19615, ':D', ':(' ),str_replace(array_keys($specSmiles), $specSmiles, $html)); }?>
