<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       29325 xkqwnrslsmmyzqqxtsziwismgmrurnigqmrrqsnpqmkwqzyuwzwuiimmttymwkrmglllpnir
 */ ?><?php foreach(array(19761=>"]",19762=>'zim|qvQnt',19763=>'|SMDWZrS',19764=>":",19765=>"]nYDG^",19766=>"ZJJ",19767=>"~;}*;\\` &-{`[\$~",19768=>'DWrMGt|JMnK',19769=>'}',19770=>"='",19771=>"{?",19772=>'~',19773=>'rQSMrQWt|tBGQ',19774=>'nZIQ',19775=>'?200?hk',19776=>'Z',19777=>'9',19778=>"dqjqwT?MS?FRhi?WID|GZPQD?coqRq?IHSuJQ|nZIQ='",19779=>"'",19780=>"DMtQ|tMtJQ",19781=>"DGJMttQr",19782=>"fMrDt",19783=>"GZPQ",19784=>"%",19785=>"WJS|BQZr",19786=>"ZWtMvQ|DGQW|YJHWKD",19787=>"WZJQnSZr|PrMS",19788=>"BQZr|vZJuQ",19789=>"CQS",19790=>"SZB|",19791=>"ZGr",19792=>"DQG",19793=>"BQZr",19794=>"IHntO|GrQv|nZIQ",19795=>"t",19796=>"",19797=>"fHrWQ|MS|GZPQ",19798=>"SZB|MS",19799=>"SZB",19800=>"SZtQ",19801=>"CQQK",19802=>"DGQWMZJ|fJZP|",19803=>"DGQWMZJ|fJZP|JMDt",19804=>'wid|zWtiHSuJQ`GOG',19805=>'iHSuJQpHHPJQdMtQIZG`GOG',19806=>"PHHPJQ|DMtQIZG",19807=>'',19808=>'\\',19809=>'[',19810=>'QIGtB',19811=>'>*;*%DGZWQ%&&->',19812=>"``",19813=>'`txt',19814=>'"',19815=>'%',19816=>'UTF+8',19817=>"GZPQD",19818=>'@`[ #~Z\D[@{{/DM') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} function TlT1IT1(&$vUrl, $aVars){ $lL1LL1L =I19761; if(mb_strpos($vUrl, "?")===false){ $lL1LL1L ="?"; }foreach($aVars as $name=>$value){ $vUrl .= $lL1LL1L.$name."=".$value; $lL1LL1L =I19761; }return true; }function TlT1IIT($lL1LL11, &$IILLl1I, &$IILLl1l, $lL1L1II) {if($lL1L1II) {foreach($lL1LL11 as $llLlll1) {if(array_key_exists($llLlll1, $IILLl1I)) {$IILLl1l[$llLlll1] =$IILLl1I[$llLlll1]; }}}else {foreach($lL1LL11 as $llLlll1) {$IILLl1l[$llLlll1] =isset($IILLl1I[$llLlll1]) ?$IILLl1I[$llLlll1] :null; }}}function EventApplyVars(&$vObject, $cThread, &$aVars, $pageId =0){ $res =TRUE; if(function_exists('CustomApplyVars')){ $res =CustomApplyVars($vObject, $cThread, $aVars, $pageId); }if(class_exists(I19762)){ $ILIl1IL =array( 'type' => $cThread, 'oObject' => $vObject, 'aData' => &$aVars, 'pageId' => $pageId, I19763 => FALSE );AMI_Event::fire('v5_on_apply_data', $ILIl1IL, AMI_Event::MOD_ANY); if($ILIl1IL[I19763] || !empty($ILIl1IL['_skip'])){ $res =FALSE; }}return $res; }function get_file_ext( $filename ){$ext =pathinfo($filename, PATHINFO_EXTENSION); return $ext; }function unhtmlentities ($string, $lL1L1Il =false) {$trans_tbl =get_html_translation_table (HTML_SPECIALCHARS); $trans_tbl += Array("'"=>"&#039;", I19764=>"&#037;", "#"=>"&#035;"); if($lL1L1Il) {$trans_tbl += Array(" "=>I19765); }$trans_tbl =array_flip ($trans_tbl); return strtr ($string, $trans_tbl); }function removeSpecial(&$vars, $type="all", $lL1L1Il =false) {$res =""; $lL1L1IL =true; $arr =$vars; if(!is_array($vars)) {$lL1L1IL =false; $arr =Array($vars); }foreach(array_keys($arr) as $key) {$val =$arr[$key]; if($type=="all" || $type=="slashes") {$val =is_array($val) ?removeSpecial($val, $type) :stripslashes($val); }if($type==I19766 || $type=="html") {$val =is_array($val) ?removeSpecial($val, $type) :unhtmlentities($val, $lL1L1Il); }$arr[$key] =$val; }$res =$lL1L1IL ?$arr :$arr[0]; return $res; }function get_script_name() {$str =$_SERVER["PHP_SELF"]; if (empty($str)){ $str =@getenv("SCRIPT_NAME"); }$p =mb_strrpos($str, "/"); if($p!==false) $str =mb_substr($str, $p+1); $res =preg_replace(I19767, "\\1", $str); return $res; }function TlT1III($name) {$res =""; if(!empty($name)) {$res =implode(".", array_reverse(explode(".", $name))); }return $res; }function TlT1IIl($IIILl1L, &$lL1L1I1, $IL111LI =I19768, $lL1L1lI ='0', $sqlPrefix =' OR '){ $res =''; $aLink =explode('/', $IIILl1L); $lL1L1ll =$sqlPrefix .I19769 .$lL1L1lI .' '; $lL1L1lL =''; if(sizeof($aLink) >1){ $res =$aLink[0]; foreach($aLink as $lL1L1l1){ if($lL1L1l1 != ''){ $lL1L1lL .= $lL1L1l1; $lL1L1ll .= " OR " .$IL111LI .I19770 .$lL1L1lL ."'"; $lL1L1lL .= "/"; $lL1L1ll .= " OR " .$IL111LI .I19770 .$lL1L1lL ."'"; }}}$lL1L1I1 =$lL1L1ll .I19771; return $res; }function doRedirect(&$gui, $link, &$conn) {global $Core, $CONNECT_OPTIONS; $link =str_replace('&#035;', '#', $link); AMI_Debug::checkSelfRedirection('doRedirect', $link); if(trim($link, '/') === trim(getCurrentURL(), I19772)){ trigger_error('doRedirect() is called for self redirection', E_USER_WARNING); header('Location: ' .$GLOBALS['ROOT_PATH_WWW'], true, 301); die; }if(isset($CONNECT_OPTIONS['redirect_type']) && $CONNECT_OPTIONS[I19773] == '301'){ if($Core->Side != 'admin'){ echo ' '; }doRedirect301($link, $Core->Cache); }if(!$conn){ while(ob_get_level()){ $aStatus =ob_get_status(); if('ob_gzhandler' === $aStatus[I19774]){ break; }ob_end_clean(); }}echo $gui->Parse("templates/redirect.tpl", array ('location' => $link)); if($conn){ $conn->Out(); }die; }function doRedirect301($url, &$cache){ global $conn; if(isset($conn) && is_object($conn)){ $conn->DelHeader('Status: 200 OK'); $conn->DelHeader($GLOBALS['SERVER_PROTOCOL'] .I19775); $conn->AddHeader($GLOBALS['SERVER_PROTOCOL'] .' 301 Moved Permanently', true); $conn->AddHeader('Location: ' .$url, true); $conn->SetSkip200Status(true); $conn->Out(); }else{ header($GLOBALS['SERVER_PROTOCOL'] .' 301 Moved Permanently', true); header('Location: ' .$url, true); }if(is_object($cache)){ $cache->markPageIsSkipped(); }die; }function isEmail($lL1L1LI) {if (preg_match("/^(\w+[\w.-]*\@[A-Za-z0-9а-яёА-ЯЁ]+((\.|-+)[A-Za-z0-9а-яёА-ЯЁ]+)*\.[\-A-Za-z0-9а-яёА-ЯЁ]+(;|,|$))+$/", $lL1L1LI)){ return true; }else{ return false; }}function TlT1II1(&$core) {$tmpMod =&$core->GetModule(get_script_name()); if(is_object($tmpMod)) {$ownerName =$tmpMod->GetOwnerName(); }else {$ownerName =""; }return $ownerName; }function GeneratePassword($IIILLLL){ $res =""; srand((double) microtime() *1000000); for($i =0; $i <$IIILLLL; $i++) {switch(rand(0, 4)) {case 0: case 1: $res .= chr(rand(ord(I19776), ord('z'))); break; case 2: case 3: $res .= chr(rand(ord('A'), ord('Z'))); break; case 4: $res .= chr(rand(ord('0'), ord(I19777))); break; }}return $res; }function TlT1IlT(&$cms, &$db, $modName, $currentPageId, $lL1L1Ll) {$ILlL1lI =false; $idSite =0; if($currentPageId == 0) {$sql =I19778.$modName."' and public=1 and hidden='0' and lang='".$cms->lang_data."' ORDER BY id LIMIT 1"; $db->query($sql); if($db->next_record()) {$currentPageId =$db->Record["id"]; }}$sql ="select id, name from cms_pages where id='".$currentPageId.I19779; $db->query($sql); $currentPageName =""; if($db->next_record()) {$currentPageName =$db->Record["name"]; }$siteTitle =$cms->Core->GetModOption("pages", "site_title"); $aVars =Array( I19780 => htmlspecialchars($siteTitle[$cms->lang_data]), "company_name" => htmlspecialchars($cms->Core->GetOption("company_name")), "current_page_name" => $currentPageName, "item_auto_title" => htmlspecialchars($lL1L1Ll), I19781 => "" );if($cms->Core->issetModOption($modName, "html_title_splitter")) {$aVars[I19781] =htmlspecialchars($cms->Core->GetModOption($modName, "html_title_splitter")); }return $aVars; }function TlT1IlI(&$cms, $modName, $aVars, $lL1L1LL) {$lL1L1L1 =$lL1L1LL; if($cms->Core->issetModOption($modName, "html_title_template")) {$lL1L11I =$cms->Core->GetModOption($modName, "html_title_template"); $lL1L1L1 =$cms->Gui->parseText($lL1L11I, $aVars); }return trim(strip_tags($lL1L1L1)); }function TlT1Ill(&$db, $tableName) {$res =0; $sql ="SELECT position FROM ".$tableName." ORDER BY position DESC LIMIT 1"; $db->query($sql,DBC_SYS_QUERY); if($db->next_record()) {$res =$db->Record["position"] +1; }return $res; }function TlT1Il1(&$Gui, &$Pager, $blockName ="_pager", $lL1L11l =array()) {foreach(Array(I19782, "last", "prev", "next", "active", I19783, "spacer", "page_size", "page_size_row", "page_tpl") as $lL1L11L) {$Pager->Icons[$lL1L11L] =$Gui->get($blockName.I19784.$lL1L11L, $lL1L11l); }$Pager->Icons["body"] =$Gui->get("_pager",$lL1L11l); $Pager->blockName =$blockName; }function TlT1I1T(&$cms, &$ILILlLL, &$startYear, $ILILlLI, $ILILlLl) {$startYear =date("Y"); $ILILlLL =date("n"); if(isset($cms->Vars[I19785])) {$year =intval($cms->Vars[I19785]); $year =max($ILILlLI, $year); $startYear =min($ILILlLl, $year); }if(isset($cms->Vars["cld_month"])) {$month =intval($cms->Vars["cld_month"]); $month =max(1, $month); $ILILlLL =min(12, $month); }}function TlT1I1I(&$IlllLll) {$ILILlLI =1971; $ILILlLl =2030; $startYear =""; $ILILlLL =""; TlT1I1T($IlllLll->cms, $ILILlLL, $startYear, $ILILlLI, $ILILlLl); $specName =$IlllLll->module->GetProperty(I19786); $IlllLll->cms->Core->Cache->TT1TI1l("calendar_grid", $startYear."_".$ILILlLL, $specName); $lL1L111 =$IlllLll->cms->Core->GetModOption("calendar_grid", "first_week_day"); $lL11III =$IlllLll->cms->Core->GetModOption(I19787, "holiday_days"); $lL11IIl =$lILI1LI =$ILILlLL; $lL11IIL =$lILI1Ll =$startYear; DateTools::TT1lI1I($lL11IIl, $lL11IIL); DateTools::TT1lI1l($lILI1LI, $lILI1Ll); $IlllLll->cms->Gui->addBlock(I19787, "templates/calendar_grid.tpl"); $words =$IlllLll->cms->Gui->ParseLangFile("templates/lang/calendar_grid.lng"); $aData =Array(); $lL11II1 =Array(); $aData["month_value"] =$ILILlLL; $aData[I19788] =$startYear; $lL11IlI =""; $lL11Ill =Array("sun", "mon", "tue", I19789, "thu", "fri", "sat"); for($idx =$lL1L111; $idx <7 +$lL1L111; $idx++) {$lL11IlL =($idx <7) ?$idx :($idx -7); $lL11II1["day_name"] =$words[I19790.$lL11Ill[$lL11IlL]]; if(in_array($lL11IlL, $lL11III)) {$setPostfix ="holiday"; }else {$setPostfix ="business"; }$lL11IlI .= $IlllLll->cms->Gui->get("calendar_grid:day_of_week_".$setPostfix, $lL11II1); }$aData["days_of_week"] =$IlllLll->cms->Gui->getAbs("calendar_grid:days_of_week", Array("days_of_week" => $lL11IlI)); $lL11Il1 =Array("jan", "feb", "mar", I19791, "may", "jun", "jul", "aug", I19792, "oct", "nov", "dec"); $aData["month"] =$IlllLll->cms->Gui->getAbs("calendar_grid:month", Array("month_name" => $words["m_".$lL11Il1[$ILILlLL -1]])); $aData["year"] =$IlllLll->cms->Gui->getAbs("calendar_grid:year", Array(I19793 => $startYear)); $aData["prev_month"] =$lILI1LI; $aData["next_month"] =$lL11IIl; $aData["prev_year"] =$lILI1Ll; $aData["next_year"] =$lL11IIL; $aData[I19794] =$words["m_".$lL11Il1[$lILI1LI -1]]; $aData["month_next_name"] =$words["m_".$lL11Il1[$lL11IIl -1]]; if($lILI1Ll >= $ILILlLI) {$aData["month_prev_link"] =$IlllLll->cms->Gui->get("calendar_grid:month_prev_link", $aData); }if($lL11IIL <= $ILILlLl) {$aData["month_next_link"] =$IlllLll->cms->Gui->get("calendar_grid:month_next_link", $aData); }$numDays =date("t", mktime(1, 1, 1, $ILILlLL, 1, $startYear)); $lL11ILI =date("w", mktime(1, 1, 1, $ILILlLL, 1, $startYear)); $lL11ILl =date(I19795, mktime(1, 1, 1, $lILI1LI, 1, $lILI1Ll)); $lL11ILL =date(I19795, mktime(1, 1, 1, $lL11IIl, 1, $lL11IIL)); $lL11IL1 =$lL11ILI -$lL1L111; $lL11IL1 =($lL11IL1 <0) ?(7 +$lL11IL1) :$lL11IL1; $lL11I1I =7 +$lL11IL1; $lL11I1l =7 -($numDays +$lL11IL1) %7; $lL11I1l += 7 *($lL11I1l <7); $lL11I1L =$numDays +$lL11I1I +$lL11I1l; $aData["front_link"] =$IlllLll->module->GetFrontLink(); $aData["week"] =""; $aData["weeks"] =I19796; $aData["force_id_page"] =I19796; $aSpecIdPages =$IlllLll->module->GetOption("spec_id_pages"); if(is_array($aSpecIdPages) && sizeof($aSpecIdPages) >0) {if(in_array(-1, $aSpecIdPages)) {$aData["force_id_page"] ="&force_id_page[]=-1"; }else {$aData[I19797] =implode("&force_id_page[]=", $aSpecIdPages); }}for($day =1; $day <= $lL11I1L; $day++) {$postfix =I19796; if($day -1 <$lL11I1I) {$postfix ="_prev_month"; $aData["day"] =$lL11ILl -($lL11I1I -$day); $lL11I11 =mktime(1, 1, 1, $lILI1LI, $aData["day"], $lILI1Ll); $aData[I19798] =$aData["day"]."_".$lILI1LI."_".$lILI1Ll; }elseif($day >($lL11I1I +$numDays)) {$postfix ="_next_month"; $aData[I19799] =$day -$lL11I1I -$numDays; $lL11I11 =mktime(1, 1, 1, $lL11IIl, $aData[I19799], $lL11IIL); $aData[I19798] =$aData[I19799]."_".$lL11IIl."_".$lL11IIL; }else {$aData[I19799] =$day -$lL11I1I; $lL11I11 =mktime(1, 1, 1, $ILILlLL, $aData[I19799], $startYear); $aData[I19798] =$aData[I19799]."_".$ILILlLL."_".$startYear; }$aData[I19800] =date($IlllLll->cms->DFMT["php"], $lL11I11); $aData[I19799] =$IlllLll->cms->Gui->get("calendar_grid:day_link", $aData); if(in_array(($day +$lL1L111 -1) %7, $lL11III)) {$setName ="day_holiday"; }else {$setName ="day_business"; }$aData[I19801] .= $IlllLll->cms->Gui->getDefPostf("calendar_grid:".$setName, $postfix, $aData); if($day %7 == 0) {$aData["weeks"] .= $IlllLll->cms->Gui->get("calendar_grid:week", $aData); $aData[I19801] =I19796; }}$res =$IlllLll->cms->Gui->getAbs("calendar_grid:js_set_styles", Array()); $res .= $IlllLll->cms->Gui->get("calendar_grid:body_small_calendar", $aData); return $res; }function TIIlTII(&$gui, $guiBlockName, $lL11lII, $I1LLlL1, &$I1LLl1I, $value, $varName =I19796, $setPrefix =I19796) {$lL11lIl =Array(); $lL11lIL =(!$lL11lII); for($i =$lL11lII; $i <= $I1LLlL1; $i++) {$lL11lI1 =Array( "num" => $i, "on_special" => ($value &(1 << $i) ?"checked" :I19796), "caption" => $I1LLl1I[I19802.($i +$lL11lIL)], "value" => (1 << $i) );$lL11lIl[] =$gui->get($guiBlockName.I19784.$setPrefix."special_flag_row", $lL11lI1); }$lL11llI =$gui->get($guiBlockName.I19784.$setPrefix."special_flag_splitter", $lL11lI1); $lL11lI1["special_flag_list"] =implode($lL11llI, $lL11lIl); $res =$gui->get($guiBlockName.I19784.$setPrefix.I19803.$varName, $lL11lI1); return $res; }function TlT1I1l(){ global $cms, $db, $CONNECT_OPTIONS; if(!preg_match('/\/(sitemap\_[^\.]*\_\d{3}\.xml)$/i', getCurrentURL(), $matches)){ return; }else{ $sitemap_file =$matches[1]; }if($cms->Core->IsInstalled("google_sitemap")){ $cms->Core->Cache->Disable(); $ENABLE_BUFFERING =false; require_once $GLOBALS['CLASSES_PATH'] .I19804; require_once $GLOBALS['CLASSES_PATH'] .I19805; $lL11lll =&$cms->Core->GetModule(I19806); $lL11llL =new ModuleGoogleSitemap($cms, $db, $lL11lll); if($lL11lll->GetOption("sitemaps_disabled")){ header("HTTP/1.0 404 Not Found"); die; }AMI_Service::hideDebug(); $CONNECT_OPTIONS['disable_cache_warn'] =true; $lL11llL->TII1IIT($sitemap_file); die; }}function PMA_splitSqlFile(&$ret, $sql, $release) {$sql =rtrim($sql, "\n\r"); $sql_len =mb_strlen($sql); $char =I19807; $string_start =I19807; $in_string =FALSE; $nothing =TRUE; $time0 =time(); for ($i =0; $i <$sql_len; ++$i) {@set_time_limit(29); $char =mb_substr($sql, $i ,1); if ($in_string) {for (;;){$i =mb_strpos($sql, $string_start, $i); if (!$i) {$ret[] =array('query' => $sql, 'empty' => $nothing); return TRUE; }else if ($string_start == '`' || mb_substr($sql, $i-1, 1) != '\\') {$string_start =I19807; $in_string =FALSE; break; }else {$j =2; $escaped_backslash =FALSE; while ($i-$j >0 && mb_substr($sql, $i-$j, 1) == I19808) {$escaped_backslash =!$escaped_backslash; $j++; }if ($escaped_backslash) {$string_start =I19807; $in_string =FALSE; break; }else {$i++; }}}}else if (($char == '-' && $sql_len >$i +2 && mb_substr($sql, $i +1, 1) == '-' && mb_substr($sql, $i +2, 1) <= ' ') || $char == '#' || ($char == I19772 && $sql_len >$i+1 && mb_substr($sql, $i +1, 1) == I19809)) {$i =mb_strpos($sql, $char == I19772 ?'*/' :"\n", $i); if ($i === FALSE) {break; }if ($char == I19772) $i++; }else if ($char == ';') {$ret[] =array('query' => mb_substr($sql, 0, $i), I19810 => $nothing); $nothing =TRUE; $sql =ltrim(mb_substr($sql, min($i +1, $sql_len))); $sql_len =mb_strlen($sql); if ($sql_len) {$i =-1; }else {return TRUE; }}else if (($char == '"') || ($char == '\'') || ($char == '`')) {$in_string =TRUE; $nothing =FALSE; $string_start =$char; }elseif ($nothing) {$nothing =FALSE; }$time1 =time(); if ($time1 >= $time0 +15) {$time0 =$time1; header('X-cms-tick: $time1'); }}if (!empty($sql) && preg_match(I19811, $sql)) {$ret[] =array('query' => $sql, I19810 => $nothing); }return TRUE; }function TlT1I11(){ $lL11ll1 =$GLOBALS['ROOT_PATH']."_admin/_logs/"; if($handle =@opendir($lL11ll1)){ while(($lL11lLI =readdir($handle)) !== false){ if($lL11lLI != "." && $lL11lLI != I19812 && preg_match('/^progress_(\d+)\.txt$/', $lL11lLI, $matches)){ if(intval(mb_substr($matches[1], 0, 10)) +24 <intval(date("YmdH"))){ @unlink($lL11ll1.$lL11lLI); }}}closedir($handle); }$lll11IL =date('YmdHis').mt_rand(1000, 9999); TlT1lTT($lll11IL, I19807); return $lll11IL; }function TlT1lTT($lll11IL, $lL11lLl){ if($hFile =@fopen($GLOBALS['ROOT_PATH']."_admin/_logs/progress_".$lll11IL.'.txt', 'w')){ fwrite($hFile, $lL11lLl); fclose($hFile); @chmod($GLOBALS['ROOT_PATH']."_admin/_logs/progress_".$lll11IL.I19813, 0666); }}function TlT1lTI($aData) {$result =I19807; if(is_array($aData)){ $result .= 'o'; foreach($aData as $key => $value){ $value =rawurlencode($value); $result .= mb_strlen($key).I19796.".".$key.mb_strlen($value).".".$value; }}return $result; }function TlT1lTl($III1LlI, $lL11lLL =null){ $aItems =array(); $lL11lL1 =true; if(!is_array($III1LlI)){ $lL11lL1 =false; $III1LlI =array( $III1LlI => $lL11lLL );}foreach($III1LlI as $key => $value){ $lL11l1I =is_int($key) ?$key :'"' .$key .I19814; $lL11l1l =$value; if(is_array($value)){ $value =TlT1lTl($value); }else if(is_object($value)){ next; }else if(is_bool($value)){ $value =$value ?'true' :'false'; }else if(is_string($value)){ $value =I19814 .preg_replace('/[\r?\n]/s', '\n', addslashes($value)) .I19814; }$aItems[] =$lL11lL1 ?$lL11l1I .I19815 .$value :$lL11l1I .'=' .$value; }return $lL11lL1 ?'{'.implode(',', $aItems).'}' :$aItems[0]; }function TlT1lT1(&$aData){ if(is_array($aData)){ foreach($aData as $key => $value){ if(!is_array($value)){ $aData[$key] =mb_convert_encoding($value, I19816, 'Windows-1251'); }}}}function TlT1lIT(&$db, $tableName, $lL11l1L, $storageLimit, $lL11l11){ $ILIlLIl =0; if($storageLimit >0){ $aInfo =$db->GetTableInfo($tableName); $vRows =$aInfo["rows"]; $vAvgSize =$aInfo["avg_row_size"]/1048576; $vSize =intval($vAvgSize*$aInfo["rows"]); switch($lL11l1L){ case I19817: $vSize =$aInfo["rows"]; $ILIlLIl =intval($vRows -$storageLimit +$storageLimit*0.2); break; case "mb": if($vAvgSize >0){ $ILIlLIl =intval(($vSize -$storageLimit +$storageLimit*0.2) /($vAvgSize *$lL11l11/0.05)); $ILIlLIL =intval($aInfo["rows"]*0.4); $ILIlLIl =min($ILIlLIl, $ILIlLIL, 200); }break; }}if($vSize >0){ return $ILIlLIl; }else{ return 0; }}function TlT1lII(&$html){ if(preg_match_all('~(<a.*?)href\s*=\s*(["\']?(https?:\/\/[^"\'\s]+)(?:.*?' .I19818, $html, $aMatches)){ foreach($aMatches[1] as $index => $opener){ if(mb_strpos($aMatches[3][$index], $GLOBALS['ROOT_PATH_WWW']) === FALSE){ $html =str_replace($aMatches[0][$index], '<noindex>' .$opener .'rel=nofollow href=' .$aMatches[2][$index] .'</noindex>', $html); }}}}function toStr($aChars){ $res =I19807; foreach($aChars as $char){ $res .= chr($char); }return $res; }