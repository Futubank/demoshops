<?php /**
 * @copyright  2000-2016 Amiro.CMS. All rights reserved. 
 * @version    $Id$ 
 * @size       5226 xkqwlxpnpwrgrqxkqitwqngqyqiqlguuzpxxugpymtlmrilqmyqurtwlsnwtrgnpgzxtpnir
 */ ?><?php foreach(array(19996=>'DrW',19997=>'wjzddqd|gzTo',19998=>'SQtQWtHr`GOG',19999=>'OHDt',20000=>"=",20001=>"tBGQ",20002=>"DOHC|GMW%?WZn't?rQZS?HGtMHnD?fHr?IHSuJQ?",20003=>"`",20004=>"IHS",20005=>'SMDZYJQ|QrrHr|IZMJ') as $i1=>$i2){$i3=strrev("rtrts");define("I".$i1,$i3($i2,'abcdeghijklmopqswyz ~`!@#%^&*()_-+|{}[];:<>,./?ABCDEGHIJKLMOPQSWYZ','ZYWSQPOMLKJIHGEDCBA?/.,><:;][}{|+-_)(*&^%#@!`~ zywsqpomlkjihgedcba'));} if(!defined('AMI_ENVIRONMENT')){header('HTTP/1.0 403 Forbidden');die('Forbidden, invalid URL! '.__FILE__.' at '.__LINE__);} mb_internal_encoding('UTF-8'); header('Content-Type: text/html; charset=UTF-8'); $ENABLE_BUFFERING =false; if(isset($cms->Vars[I19996]) && mb_strpos($cms->Vars[I19996], '___gen=1|') !== false){ $l1III1l =array(); foreach(explode("|", $cms->Vars["src"]) as $val){ if(($pos =mb_strpos($val, "=")) !== false && $pos >0) $l1III1l[mb_substr($val, 0, $pos)] =mb_substr($val, $pos+1); }}if(isset($l1III1l)){ require_once $GLOBALS[I19997] .'template.php'; }else{ $ActiveModule ="show_pic"; if($_SIDE == "front") {$skip_detect_page =1; require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .files_subpath. I19998; }require_once $GLOBALS['DEFAULT_INCLUDES_PATH'] .'init.php'; }$l1III1L =parse_url($GLOBALS['ROOT_PATH_WWW']); @$l1III11 =parse_url($cms->VarsGet[I19996]); if(!empty($l1III1L['host']) && !empty($l1III11[I19999]) && ($l1III1L[I19999] != $l1III11[I19999])){ die; }if(mb_strpos($cms->Vars["src"], "___gen=1|") !== false){ $l1III1l =array(); foreach(explode("|", $cms->Vars["src"]) as $val){ if(($pos =mb_strpos($val, I20000)) !== false && $pos >0) $l1III1l[mb_substr($val, 0, $pos)] =mb_substr($val, $pos+1); }$I1I11L1 =""; $I1I111I =""; $I1I111l =""; if(mb_strlen($l1III1l["mod"]) >0 && !empty($l1III1l[I20001]) && !empty($l1III1l["id"]) && $I1I11LL =&$Core->GetModule($l1III1l["mod"]) && @is_object($I1I11LL) && $I1I11LL->IsInstalled()){ if($Core->TTllT1l(Array($l1III1l["mod"])) !== true){ trigger_error(I20002.$l1III1l["mod"].I20003, E_USER_ERROR); }require_once $GLOBALS[I19997] .'IMG_Proc.php'; $l1IIlII =new template(); $l1IIlII->setReadFromDB(true); $l1IIlII->setLang($l1III1l["lang"]); if($l1IIlII->isValidFile("templates/lang/generate_pic.lng")){ $langData =$l1IIlII->parseLangFile("templates/lang/generate_pic.lng"); }list($I1I11L1, $I1I111I, $I1I111l) =IMG_Proc::TIT1II1($I1I11LL, $db, $l1III1l[I20004], intval($l1III1l["id"]), $l1III1l[I20001], $l1III1l, $langData); }if(empty($I1I11L1)){ header('Status: 404 Not Found', true, 404); exit; }header("Content-Type: ".(empty($I1I111l) ?"image/jpeg" :$I1I111l)); AMI_Registry::set(I20005, true); if(($hFile =fopen($I1I111I, "rb")) && filesize($I1I111I) >0){ print fread($hFile, filesize($I1I111I)); fclose($hFile); }exit; }